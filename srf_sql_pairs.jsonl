{"srf": "# Commission Business Logics: MyBL Hourly_16th Mar25 to 31st Mar25\n**Commission Name:** Commission for MyBL Hourly_16th Mar25 to 31st Mar25  \n**Start Date:** 16-Mar-2025  \n**End Date:** 31-Mar-2025  \n**Commission Receiver Channel:** BL Self-channels (MYBL Channel)  \n\n**Commission Business Logics:**\n\t**KPI:** EV Recharge (All Valid C2S Recharges)\n\t**Target:** Time and Deno specific commission targets so no Target Requir\n\t**Mapping:** Retailer MSISDN: 01967021235\n\t**Commission Calculation Logics:**\n\t\t- BL-Self channel (MyBL) will receive deno and date specific commission\n\t\t- Selected Deno (649, 548, 698, 798) will be consider for performance calculation\n\t\t- All service class below 1000\n\t\t- Only MyBL App recharge will be considered (Reference ID like 'BLAPP%')\n\t\t- Customers can get cashback multiple times during the campaign period\n\t\t- Hourly campaigns will get 2nd highest priority\n\t\t- Transactions of segmented campaigns will not be considered here and transactions of these campaigns will not be considered during calculating commission for regular, and special day campaigns of MyBL App\n\t\t- Need separate cashback commission for each retailer MSISDN\n\t\t- **Time and Deno Based Commission Structure:** \n\t\t\t- 16-Mar: 3:00pm-8:00pm (Deno 649: 166.67, Deno 548: 88.89)\n\t\t\t- 17-Mar: 3:00pm-8:00pm (Deno 649: 166.67, Deno 548: 88.89)\n\t\t\t- 18-Mar: 12:00am-1:59pm (Deno 698: 166.67, Deno 798: 200.00)\n\t\t\t- 18-Mar: 2:00pm-11:59pm (Deno 698: 133.33, Deno 798: 222.22)\n\t\t\t- And so on...\n\n**Detail formats:**\n- **Detail 1:** RET_MSISDN, RECHARGE_AMOUNT, HIT, TOTAL_RECHARGE, COMMISSION_AMOUNT", "sql": "--------------------------------- REPORT HELPER QUERY -----------------------------------------\n\n-- STEP 1: VERIFY SUPPORTING DATA\n--# THIS TABLE IS ALREADY EXISTING, NO NEED TO CREATE FURTHER --#\nSELECT * FROM TEMP_FOR_MYBL_HOURLY_31MAR25;--0  Rows; \n--DROP TABLE TEMP_FOR_MYBL_HOURLY_31MAR25 PURGE;\n\nSELECT * FROM MY_BL_RECHARGE_MONTHLY_16_31MAR25; --0  Rows; --# THIS TABLE IS TEMP TABLE FOR EV RECHARGE TABLE FOR MAR 25 AS THE EV RECHARGE TABLE IS VERY BIG --#\nSELECT * FROM TEMP_FOR_D2_MYBL_HO_16_31MAR25; --0  Rows; --# THIS IS 2ND DETAILS TABLE FOR MYBL HOURLY WHERE WE KEEP FLAG WISE DATA --#\nSELECT * FROM TEMP_FOR_D1_MYBL_HO_16_31MAR25; --0  Rows; --# THIS IS 1ST DETAILS TABLE FOR MYBL HOURLY, COMMISSION AMOUNT IS CALCULATED IN THIS TABLE --#\n\n-- STEP 2: COMMISSION CALCULATION QUERY START --\n--DROP TABLE MY_BL_RECHARGE_MONTHLY_16_31MAR25 PURGE;\nCREATE TABLE MY_BL_RECHARGE_MONTHLY_16_31MAR25 AS\nSELECT /*+ PARALLEL(10)*/ MY_BL_RECHARGE_MONTHLY_SEQ.NEXTVAL ID, RETAILER_MSISDN, SUB_MSISDN, TOP_UP_DATE, TOP_UP_TIME, RECHARGE_AMOUNT, SERVICE_TYPE, REFERENCE_ID\nFROM EV_RECHARGE_COM_DAILY \nWHERE REFERENCE_ID LIKE 'BLAPP%' --# THIS LOGIC IS FOR 6.\tFor 01967021235, first 5 character of Reference Id will be �BLAPP� (example: �BLAPPXXXXXXXXXX�) --#\nAND TOP_UP_DATE BETWEEN '16-Mar-25' AND '31-Mar-25' --# THIS LOGIC IS FOR Effective Date: 16-Mar-2025         End Date: 31-Mar-2025      --#\nand SERVICE_CLASS_ID <1000; --# THIS LOGIC IS FOR Others: All service class below 1000 --#\n\nselect * from MY_BL_RECHARGE_MONTHLY_16_31MAR25;--0  Rows\nALTER TABLE MY_BL_RECHARGE_MONTHLY_16_31MAR25 ADD (COMMISSION_FLAG VARCHAR(50), COMMISSION_AMOUNT NUMBER, REMARKS VARCHAR(50)) ;\n\n--DROP TABLE TEMP_FOR_D2_MYBL_HO_16_31MAR25 PURGE;\n--CREATE TABLE TEMP_FOR_D2_MYBL_HO_16_31MAR25 AS --# THIS IS 2ND DETAILS TABLE FOR MYBL HOURLY WHERE WE KEEP FLAG WISE DATA --#\n--DROP TABLE TEMP_FOR_D1_MYBL_HO_16_31MAR25 PURGE;\n--CREATE TABLE TEMP_FOR_D1_MYBL_HO_16_31MAR25 AS --# THIS IS 1ST DETAILS TABLE FOR MYBL HOURLY, COMMISSION AMOUNT IS CALCULATED IN THIS TABLE --#\nWITH RECHARGE_DETAIL AS\n(\n    SELECT /*+ PARALLEL(10)*/ 'Online' DD_CODE,ID, RETAILER_MSISDN RET_MSISDN,RECHARGE_AMOUNT,COMMISSION,TOP_UP_DATE,TOP_UP_TIME\n    FROM MY_BL_RECHARGE_MONTHLY_16_31MAR25 EV \n    INNER JOIN TEMP_FOR_MYBL_HOURLY_31MAR25 DL ON RECHARGE_AMOUNT=DENO \n    AND TO_DATE(SUBSTR(TOP_UP_DATE, 0,10) || TOP_UP_TIME,  'DD-MON-YY HH24:MI:SS')  BETWEEN TO_DATE(START_DATE,  'DD-MON-YY HH24:MI:SS') AND TO_DATE(END_DATE,  'DD-MON-YY HH24:MI:SS')\n    WHERE RETAILER_MSISDN IN('01967021235') --# THIS LOGIC IS FOR THE BELOW SRF CONDITION --#\n    \n    --# 7.\tRecharge (retailer to subscriber) must be done from below list of retailer EV MSISDN:\n     --   CHANNEL_TYPE\tPARTNER_NAMES\tRETAILER_MSISDN\n     --   Online\tBL Self-channels\t1967021235 --#\n\t \n    AND (COMMISSION_FLAG IS NULL OR COMMISSION_FLAG IN ('HOURLY')) --#  THIS LOGIC IS FOR THE 3RD SRF CONDITION (3.\tHourly campaigns will get 2nd highest priority. Transactions of segmented campaigns will not be considered here and transactions of these campaigns will not be considered during calculating commission for regular, and special day campaigns of MyBL App) --#\n)\n--SELECT * FROM RECHARGE_DETAIL; --0  Rows; --# CREATE THE 2ND DETAILS TABLE FROM HERE (TEMP_FOR_D2_MYBL_HO_16_31MAR25) --#\n,RETAILER_WISE_HIT_COUNT AS (\n    SELECT DD_CODE,RET_MSISDN, RECHARGE_AMOUNT, COUNT(1) HIT, SUM(RECHARGE_AMOUNT) TOTAL_RECHARGE, SUM(COMMISSION) COMMISSION_AMOUNT\n    FROM RECHARGE_DETAIL\n    GROUP BY DD_CODE,RET_MSISDN, RECHARGE_AMOUNT\n)\n--SELECT  * FROM RETAILER_WISE_HIT_COUNT; -- 0  Rows; --# CREATE THE 1ST DETAILS TABLE FROM HERE (TEMP_FOR_D1_MYBL_HO_16_31MAR25) --#\nSELECT DD_CODE, SUM(RECHARGE_AMOUNT*HIT) TOTAL_RECHARGE, SUM(COMMISSION_AMOUNT)  COMMISSION_AMOUNT\nFROM RETAILER_WISE_HIT_COUNT\nGROUP BY DD_CODE;\n\n-- STEP 3: OVERLOOKING CREATED TABLE DATA\nselect * from TEMP_FOR_D1_MYBL_HO_16_31MAR25; --0 Rows\nselect SUM(COMMISSION_AMOUNT) from TEMP_FOR_D1_MYBL_HO_16_31MAR25;-- 1331801.06 TK\n\n-- STEP 4: MERGE TEMP TABLE OF RECHARGE DATA USING 2ND DETAILS TABLE FOR SEPARATING CAMPAIGN WISE TRANSACTIONS \nMERGE INTO MY_BL_RECHARGE_MONTHLY_16_31MAR25 T\nUSING TEMP_FOR_D2_MYBL_HO_16_31MAR25 S\nON (T.ID=S.ID)\nWHEN MATCHED THEN\n    UPDATE SET T.COMMISSION_FLAG='HOURLY',\n    T.COMMISSION_AMOUNT = S.COMMISSION;\nCOMMIT;\n\nSELECT COMMISSION_FLAG, COUNT(1),SUM(COMMISSION_AMOUNT) FROM MY_BL_RECHARGE_MONTHLY_16_31MAR25 GROUP BY COMMISSION_FLAG;\n--# Sample output:\n-- \"REGULAR\"     | XX,XXX   | XXX,XXX.XX\n-- \"HOURLY\"      | 6,063    | 476,868.5 --#\n\n--------------------------------- REPORT SETUP QUERY -----------------------------------------\n\n--STEP 5: PREPARE FOR REPORT PUBLISHING\n--REPORT_ID : 0011 (UPDATE WITH ACTUAL REPORT ID) \nSELECT REPORTID REPORT_ID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Commission for MyBL Hourly_16th Mar25 to 31st Mar25';\n-- BASE_CYCLE_ID : 0022  (UPDATE WITH ACTUAL BASE CYCLE ID)\n--# SPECIAL INSTRUCTION : BASE_CYCLE = month of commission END DATE (Mar_25) --#\nSELECT CYCLEID BASE_CYCLE_ID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Mar_25'; --# commission end date (BASE_CYCLE/REPORT_MONTH): 31-Mar-2025 ? 'Mar_25' --#\n-- REPORT_CYCLE_ID : 0033 (UPDATE WITH ACTUAL REPORT CYCLE ID) \nSELECT REPORT_CYCLE_ID,* FROM COMMISSIONCYCLEREPORTS where REPORTID = 0011 and  CYCLEID = 0022; \n\n-- CHECK ADHOC TABLE DATA --\nSELECT * FROM ad_hoc_data where REPORT_CYCLE_ID = 0033;\n--delete from ad_hoc_data where REPORT_CYCLE_ID = 0033;\n--commit;\n\n-- INSERT THE CHANNEL WISE CALCULATED COMMISSION DATA --\nINSERT INTO AD_HOC_DATA (ID, REPORT_CYCLE_ID, CHANNEL_CODE,COMMISSION_AMOUNT,AMOUNT_TYPE_ID,AMOUNT)\nSELECT AD_HOC_DATA_ID.NEXTVAL ID, 0033 REPORT_CYCLE_ID, DD_CODE, COMMISSION_AMOUNT,1,TOTAL_RECHARGE\nFROM (\nSELECT DD_CODE, SUM(RECHARGE_AMOUNT*HIT) TOTAL_RECHARGE, SUM(COMMISSION_AMOUNT)  COMMISSION_AMOUNT\nFROM TEMP_FOR_D1_MYBL_HO_16_31MAR25\nGROUP BY DD_CODE\n);\ncommit;\n\n--CHECK SUM OF COMMISSION AMOUNT\nSELECT SUM(COMMISSION_AMOUNT) FROM ad_hoc_data where REPORT_CYCLE_ID = 0033; -- 0 TK\n\n--PUBLISH_CYCLE_ID : 0044  (UPDATE WITH ACTUAL PUBLISH CYCLE ID)\n--# SPECIAL INSTRUCTION : PUBLISH_CYCLE = current sysdate month (e.g. Jun_25 if today = 30-Jun-2025) --#\nSELECT CYCLEID PUBLISH_CYCLE_ID FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Apr_25'; --PUBLISH_CYCLE(REPORT_PUBLISH_MONTH)\n\n--STEP 6: SET UP COMMISSION DETAILS IN COMMISSION PLATFORM\n--PROC_COMMISSION_DETAIL_SETUP(<REPORT_TITLE>, <PUBLISH_CYCLE_ID>, <DETAIL1>, <LEVEL1>, ..., <DETAIL9>, <LEVEL9>);\nEXEC PROC_COMMISSION_DETAIL_SETUP('Commission for MyBL Hourly_16th Mar25 to 31st Mar25',0044,'TEMP_FOR_D1_MYBL_HO_16_31MAR25','Deno Details');\n\n--STEP 7: FINALIZE AND PUBLISH COMMISSION REPORT\n--# FINALIZE_REPORT_ADHOC(<REPORT_NAME>, <REPORT_CYCLE_ID>, <BASE_CYCLE>, <PUBLISH_CYCLE>, <APPROVAL_FLOW_ID>, <PUBLISH_TYPE>) --#\nEXEC FINALIZE_REPORT_ADHOC('Commission for MyBL Hourly_16th Mar25 to 31st Mar25', 0033,'Mar_25', 'Apr_25',290, 1); --# FOLLOW THE BASE_CYCLE & PUBLISH_CYCLE SPECIAL INSTRUCTION HERE ALSO --#\n"}
{"srf": "```markdown\n# Commission Business Logics: MyBL Hourly_Portonics_16th Mar25 to 31st Mar25\n**Commission Name:** Commission for MyBL Hourly_Portonics_16th Mar25 to 31st Mar25  \n**Start Date:** 16-Mar-2025  \n**End Date:** 31-Mar-2025  \n**Commission Receiver Channel:** BL Self-channels (MYBL Channel)  \n\n**Commission Business Logics:**\n- **KPI:** EV Recharge (All Valid C2S Recharges)  \n- **Target:** Time and Deno specific commission targets, so no Target Required  \n- **Mapping:** Retailer MSISDN: 1953348398  \n- **Commission Calculation Logics:**  \n    - BL-Self channel (MyBL) will receive deno and date specific commission  \n    - Selected Deno (649, 548, 698, 798) will be considered for performance calculation  \n    - All service class below 1000  \n    - Only MyBL App recharge will be considered  \n    - Customers can get cashback multiple times during the campaign period  \n    - Hourly campaigns will get 2nd highest priority  \n    - Transactions of segmented campaigns will not be considered here and transactions of these campaigns will not be considered during calculating commission for regular and special day campaigns of MyBL App  \n    - Need separate cashback commission for each retailer MSISDN  \n    - **Time and Deno Based Commission Structure:**  \n        - 16-Mar: 3:00pm-8:00pm (Deno 649: 166.67, Deno 548: 88.89)  \n        - 17-Mar: 3:00pm-8:00pm (Deno 649: 166.67, Deno 548: 88.89)  \n        - 18-Mar: 12:00am-1:59pm (Deno 698: 166.67, Deno 798: 200.00)  \n        - 18-Mar: 2:00pm-11:59pm (Deno 698: 133.33, Deno 798: 222.22)  \n        - And so on...  \n\n**Detail formats:**  \n- **Detail 1:** RET_MSISDN, RECHARGE_AMOUNT, HIT, TOTAL_RECHARGE, COMMISSION_AMOUNT  \n```", "sql": "\n--------------------------------- REPORT HELPER QUERY -----------------------------------------\n\n-- STEP 1: VERIFY SUPPORTING DATA\n--# THIS TABLE IS ALREADY EXISTING, NO NEED TO CREATE FURTHER --#\nSELECT * FROM TEMP_FOR_MYBL_HOURLY_31MAR25;-- 0  Rows; --# SUPPORTING DATA FROM SRF UPLOADED IN THIS TABLE --#\n--DROP TABLE TEMP_FOR_MYBL_HOURLY_31MAR25 PURGE;\n\nSELECT * FROM MY_BL_POT_RECHARGE_MONTHLY_31MAR25;-- 0  Rows --# THIS TABLE IS TEMP TABLE FOR EV RECHARGE TABLE FOR MAR 25 AS THE EV RECHAGE TABLE IS VERY BIG --#\nSELECT * FROM TEMP_FOR_D2_MYBL_HO_PO_31MAR25;-- 0  Rows --# THIS IS 2ND DETAILS TABLE FOR MYBL HOURLY PORTONICS WHERE WE KEEP FLAG WISE DATA --#\nSELECT * FROM TEMP_FOR_D1_MYBL_HO_PO_31MAR25;-- 0  Rows --# THIS IS 1ST DETAILS TABLE FOR MYBL HOURLY PORTONICS, COMMISSION AMOUNT IS CALCULATED IN THIS TABLE --#\n\n----- STEP 2: COMMISSION CALCULATION QUERY START\n--DROP TABLE MY_BL_POT_RECHARGE_MONTHLY_31MAR25 PURGE;\n--CREATE TABLE MY_BL_POT_RECHARGE_MONTHLY_31MAR25 AS\nSELECT /*+ PARALLEL(10)*/ MY_BL_RECHARGE_MONTHLY_SEQ.NEXTVAL ID, RETAILER_MSISDN, SUB_MSISDN, TOP_UP_DATE, TOP_UP_TIME, RECHARGE_AMOUNT, SERVICE_TYPE, REFERENCE_ID\nFROM EV_RECHARGE_COM_DAILY\nWHERE TOP_UP_DATE BETWEEN '16-Mar-25' AND '31-Mar-25' --# THIS LOGIC IS FOR Effective Date: 16-Mar-2025         End Date: 31-Mar-2025   --#\nAND SERVICE_CLASS_ID < 1000; --# THIS LOGIC IS FOR Others: All service class below 1000 --#\n\nselect * from MY_BL_POT_RECHARGE_MONTHLY_31MAR25;--0  Rows\nALTER TABLE MY_BL_POT_RECHARGE_MONTHLY_31MAR25 ADD (COMMISSION_FLAG VARCHAR(50), COMMISSION_AMOUNT NUMBER, REMARKS VARCHAR(50)) ;\n\n\n--DROP TABLE TEMP_FOR_D2_MYBL_HO_PO_31MAR25 PURGE;\n--CREATE TABLE TEMP_FOR_D2_MYBL_HO_PO_31MAR25 AS --# THIS IS 2ND DETAILS TABLE FOR MYBL HOURLY PORTONICS WHERE WE KEEP FLAG WISE DATA --#\n--DROP TABLE TEMP_FOR_D1_MYBL_HO_PO_31MAR25 PURGE;\n--CREATE TABLE TEMP_FOR_D1_MYBL_HO_PO_31MAR25 AS --# THIS IS 1ST DETAILS TABLE FOR MYBL HOURLY PORTONICS, COMMISSION AMOUNT IS CALCULATED IN THIS TABLE --#\nWITH RECHARGE_DETAIL AS\n(\n    SELECT /*+ PARALLEL(10)*/ 'Online' DD_CODE,ID, RETAILER_MSISDN RET_MSISDN,RECHARGE_AMOUNT,COMMISSION,TOP_UP_DATE\n    FROM MY_BL_POT_RECHARGE_MONTHLY_31MAR25 EV \n    INNER JOIN TEMP_FOR_MYBL_HOURLY_31MAR25 DL ON RECHARGE_AMOUNT=DENO \n    AND TO_DATE(SUBSTR(TOP_UP_DATE, 0,10) || TOP_UP_TIME,  'DD-MON-YY HH24:MI:SS')  BETWEEN TO_DATE(START_DATE,  'DD-MON-YY HH24:MI:SS') AND TO_DATE(END_DATE,  'DD-MON-YY HH24:MI:SS')\n    WHERE RETAILER_MSISDN='01953348398' --# THIS LOGIC IS FOR THE BELOW SRF CONDITION  --#\n\n    --# 7.\tRecharge (retailer to subscriber) must be done from below list of retailer EV MSISDN:\n    --    CHANNEL_TYPE\tPARTNER_NAMES\tRETAILER_MSISDN\n    --    Online\tPortonics\t01953348398\n    --#\n    AND (COMMISSION_FLAG IS NULL OR COMMISSION_FLAG IN ('HOURLY')) --#  THIS LOGIC IS FOR THE 3RD SRF CONDITION (3.Hourly campaigns will get 2nd highest priority. Transactions of segmented campaigns will not be considered here and transactions of these campaigns will not be considered during calculating commission for special day and regular campaigns of MyBL App) --#\n)\n--SELECT * FROM RECHARGE_DETAIL; -- 0  Rows; --# CREATE THE 2ND DETAILS TABLE FROM HERE (TEMP_FOR_D2_MYBL_HO_PO_31MAR25) --#\n,RETAILER_WISE_HIT_COUNT AS (\n    SELECT DD_CODE,RET_MSISDN, RECHARGE_AMOUNT, COUNT(1) HIT, SUM(RECHARGE_AMOUNT) TOTAL_RECHARGE, SUM(COMMISSION) COMMISSION_AMOUNT\n    FROM RECHARGE_DETAIL\n    GROUP BY DD_CODE,RET_MSISDN, RECHARGE_AMOUNT\n)\nSELECT  * FROM RETAILER_WISE_HIT_COUNT;-- 0  Rows; --# CREATE THE 1ST DETAILS TABLE FROM HERE (TEMP_FOR_D1_MYBL_HO_PO_31MAR25) --#\nSELECT DD_CODE, SUM(RECHARGE_AMOUNT*HIT) TOTAL_RECHARGE, SUM(COMMISSION_AMOUNT)  COMMISSION_AMOUNT\nFROM RETAILER_WISE_HIT_COUNT\nGROUP BY DD_CODE;\n\n--STEP 3: OVERLOOKING CREATED TABLE DATA\nselect * from TEMP_FOR_D1_MYBL_HO_PO_31MAR25;-- 0  Rows\nselect SUM(COMMISSION_AMOUNT) from TEMP_FOR_D1_MYBL_HO_PO_31MAR25;-- 0 TK\n\n--STEP 4: MERGE TEMP TABLE OF RECHARGE DATA USING 2ND DETAILS TABLE FOR SEPERATING CAMPAIGN WISE TRANSACTIONS\nMERGE INTO MY_BL_POT_RECHARGE_MONTHLY_31MAR25 T\nUSING TEMP_FOR_D2_MYBL_HO_PO_31MAR25 S\nON (T.ID=S.ID)\nWHEN MATCHED THEN\n    UPDATE SET T.COMMISSION_FLAG='HOURLY',\n    T.COMMISSION_AMOUNT = S.COMMISSION;\nCOMMIT;\n\nSELECT COMMISSION_FLAG, COUNT(1),SUM(COMMISSION_AMOUNT) FROM MY_BL_POT_RECHARGE_MONTHLY_31MAR25 GROUP BY COMMISSION_FLAG;\n--# Sample output:\n-- \"REGULAR\"     | XX,XXX   | XXX,XXX.XX\n-- \"HOURLY\"      | 7,380    | 1,331,801.06 --#\n\n--------------------------------- REPORT SETUP QUERY -----------------------------------------\n\n--STEP 5: PREPARE FOR REPORT PUBLISHING\n--REPORT_ID : 0011 (UPDATE WITH ACTUAL REPORT ID)\nSELECT REPORTID REPORT_ID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Commission for MyBL Hourly_Portonics_16th Mar25 to 31st Mar25';\n--BASE_CYCLE_ID : 0022 (UPDATE WITH ACTUAL BASE CYCLE ID)\n--# SPECIAL INSTRUCTION : BASE_CYCLE = month of commission END DATE (Mar_25) --#\nSELECT CYCLEID BASE_CYCLE_ID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Mar_25'; --# BASE_CYCLE(REPORT_MONTH) -- commission end date (BASE_CYCLE/REPORT_MONTH): 31-Mar-2025 ? 'Mar_25' --#\n--REPORT_CYCLE_ID : 0033 (UPDATE WITH ACTUAL REPORT CYCLE ID)\nSELECT REPORT_CYCLE_ID,* FROM COMMISSIONCYCLEREPORTS where REPORTID = 0011 and  CYCLEID = 0022; \n\n--CHECK ADHOC TABLE DATA\nSELECT * FROM ad_hoc_data where REPORT_CYCLE_ID = 0033;\n--delete from ad_hoc_data where REPORT_CYCLE_ID = 0033;\n--commit;\n\n--INSERT THE CHANNEL WISE CALCULATED COMMISSION DATA\nINSERT INTO AD_HOC_DATA (ID, REPORT_CYCLE_ID, CHANNEL_CODE,COMMISSION_AMOUNT,AMOUNT_TYPE_ID,AMOUNT)\nSELECT AD_HOC_DATA_ID.NEXTVAL ID, 0033 REPORT_CYCLE_ID, DD_CODE, COMMISSION_AMOUNT,1,TOTAL_RECHARGE\nFROM (\nSELECT DD_CODE, SUM(RECHARGE_AMOUNT*HIT) TOTAL_RECHARGE, SUM(COMMISSION_AMOUNT)  COMMISSION_AMOUNT\nFROM TEMP_FOR_D1_MYBL_HO_PO_31MAR25\nGROUP BY DD_CODE\n);\ncommit;\n\n--CHECK SUM OF COMMISSION AMOUNT\nSELECT SUM(COMMISSION_AMOUNT) FROM ad_hoc_data where REPORT_CYCLE_ID = 0033; --  0 TK  \n\n--PURLISH_CYCLE_ID : 0044 (UPDATE WITH ACTUAL PURLISH CYCLE ID)\n--# SPECIAL INSTRUCTION : PUBLISH_CYCLE = current sysdate month (e.g. Jun_25 if today = 30-Jun-2025) --#\nSELECT CYCLEID PURLISH_CYCLE_ID FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Apr_25'; --PURLISH_CYCLE(REPORT_PUBLISH_MONTH)\n\n\n--STEP 6: SET UP COMMISSION DETAILS IN COMMISSION PLATFORM\n--# PROC_COMMISSION_DETAIL_SETUP(<REPORT_TITLE>, <PURLISH_CYCLE_ID>, <DETAIL1>, <LEVEL1>, ..., <DETAIL9>, <LEVEL9>); --#\nEXEC PROC_COMMISSION_DETAIL_SETUP('Commission for MyBL Hourly_Portonics_16th Mar25 to 31st Mar25',0044,'TEMP_FOR_D1_MYBL_HO_PO_31MAR25','Deno Details');\n\n\n--STEP 7: FINALIZE AND PUBLISH COMMISSION REPORT\n--# FINALIZE_REPORT_ADHOC(<REPORT_NAME>, <REPORT_CYCLE_ID>, <BASE_CYCLE>, <PUBLISH_CYCLE>, <APPROVAL_FLOW_ID>, <PUBLISH_TYPE>) --#\nEXEC FINALIZE_REPORT_ADHOC('Commission for MyBL Hourly_Portonics_16th Mar25 to 31st Mar25', 0033,'Mar_25', 'Apr_25',290, 1); --# FOLLOW THE BASE_CYCLE & PUBLISH_CYCLE SPECIAL INSTRUCTION HERE ALSO --#\n"}
{"srf": "# Commission Business Logics: MyBL Special Day_16th Mar25 to 31st Mar25\n**Commission Name:** Commission for MyBL Special Day_16th Mar25 to 31st Mar25  \n**Start Date:** 16-Mar-2025  \n**End Date:** 31-Mar-2025  \n**Commission Receiver Channel:** BL Self-channels (MYBL Channel)  \n\n**Commission Business Logics:**\n    **KPI:** EV Recharge (All Valid C2S Recharges)\n    **Target:** Date and Deno specific commission targets so no Target Required\n    **Mapping:** Retailer MSISDN: 01967021235\n    **Commission Calculation Logics:**\n        - BL-Self channel (MyBL) will receive deno and date specific commission\n        - Selected Deno (699, 799, 307, 698, 798, 998, 397) will be consider for performance calculation\n        - All service class below 1000\n        - Only MyBL App recharge will be considered (Reference ID like 'BLAPP%')\n        - Customers can get cashback multiple times during the campaign period\n        - Special day campaigns will get 3rd highest priority\n        - Transactions of segmented and hourly campaigns will not be considered here and transactions of these campaigns will not be considered during calculating commission for regular campaigns of MyBL App\n        - Need separate cashback commission for each retailer MSISDN\n        - **Date and Deno Based Commission Structure:** \n            - 16-Mar: Deno 699: 166.67, Deno 799: 200.00, Deno 307: 63.33, Deno 698: 166.67, Deno 798: 222.22, Deno 998: 277.78\n            - 17-Mar: Deno 699: 166.67, Deno 799: 200.00, Deno 397: 85.55, Deno 698: 133.33, Deno 798: 222.22, Deno 998: 277.78\n            - 18-Mar: Deno 699: 166.67, Deno 307: 63.33, Deno 799: 200.00, Deno 998: 277.78\n            - And so on...\n\n**Detail formats:**\n- **Detail 1:** RET_MSISDN, RECHARGE_AMOUNT, HIT, TOTAL_RECHARGE, COMMISSION_AMOUNT", "sql": "\n--------------------------------- REPORT HELPER QUERY -----------------------------------------\n-- STEP 1: VERIFY SUPPORTING DATA\n--# THIS TABLE IS ALREADY EXISTING, NO NEED TO CREATE FURTHER --#\n--DROP TABLE TEMP_FOR_MYBL_SPECIAL_31MAR25 PURGE;\nSELECT * FROM TEMP_FOR_MYBL_SPECIAL_31MAR25;--0  Rows; --# SUPPORTING DATA FROM SRF UPLOADED IN THIS TABLE --#\nSELECT * FROM MY_BL_RECHARGE_MONTHLY_16_31MAR25; --0  Rows --# THIS TABLE IS TEMP TABLE FOR EV RECHARGE TABLE FOR MAR 25 AS THE EV RECHAGE TABLE IS VERY BIG --#\n\nSELECT * FROM TEMP_FOR_D2_MYBL_SP_16_31MAR25;--0  Rows --# THIS IS 2ND DETAILS TABLE FOR MYBL SPECIAL DAY WHERE WE KEEP FLAG WISE DATA --#\nselect DISTINCT TOP_UP_DATE from TEMP_FOR_D2_MYBL_SP_16_31MAR25 ORDER BY TOP_UP_DATE ASC; --# VERIFY DATE RANGE COVERAGE --#\nSELECT * FROM TEMP_FOR_D1_MYBL_SP_16_31MAR25;--0  Rows --# THIS IS 1ST DETAILS TABLE FOR MYBL SPECIAL DAY, COMMISSION AMOUNT IS CALCULATED IN THIS TABLE --#\n\n----- STEP 2: COMMISSION CALCULATION QUERY START\n--DROP TABLE TEMP_FOR_D2_MYBL_SP_16_31MAR25 PURGE;\n--CREATE TABLE TEMP_FOR_D2_MYBL_SP_16_31MAR25 AS --# THIS IS 2ND DETAILS TABLE FOR MYBL SPECIAL DAY WHERE WE KEEP FLAG WISE DATA --#\n--DROP TABLE TEMP_FOR_D1_MYBL_SP_16_31MAR25 PURGE;\nCREATE TABLE TEMP_FOR_D1_MYBL_SP_16_31MAR25 AS --# THIS IS 1ST DETAILS TABLE FOR MYBL SPECIAL DAY, COMMISSION AMOUNT IS CALCULATED IN THIS TABLE --#\nWITH RECHARGE_DETAIL AS\n(\nSELECT /*+ PARALLEL(10)*/ 'Online' DD_CODE,ID, RETAILER_MSISDN RET_MSISDN,RECHARGE_AMOUNT,COMMISSION,TOP_UP_DATE\nFROM MY_BL_RECHARGE_MONTHLY_16_31MAR25 EV \nINNER JOIN TEMP_FOR_MYBL_SPECIAL_31MAR25 DL ON RECHARGE_AMOUNT=DENO \nAND TRUNC(TOP_UP_DATE) BETWEEN START_DATE AND END_DATE\nWHERE REFERENCE_ID LIKE 'BLAPP%'  --# THIS LOGIC IS FOR 6.\tFor 01967021235, first 5 character of Reference Id will be �BLAPP� (example: �BLAPPXXXXXXXXXX�) --#\nAND RETAILER_MSISDN IN ('01967021235') --# THIS LOGIC IS FOR THE BELOW SRF CONDITION  --#\n\n--# 7.\tRecharge (retailer to subscriber) must be done from below list of retailer EV MSISDN:\n--    CHANNEL_TYPE\tPARTNER_NAMES\tRETAILER_MSISDN\n--    Online\tBL Self-channels\t01967021235\n--#\nAND (COMMISSION_FLAG IS NULL OR COMMISSION_FLAG='SPECIAL_DAY') --#  THIS LOGIC IS FOR THE 3RD SRF CONDITION (3.\tSpecial day campaigns will get 3rd highest priority. Transactions of segmented and hourly campaigns will not be considered here and transactions of these campaigns will not be considered during calculating commission for regular campaigns of MyBL App) --#\n)\n--SELECT * FROM RECHARGE_DETAIL;--0  Rows; --# CREATE THE 2ND DETAILS TABLE FROM HERE (TEMP_FOR_D2_MYBL_SP_16_31MAR25) --#\n,RETAILER_WISE_HIT_COUNT AS (\n    SELECT /*+ PARALLEL(10)*/ DD_CODE,RET_MSISDN, RECHARGE_AMOUNT,SUM(COMMISSION) COMMISSION_AMOUNT, COUNT(1) HIT,COUNT(1)*RECHARGE_AMOUNT TOTAL_RECHARGE\n    FROM RECHARGE_DETAIL\n    GROUP BY DD_CODE,RET_MSISDN, RECHARGE_AMOUNT\n)\nSELECT  * FROM RETAILER_WISE_HIT_COUNT; --0  Rows; --# CREATE THE 1ST DETAILS TABLE FROM HERE (TEMP_FOR_D1_MYBL_SP_16_31MAR25) --#\nSELECT SUM(TOTAL_RECHARGE),  SUM(COMMISSION_AMOUNT) FROM RETAILER_WISE_HIT_COUNT;\n--0 TK\t0 TK Total Recharge and Commission Amount\n\n--STEP 3: OVERLOOKING CREATED TABLE DATA\nSELECT * FROM TEMP_FOR_D1_MYBL_SP_16_31MAR25; --0  Rows\nSELECT SUM(COMMISSION_AMOUNT) FROM TEMP_FOR_D1_MYBL_SP_16_31MAR25;--0 TK  \n\n--STEP 4: MERGE TEMP TABLE OF RECHARGE DATA USING 2ND DETAILS TABLE FOR SEPERATING CAMPAIGN WISE TRANSACTIONS\nMERGE INTO MY_BL_RECHARGE_MONTHLY_16_31MAR25 T\nUSING TEMP_FOR_D2_MYBL_SP_16_31MAR25 S\nON (T.ID=S.ID)\nWHEN MATCHED THEN\n    UPDATE SET T.COMMISSION_FLAG='SPECIAL_DAY',\n    T.COMMISSION_AMOUNT = S.COMMISSION;\nCOMMIT;\n\nSELECT * FROM MY_BL_RECHARGE_MONTHLY_16_31MAR25 WHERE COMMISSION_FLAG = 'SPECIAL_DAY';\n\nSELECT COMMISSION_FLAG, COUNT(1),SUM(COMMISSION_AMOUNT) FROM MY_BL_RECHARGE_MONTHLY_16_31MAR25 GROUP BY COMMISSION_FLAG;\n--# Sample output:\n-- \"REGULAR\"     | XX,XXX   | XXX,XXX.XX\n-- \"SPECIAL_DAY\" | 46,204   | 3,941,065.92\n-- \"HOURLY\"      | X,XXX    | XXX,XXX.XX --#\n\n--------------------------------- REPORT SETUP QUERY -----------------------------------------\n\n--STEP 5: PREPARE FOR REPORT PUBLISHING\n--REPORT_ID : 0011 (UPDATE WITH ACTUAL REPORT ID)\nSELECT REPORTID REPORT_ID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Commission for MyBL Special Day_16th Mar25 to 31st Mar25';\n--BASE_CYCLE_ID : 0022 (UPDATE WITH ACTUAL BASE CYCLE ID)\n--# SPECIAL INSTRUCTION : BASE_CYCLE = month of commission END DATE (Mar_25) --#\nSELECT CYCLEID BASE_CYCLE_ID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Mar_25'; --# BASE_CYCLE(REPORT_MONTH) -- commission end date (BASE_CYCLE/REPORT_MONTH): 31-Mar-2025 = 'Mar_25' --#\n--REPORT_CYCLE_ID : 0033 (UPDATE WITH ACTUAL REPORT CYCLE ID)\nSELECT REPORT_CYCLE_ID,* FROM COMMISSIONCYCLEREPORTS where REPORTID = 0011 and  CYCLEID = 0022; \n\n--CHECK ADHOC TABLE DATA\nSELECT * FROM ad_hoc_data where REPORT_CYCLE_ID = 0033;\n--delete from ad_hoc_data where REPORT_CYCLE_ID = 0033;\n--commit;\n\n--INSERT THE CHANNEL WISE CALCULATED COMMISSION DATA\nINSERT INTO AD_HOC_DATA (ID, REPORT_CYCLE_ID, CHANNEL_CODE,COMMISSION_AMOUNT,AMOUNT_TYPE_ID,AMOUNT)\nSELECT AD_HOC_DATA_ID.NEXTVAL ID, 0033 REPORT_CYCLE_ID, DD_CODE, COMMISSION_AMOUNT,1,TOTAL_RECHARGE\nFROM (\nSELECT DD_CODE, SUM(TOTAL_RECHARGE) TOTAL_RECHARGE, SUM(COMMISSION_AMOUNT)  COMMISSION_AMOUNT\nFROM TEMP_FOR_D1_MYBL_SP_16_31MAR25\nGROUP BY DD_CODE\n);\ncommit;\n\n--CHECK SUM OF COMMISSION AMOUNT\nSELECT SUM(COMMISSION_AMOUNT) FROM ad_hoc_data where REPORT_CYCLE_ID = 0033; --  0 TK  \n\n--PURLISH_CYCLE_ID : 0044 (UPDATE WITH ACTUAL PURLISH CYCLE ID)\n--# SPECIAL INSTRUCTION : PUBLISH_CYCLE = current sysdate month (e.g. Jun_25 if today = 30-Jun-2025) --#\nSELECT CYCLEID PURLISH_CYCLE_ID FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Apr_25'; --# PURLISH_CYCLE(REPORT_PUBLISH_MONTH) --#\n\n\n--STEP 6: SET UP COMMISSION DETAILS IN COMMISSION PLATFORM\n--# PROC_COMMISSION_DETAIL_SETUP(<REPORT_TITLE>, <PURLISH_CYCLE_ID>, <DETAIL1>, <LEVEL1>, ..., <DETAIL9>, <LEVEL9>); --#\nEXEC PROC_COMMISSION_DETAIL_SETUP('Commission for MyBL Special Day_16th Mar25 to 31st Mar25',0044,'TEMP_FOR_D1_MYBL_SP_16_31MAR25','Deno Details');\n\n\n--STEP 7: FINALIZE AND PUBLISH COMMISSION REPORT\n--# FINALIZE_REPORT_ADHOC(<REPORT_NAME>, <REPORT_CYCLE_ID>, <BASE_CYCLE>, <PUBLISH_CYCLE>, <APPROVAL_FLOW_ID>, <PUBLISH_TYPE>) --#\nEXEC FINALIZE_REPORT_ADHOC('Commission for MyBL Special Day_16th Mar25 to 31st Mar25', 0033,'Mar_25', 'Apr_25',290, 1--# FOLLOW THE BASE_CYCLE & PUBLISH_CYCLE SPECIAL INSTRUCTION HERE ALSO --#\n"}
{"srf": "```markdown\n# Commission Business Logics: MyBL Special Day_Portonics_16th Mar25 to 31st Mar25\n**Commission Name:** Commission for MyBL Special Day_Portonics_16th Mar25 to 31st Mar25  \n**Start Date:** 16-Mar-2025  \n**End Date:** 31-Mar-2025  \n**Commission Receiver Channel:** BL Self-channels (MYBL Channel)  \n\n**Commission Business Logics:**\n- **KPI:** EV Recharge (All Valid C2S Recharges)  \n- **Target:** Deno and Date specific commission targets, so no Target Required  \n- **Mapping:** Retailer MSISDN: 1953348398  \n- **Commission Calculation Logics:**  \n    - BL-Self channel (MyBL) will receive deno and date specific commission  \n    - Selected Deno (699, 799, 307, 698, 798, 998, 397) will be considered for performance calculation  \n    - All service class below 1000  \n    - Only MyBL App recharge will be considered  \n    - Customers can get cashback multiple times during the campaign period  \n    - Special day campaigns will get 3rd highest priority  \n    - Transactions of segmented and hourly campaigns will not be considered here and transactions of these campaigns will not be considered during calculating commission for regular campaigns of MyBL App  \n    - Need separate cashback commission for each retailer MSISDN  \n    - **Date and Deno Based Commission Structure:**  \n        - 16-Mar: Deno 699: 166.67, Deno 799: 200.00, Deno 307: 63.33, Deno 698: 166.67, Deno 798: 222.22, Deno 998: 277.78  \n        - 17-Mar: Deno 699: 166.67, Deno 799: 200.00, Deno 397: 85.55, Deno 698: 133.33, Deno 798: 222.22, Deno 998: 277.78  \n        - 18-Mar: Deno 699: 166.67, Deno 307: 63.33, Deno 799: 200.00, Deno 998: 277.78  \n        - And so on...  \n\n**Detail formats:**  \n- **Detail 1:** RET_MSISDN, RECHARGE_AMOUNT, HIT, TOTAL_RECHARGE, COMMISSION_AMOUNT  \n```", "sql": "--------------------------------- REPORT HELPER QUERY -----------------------------------------\n----- STEP 1: VERIFY SUPPORTING DATA \n--# THIS TABLE IS ALREADY EXISTING, NO NEED TO CREATE FURTHER --#\n--DROP TABLE TEMP_FOR_MYBL_SP_POT_31MAR25 PURGE;\nSELECT * FROM TEMP_FOR_MYBL_SP_POT_31MAR25;-- 0  Rows; --# SUPPORTING DATA FROM SRF UPLOADED IN THIS TABLE --#\nSELECT * FROM MY_BL_POT_RECHARGE_MONTHLY_31MAR25; -- 0  Rows --# THIS TABLE IS TEMP TABLE FOR EV RECHARGE TABLE FOR MAR 25 AS THE EV RECHAGE TABLE IS VERY BIG --#\n\nSELECT * FROM TEMP_FOR_D2_MYBL_SP_POT_16_31MAR25;-- 0  Rows --# THIS IS 2ND DETAILS TABLE FOR MYBL SPECIAL DAY PORTONICS WHERE WE KEEP FLAG WISE DATA --#\nselect DISTINCT TOP_UP_DATE from TEMP_FOR_D2_MYBL_SP_POT_16_31MAR25 ORDER BY TOP_UP_DATE ASC; --# VERIFY DATE RANGE COVERAGE --#\nSELECT * FROM TEMP_FOR_D1_MYBL_SP_POT_16_31MAR25; -- 0  Rows --# THIS IS 1ST DETAILS TABLE FOR MYBL SPECIAL DAY PORTONICS, COMMISSION AMOUNT IS CALCULATED IN THIS TABLE --#\n\n----- STEP 2: COMMISSION CALCULATION QUERY START\n--DROP TABLE TEMP_FOR_D2_MYBL_SP_POT_16_31MAR25 PURGE;\n--CREATE TABLE TEMP_FOR_D2_MYBL_SP_POT_16_31MAR25 AS --# THIS IS 2ND DETAILS TABLE FOR MYBL SPECIAL DAY PORTONICS WHERE WE KEEP FLAG WISE DATA --#\n--DROP TABLE TEMP_FOR_D1_MYBL_SP_POT_16_31MAR25 PURGE;\n--CREATE TABLE TEMP_FOR_D1_MYBL_SP_POT_16_31MAR25 AS --# THIS IS 1ST DETAILS TABLE FOR MYBL SPECIAL DAY PORTONICS, COMMISSION AMOUNT IS CALCULATED IN THIS TABLE --#\nWITH RECHARGE_DETAIL AS\n(\nSELECT /*+ PARALLEL(10)*/ 'Online' DD_CODE,ID, RETAILER_MSISDN RET_MSISDN,RECHARGE_AMOUNT,COMMISSION,TOP_UP_DATE\nFROM MY_BL_POT_RECHARGE_MONTHLY_31MAR25 EV \nINNER JOIN TEMP_FOR_MYBL_SP_POT_31MAR25 DL ON RECHARGE_AMOUNT=DENO \nAND TRUNC(TOP_UP_DATE) BETWEEN START_DATE AND END_DATE\nWHERE RETAILER_MSISDN IN ('01953348398') \n\n--# THIS LOGIC IS FOR THE BELOW SRF CONDITION \n-- 7.\tRecharge (retailer to subscriber) must be done from below list of retailer EV MSISDN:\n--     CHANNEL_TYPE\tPARTNER_NAMES\tRETAILER_MSISDN\n--     Online\tPortonics\t01953348398 --#\n\nAND (COMMISSION_FLAG IS NULL OR COMMISSION_FLAG='SPECIAL_DAY') --#  THIS LOGIC IS FOR THE 3RD SRF CONDITION (3.Special day campaigns will get 3rd highest priority. Transactions of segmented and hourly campaigns will not be considered here and transactions of these campaigns will not be considered during calculating commission for regular campaigns of MyBL App) --#\n)\n--SELECT * FROM RECHARGE_DETAIL;-- 0  Rows; --# CREATE THE 2ND DETAILS TABLE FROM HERE (TEMP_FOR_D2_MYBL_SP_POT_16_31MAR25) --#\n,RETAILER_WISE_HIT_COUNT AS (\n    SELECT /*+ PARALLEL(10)*/ DD_CODE,RET_MSISDN, RECHARGE_AMOUNT,SUM(COMMISSION) COMMISSION_AMOUNT, COUNT(1) HIT,COUNT(1)*RECHARGE_AMOUNT TOTAL_RECHARGE\n    FROM RECHARGE_DETAIL\n    GROUP BY DD_CODE,RET_MSISDN, RECHARGE_AMOUNT\n)\nSELECT  * FROM RETAILER_WISE_HIT_COUNT; -- 0  Rows; --# CREATE THE 1ST DETAILS TABLE FROM HERE (TEMP_FOR_D1_MYBL_SP_POT_16_31MAR25) --#\nSELECT SUM(TOTAL_RECHARGE),  SUM(COMMISSION_AMOUNT) FROM RETAILER_WISE_HIT_COUNT;\n-- 0 TK 0 TK Total Recharge and Commission Amount\n\n--STEP 3: OVERLOOKING CREATED TABLE DATA\nSELECT * FROM TEMP_FOR_D1_MYBL_SP_POT_16_31MAR25; -- 0  Rows\nSELECT SUM(COMMISSION_AMOUNT) FROM TEMP_FOR_D1_MYBL_SP_POT_16_31MAR25;-- 0 TK  \n\n--STEP 4: MERGE TEMP TABLE OF RECHARGE DATA USING 2ND DETAILS TABLE FOR SEPERATING CAMPAIGN WISE TRANSACTIONS\nMERGE INTO MY_BL_POT_RECHARGE_MONTHLY_31MAR25 T\nUSING TEMP_FOR_D2_MYBL_SP_POT_16_31MAR25 S\nON (T.ID=S.ID)\nWHEN MATCHED THEN\n    UPDATE SET T.COMMISSION_FLAG='SPECIAL_DAY',\n    T.COMMISSION_AMOUNT = S.COMMISSION;\nCOMMIT;\n\nSELECT * FROM MY_BL_POT_RECHARGE_MONTHLY_31MAR25 WHERE COMMISSION_FLAG = 'SPECIAL_DAY';\n\nSELECT COMMISSION_FLAG, COUNT(1),SUM(COMMISSION_AMOUNT) FROM MY_BL_POT_RECHARGE_MONTHLY_31MAR25 GROUP BY COMMISSION_FLAG;\n--# Sample output:\n-- \"REGULAR\"     | XX,XXX   | XXX,XXX.XX\n-- \"SPECIAL_DAY\" | 49,021   | 8,288,307.72\n-- \"HOURLY\"      | X,XXX    | XXX,XXX.XX --#\n\n--------------------------------- REPORT SETUP QUERY -----------------------------------------\n\n--STEP 5: PREPARE FOR REPORT PUBLISHING\n--REPORT_ID : 0011 (UPDATE WITH ACTUAL REPORT ID)\nSELECT REPORTID REPORT_ID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Commission for MyBL Special Day_Portonics_16th Mar25 to 31st Mar25';\n--BASE_CYCLE_ID : 0022 (UPDATE WITH ACTUAL BASE CYCLE ID)\n--# SPECIAL INSTRUCTION : BASE_CYCLE = month of commission END DATE (Mar_25) --#\nSELECT CYCLEID BASE_CYCLE_ID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Mar_25'; --BASE_CYCLE(REPORT_MONTH) -- commission end date (BASE_CYCLE/REPORT_MONTH): 31_Mar_2025 ? 'Mar_25'\n--REPORT_CYCLE_ID : 0033 (UPDATE WITH ACTUAL REPORT CYCLE ID)\nSELECT REPORT_CYCLE_ID,* FROM COMMISSIONCYCLEREPORTS where REPORTID = 0011 and  CYCLEID = 0022; \n\n--CHECK ADHOC TABLE DATA\nSELECT * FROM ad_hoc_data where REPORT_CYCLE_ID = 0033;\n--delete from ad_hoc_data where REPORT_CYCLE_ID = 0033;\n--commit;\n\n--INSERT THE CHANNEL WISE CALCULATED COMMISSION DATA\nINSERT INTO AD_HOC_DATA (ID, REPORT_CYCLE_ID, CHANNEL_CODE,COMMISSION_AMOUNT,AMOUNT_TYPE_ID,AMOUNT)\nSELECT AD_HOC_DATA_ID.NEXTVAL ID, 0033 REPORT_CYCLE_ID, DD_CODE, COMMISSION_AMOUNT,1,TOTAL_RECHARGE\nFROM (\nSELECT DD_CODE, SUM(TOTAL_RECHARGE) TOTAL_RECHARGE, SUM(COMMISSION_AMOUNT)  COMMISSION_AMOUNT\nFROM TEMP_FOR_D1_MYBL_SP_POT_16_31MAR25\nGROUP BY DD_CODE\n);\ncommit;\n\n--CHECK SUM OF COMMISSION AMOUNT\nSELECT SUM(COMMISSION_AMOUNT) FROM ad_hoc_data where REPORT_CYCLE_ID = 0033; --  0 TK  \n\n--PURLISH_CYCLE_ID : 0044 (UPDATE WITH ACTUAL PURLISH CYCLE ID)\n--# SPECIAL INSTRUCTION : PUBLISH_CYCLE = current sysdate month (e.g. Jun_25 if today = 30_Jun_2025) --#\nSELECT CYCLEID PURLISH_CYCLE_ID FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Apr_25'; --PURLISH_CYCLE(REPORT_PUBLISH_MONTH)\n\n\n--STEP 6: SET UP COMMISSION DETAILS IN COMMISSION PLATFORM\n--# PROC_COMMISSION_DETAIL_SETUP(<REPORT_TITLE>, <PURLISH_CYCLE_ID>, <DETAIL1>, <LEVEL1>, ..., <DETAIL9>, <LEVEL9>); --#\nEXEC PROC_COMMISSION_DETAIL_SETUP('Commission for MyBL Special Day_Portonics_16th Mar25 to 31st Mar25',0044,'TEMP_FOR_D1_MYBL_SP_POT_16_31MAR25','Deno Details');\n\n\n--STEP 7: FINALIZE AND PUBLISH COMMISSION REPORT\n--# FINALIZE_REPORT_ADHOC(<REPORT_NAME>, <REPORT_CYCLE_ID>, <BASE_CYCLE>, <PUBLISH_CYCLE>, <APPROVAL_FLOW_ID>, <PUBLISH_TYPE>) --#\nEXEC FINALIZE_REPORT_ADHOC('Commission for MyBL Special Day_Portonics_16th Mar25 to 31st Mar25', 0033,'Mar_25', 'Apr_25',290, 1); --# FOLLOW THE BASE_CYCLE & PUBLISH_CYCLE SPECIAL INSTRUCTION HERE ALSO --#\n"}
{"srf": "```markdown\n# Commission Business Logics: MyBL_16th Mar25 to 31st Mar25\n**Commission Name:** Commission for MyBL_16th Mar25 to 31st Mar25  \n**Start Date:** 16-Mar-2025  \n**End Date:** 31-Mar-2025  \n**Commission Receiver Channel:** BL Self-channels (MYBL Channel)  \n\n**Commission Business Logics:**\n- **KPI:** EV Recharge (All Valid C2S Recharges)  \n- **Target:** Date and Deno specific commission targets, so no Target Required  \n- **Mapping:** Retailer MSISDN: 01967021235  \n- **Commission Calculation Logics:**  \n    - BL-Self channel (MyBL) will receive deno and date-specific commission.  \n    - Selected Deno (118, 167, 169, 199, 307, 348, 397, 399, 448, 497, 548, 549, 649, 698, 798, etc.) will be considered for performance calculation.  \n    - All service class below 1000.  \n    - Only MyBL App recharge will be considered (Reference ID like 'BLAPP%').  \n    - Customers can get cashback multiple times during the campaign period.  \n    - Regular campaigns will get the lowest priority.  \n    - Transactions of segmented, special day, and hourly campaigns will not be considered here.  \n    - Need separate cashback commission for each retailer MSISDN.  \n    - **Date and Deno Based Commission Structure:**  \n        - 16-Mar: Deno 118: 2.22, Deno 167: 18.89, Deno 169: 5.56, Deno 199: 11.11, Deno 307: 52.22, etc.  \n        - 17-Mar to 23-Mar: Deno 117: 5.56, Deno 118: 5.56, Deno 157: 7.78, Deno 167: 11.11, etc.  \n        - 24-Mar to 29-Mar: Deno 117: 5.56, Deno 118: 5.56, Deno 157: 7.78, Deno 167: 11.11, etc.  \n        - 30-Mar to 31-Mar: Deno 307: 52.22, Deno 397: 33.33, Deno 448: 44.44, etc.  \n\n**Detail formats:**\n- **Detail 1:** RET_MSISDN, RECHARGE_AMOUNT, HIT, TOTAL_RECHARGE, COMMISSION_AMOUNT  \n```", "sql": "\n--------------------------------- REPORT HELPER QUERY -----------------------------------------\n----- STEP 1: VERIFY SUPPORTING DATA \n--# THIS TABLE IS ALREADY EXISTING, NO NEED TO CREATE FURTHER --#\nSELECT * FROM TEMP_FOR_MYBL_REG_16_31_MAR25;--0  Rows; --# SUPPORTING DATA FROM SRF UPLOADED IN THIS TABLE --#\n--DROP TABLE TEMP_FOR_MYBL_REG_16_31_MAR25 PURGE;\n\nSELECT * FROM MY_BL_RECHARGE_MONTHLY_16_31MAR25; --0  Rows --# THIS TABLE IS TEMP TABLE FOR EV RECHARGE TABLE FOR MAR 25 AS THE EV RECHAGE TABLE IS VERY BIG --#\nSELECT * FROM TEMP_FOR_D2_MYBL_RE_16_31MAR25; --0  Rows --# THIS IS 2ND DETAILS TABLE FOR MYBL REGULAR WHERE WE KEEP FLAG WISE DATA --#\nSELECT * FROM TEMP_FOR_D1_MYBL_RE_16_31MAR25; --0  Rows --# THIS IS 1ST DETAILS TABLE FOR MYBL REGULAR, COMMISSION AMOUNT IS CALCULATED IN THIS TABLE --#\nSELECT SUM(COMMISSION_AMOUNT) FROM TEMP_FOR_D1_MYBL_RE_16_31MAR25;--1579046.17 TK\n\n----- STEP 2: COMMISSION CALCULATION QUERY START\n--DROP TABLE TEMP_FOR_D2_MYBL_RE_16_31MAR25 PURGE;\n--CREATE TABLE TEMP_FOR_D2_MYBL_RE_16_31MAR25 AS --# THIS IS 2ND DETAILS TABLE FOR MYBL REGULAR WHERE WE KEEP FLAG WISE DATA --#\n--DROP TABLE TEMP_FOR_D1_MYBL_RE_16_31MAR25 PURGE;\nCREATE TABLE TEMP_FOR_D1_MYBL_RE_16_31MAR25 AS --# THIS IS 1ST DETAILS TABLE FOR MYBL REGULAR, COMMISSION AMOUNT IS CALCULATED IN THIS TABLE --#\nWITH RECHARGE_DETAIL AS\n(\nSELECT /*+ PARALLEL(10)*/ DISTINCT 'Online' DD_CODE,ID, RETAILER_MSISDN RET_MSISDN,RECHARGE_AMOUNT,COMMISSION,TOP_UP_DATE\nFROM MY_BL_RECHARGE_MONTHLY_16_31MAR25 EV \nINNER JOIN TEMP_FOR_MYBL_REG_16_31_MAR25 DL ON RECHARGE_AMOUNT = DENO \nAND TRUNC(TOP_UP_DATE) BETWEEN TRUNC(START_DATE) AND TRUNC(END_DATE)\nWHERE RETAILER_MSISDN IN('01967021235') --# THIS LOGIC IS FOR THE BELOW SRF CONDITION --#\n--#\n--7.\tRecharge (retailer to subscriber) must be done from below list of retailer EV MSISDN:\n--    CHANNEL_TYPE\tPARTNER_NAMES\tRETAILER_MSISDN\n--    Online\tBL Self-channels\t01967021235\n--#\nAND REFERENCE_ID LIKE 'BLAPP%' --# THIS LOGIC IS FOR 6.\tFor 01967021235, first 5 character of Reference Id will be �BLAPP� (example: �BLAPPXXXXXXXXXX�) --#\nAND (COMMISSION_FLAG IS NULL OR COMMISSION_FLAG='REGULAR') --#  THIS LOGIC IS FOR THE 4TH SRF CONDITION (4.Regular campaigns will get 4th highest priority. Transactions of segmented, hourly and special day campaigns will not be considered here) --#\n)\n--SELECT * FROM RECHARGE_DETAIL;--0  Rows; CREATE THE 2ND DETAILS TABLE FROM HERE (TEMP_FOR_D2_MYBL_RE_16_31MAR25)\n,RETAILER_WISE_HIT_COUNT AS (\n    SELECT /*+ PARALLEL(10)*/ DD_CODE,RET_MSISDN, RECHARGE_AMOUNT,SUM(COMMISSION) COMMISSION_AMOUNT, COUNT(1) HIT,COUNT(1)*RECHARGE_AMOUNT TOTAL_RECHARGE\n    FROM RECHARGE_DETAIL\n    GROUP BY DD_CODE,RET_MSISDN, RECHARGE_AMOUNT\n)\nSELECT * FROM RETAILER_WISE_HIT_COUNT;  -- 0  Rows; --# CREATE THE 1ST DETAILS TABLE FROM HERE (TEMP_FOR_D1_MYBL_RE_16_31MAR25) --#\n\nSELECT DD_CODE, SUM(RECHARGE_AMOUNT*HIT) TOTAL_RECHARGE, SUM(COMMISSION_AMOUNT)  COMMISSION_AMOUNT\nFROM RETAILER_WISE_HIT_COUNT\nGROUP BY DD_CODE; -- 0 TK Total Recharge and Commission Amount\n\n\n--STEP 3: OVERLOOKING CREATED TABLE DATA\nselect * from TEMP_FOR_D1_MYBL_RE_16_31MAR25;\nselect SUM(COMMISSION_AMOUNT) from TEMP_FOR_D1_MYBL_RE_16_31MAR25; --0 TK\n\n--STEP 4: MERGE TEMP TABLE OF RECHARGE DATA USING 2ND DETAILS TABLE FOR SEPERATING CAMPAIGN WISE TRANSACTIONS\nMERGE INTO MY_BL_RECHARGE_MONTHLY_16_31MAR25  T\nUSING TEMP_FOR_D2_MYBL_RE_16_31MAR25 S\nON (T.ID=S.ID)\nWHEN MATCHED THEN\n    UPDATE SET T.COMMISSION_FLAG='REGULAR',\n    T.COMMISSION_AMOUNT = S.COMMISSION;\nCOMMIT;\n\nSELECT COMMISSION_FLAG, COUNT(1),SUM(COMMISSION_AMOUNT) FROM MY_BL_RECHARGE_MONTHLY_16_31MAR25  GROUP BY COMMISSION_FLAG;\n--# Sample output:\n-- \"REGULAR\"     | 55,067   | 713,141.55\n-- \"SPECIAL_DAY\" | X,XXX    | XXX,XXX.XX\n-- \"HOURLY\"      | X,XXX    | XXX,XXX.XX --#\n\n--------------------------------- REPORT SETUP QUERY -----------------------------------------\n\n--STEP 5: PREPARE FOR REPORT PUBLISHING\n--REPORT_ID : 0011 (UPDATE WITH ACTUAL REPORT ID)\nSELECT REPORTID REPORT_ID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Commission for MyBL_16th Mar25 to 31st Mar25';\n--BASE_CYCLE_ID : 0022 (UPDATE WITH ACTUAL BASE CYCLE ID)\n--# SPECIAL INSTRUCTION : BASE_CYCLE = month of commission END DATE (Mar_25) --#\nSELECT CYCLEID BASE_CYCLE_ID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Mar_25'; --BASE_CYCLE(REPORT_MONTH) -- commission end date (BASE_CYCLE/REPORT_MONTH): 31-Mar-2025 ? 'Mar_25'\n--REPORT_CYCLE_ID : 0033 (UPDATE WITH ACTUAL REPORT CYCLE ID)\nSELECT REPORT_CYCLE_ID,* FROM COMMISSIONCYCLEREPORTS where REPORTID = 0011 and  CYCLEID = 0022; \n\n--CHECK ADHOC TABLE DATA\nSELECT * FROM ad_hoc_data where REPORT_CYCLE_ID = 0033;\n--delete from ad_hoc_data where REPORT_CYCLE_ID = 0033;\n--commit;\n\n--INSERT THE CHANNEL WISE CALCULATED COMMISSION DATA\nINSERT INTO AD_HOC_DATA (ID, REPORT_CYCLE_ID, CHANNEL_CODE,COMMISSION_AMOUNT,AMOUNT_TYPE_ID,AMOUNT)\nSELECT AD_HOC_DATA_ID.NEXTVAL ID, 0033 REPORT_CYCLE_ID, DD_CODE, COMMISSION_AMOUNT,1,TOTAL_RECHARGE\nFROM (\nSELECT DD_CODE, SUM(RECHARGE_AMOUNT*HIT) TOTAL_RECHARGE, SUM(COMMISSION_AMOUNT)  COMMISSION_AMOUNT\nFROM TEMP_FOR_D1_MYBL_RE_16_31MAR25\nGROUP BY DD_CODE\n);\ncommit;\n\n--CHECK SUM OF COMMISSION AMOUNT\nSELECT SUM(COMMISSION_AMOUNT) FROM ad_hoc_data where REPORT_CYCLE_ID = 0033; --  0 TK  \n\n--PURLISH_CYCLE_ID : 0044 (UPDATE WITH ACTUAL PURLISH CYCLE ID)\n--# SPECIAL INSTRUCTION : PUBLISH_CYCLE = current sysdate month (e.g. Jun_25 if today = 30-Jun-2025) --#\nSELECT CYCLEID PURLISH_CYCLE_ID FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Apr_25'; --PURLISH_CYCLE(REPORT_PUBLISH_MONTH)\n\n\n--STEP 6: SET UP COMMISSION DETAILS IN COMMISSION PLATFORM\n--# PROC_COMMISSION_DETAIL_SETUP(<REPORT_TITLE>, <PURLISH_CYCLE_ID>, <DETAIL1>, <LEVEL1>, ..., <DETAIL9>, <LEVEL9>); --#\nEXEC PROC_COMMISSION_DETAIL_SETUP('Commission for MyBL_16th Mar25 to 31st Mar25',0044,'TEMP_FOR_D1_MYBL_RE_16_31MAR25','Deno Details');\n\n\n--STEP 7: FINALIZE AND PUBLISH COMMISSION REPORT\n--# FINALIZE_REPORT_ADHOC(<REPORT_NAME>, <REPORT_CYCLE_ID>, <BASE_CYCLE>, <PUBLISH_CYCLE>, <APPROVAL_FLOW_ID>, <PUBLISH_TYPE>) --#\nEXEC FINALIZE_REPORT_ADHOC('Commission for MyBL_16th Mar25 to 31st Mar25', 0033,'Mar_25', 'Apr_25',290, 1); --# FOLLOW THE BASE_CYCLE & PUBLISH_CYCLE SPECIAL INSTRUCTION HERE ALSO --#\n"}
{"srf": "```markdown\n# Commission Business Logics: MyBL_Portonics_16th Mar25 to 31st Mar25\n**Commission Name:** Commission for MyBL_Portonics_16th Mar25 to 31st Mar25  \n**Start Date:** 16-Mar-2025  \n**End Date:** 31-Mar-2025  \n**Commission Receiver Channel:** BL Self Care Channel (MYBL Channel)  \n\n**Commission Business Logics:**\n- **KPI:** EV Recharge (All Valid C2S Recharges)  \n- **Target:** Deno and Date specific commission targets, so no Target Required  \n- **Mapping:** Retailer MSISDN: 1953348398  \n- **Commission Calculation Logics:**  \n    - BL-Self channel (MyBL) will receive deno and date specific commission  \n    - Selected Deno (118, 167, 169, 199, 307, 348, 397, 399, 448, 497, 548, 549, 649, 698, 798, 117, 157, 229) will be considered for performance calculation  \n    - All service class below 1000  \n    - Only MyBL App recharge will be considered  \n    - Customers can get cashback multiple times during the campaign period  \n    - Regular campaigns will get the lowest priority  \n    - Transactions of segmented, special day, and hourly campaigns will not be considered here  \n    - Need separate cashback commission for each retailer MSISDN  \n    - **Date and Deno Based Commission Structure:**  \n        - 16-Mar: Deno 118: 2.22, Deno 167: 18.89, Deno 169: 5.56  \n        - 17-Mar to 23-Mar: Deno 117: 5.56, Deno 118: 5.56, Deno 157: 7.78  \n        - 24-Mar to 29-Mar: Deno 117: 5.56, Deno 118: 5.56, Deno 157: 7.78  \n        - 30-Mar to 31-Mar: Deno 307: 52.22, Deno 397: 33.33  \n\n**Detail formats:**  \n- **Detail 1:** RET_MSISDN, RECHARGE_AMOUNT, HIT, TOTAL_RECHARGE, COMMISSION_AMOUNT  \n```", "sql": "--------------------------------- REPORT HELPER QUERY -----------------------------------------\n----- STEP 1: VERIFY SUPPORTING DATA \n--# THIS TABLE IS ALREADY EXISTING, NO NEED TO CREATE FURTHER --# \nSELECT * FROM TEMP_FOR_MYBL_RPOT_16_31_MAR25;-- 0  Rows; --# SUPPORTING DATA FROM SRF UPLOADED IN THIS TABLE --#\n--DROP TABLE TEMP_FOR_MYBL_RPOT_16_31_MAR25 PURGE;\nSELECT * FROM MY_BL_POT_RECHARGE_MONTHLY_31MAR25;-- 0  Rows --# THIS TABLE IS TEMP TABLE FOR EV RECHARGE TABLE FOR MAR 25 AS THE EV RECHAGE TABLE IS VERY BIG --#\n\nSELECT * FROM TEMP_FOR_DET2_MYBL_POT16_31MAR25; -- 0  Rows --# THIS IS 2ND DETAILS TABLE FOR MYBL PORTONICS REGULAR WHERE WE KEEP FLAG WISE DATA --#\nSELECT * FROM TEMP_FOR_DET1_MYBL_POT16_31MAR25; --- 0  Rows --# THIS IS 1ST DETAILS TABLE FOR MYBL PORTONICS REGULAR, COMMISSION AMOUNT IS CALCULATED IN THIS TABLE --#\nSELECT SUM(COMMISSION_AMOUNT) FROM TEMP_FOR_DET1_MYBL_POT16_31MAR25;-- 1464765.1 TK\n\n----- STEP 2: COMMISSION CALCULATION QUERY START\n\n--DROP TABLE TEMP_FOR_DET2_MYBL_POT16_31MAR25 PURGE;\n--CREATE TABLE TEMP_FOR_DET2_MYBL_POT16_31MAR25 AS --# THIS IS 2ND DETAILS TABLE FOR MYBL PORTONICS REGULAR WHERE WE KEEP FLAG WISE DATA --#\n--DROP TABLE TEMP_FOR_DET1_MYBL_POT16_31MAR25 PURGE;\n--CREATE TABLE TEMP_FOR_DET1_MYBL_POT16_31MAR25 AS --# THIS IS 1ST DETAILS TABLE FOR MYBL PORTONICS REGULAR, COMMISSION AMOUNT IS CALCULATED IN THIS TABLE --#\nWITH RECHARGE_DETAIL AS\n(\nSELECT /*+ PARALLEL(10)*/ DISTINCT 'Online' DD_CODE,ID, RETAILER_MSISDN RET_MSISDN,RECHARGE_AMOUNT,COMMISSION,TOP_UP_DATE\nFROM MY_BL_POT_RECHARGE_MONTHLY_31MAR25 EV \nINNER JOIN TEMP_FOR_MYBL_RPOT_16_31_MAR25 DL ON RECHARGE_AMOUNT = DENO \nAND TRUNC(TOP_UP_DATE) BETWEEN TRUNC(START_DATE) AND TRUNC(END_DATE)\nWHERE RETAILER_MSISDN IN('01953348398') --# THIS LOGIC IS FOR THE BELOW SRF CONDITION  --#\n--#\n--7.\tRecharge (retailer to subscriber) must be done from below list of retailer EV MSISDN:\n--    CHANNEL_TYPE\tPARTNER_NAMES\tRETAILER_MSISDN\n--    Online\tPortonics\t01953348398\n--#\nAND (COMMISSION_FLAG IS NULL OR COMMISSION_FLAG='REGULAR') --#  THIS LOGIC IS FOR THE 4TH SRF CONDITION (4.Regular campaigns will get 4th highest priority. Transactions of segmented, hourly and special day campaigns will not be considered here) --#\n)\nSELECT * FROM RECHARGE_DETAIL;-- 0  Rows; --# CREATE THE 2ND DETAILS TABLE FROM HERE (TEMP_FOR_DET2_MYBL_POT16_31MAR25) --#\n,RETAILER_WISE_HIT_COUNT AS (\n    SELECT /*+ PARALLEL(10)*/ DD_CODE,RET_MSISDN, RECHARGE_AMOUNT,SUM(COMMISSION) COMMISSION_AMOUNT, COUNT(1) HIT,COUNT(1)*RECHARGE_AMOUNT TOTAL_RECHARGE\n    FROM RECHARGE_DETAIL\n    GROUP BY DD_CODE,RET_MSISDN, RECHARGE_AMOUNT\n)\nSELECT * FROM RETAILER_WISE_HIT_COUNT;  -- 0  Rows; --# CREATE THE 1ST DETAILS TABLE FROM HERE (TEMP_FOR_DET1_MYBL_POT16_31MAR25) --#\nSELECT DD_CODE, SUM(RECHARGE_AMOUNT*HIT) TOTAL_RECHARGE, SUM(COMMISSION_AMOUNT)  COMMISSION_AMOUNT\nFROM RETAILER_WISE_HIT_COUNT\nGROUP BY DD_CODE; -- 0 TK Total Recharge and Commission Amount\n\n--STEP 3: OVERLOOKING CREATED TABLE DATA\nSELECT * FROM TEMP_FOR_DET1_MYBL_POT16_31MAR25; --- 0  Rows\nSELECT SUM(COMMISSION_AMOUNT) FROM TEMP_FOR_DET1_MYBL_POT16_31MAR25;-- 0 TK\n\n--STEP 4: MERGE TEMP TABLE OF RECHARGE DATA USING 2ND DETAILS TABLE FOR SEPERATING CAMPAIGN WISE TRANSACTIONS\nMERGE INTO MY_BL_POT_RECHARGE_MONTHLY_31MAR25  T\nUSING TEMP_FOR_DET2_MYBL_POT16_31MAR25 S\nON (T.ID=S.ID)\nWHEN MATCHED THEN\n    UPDATE SET T.COMMISSION_FLAG='REGULAR',\n    T.COMMISSION_AMOUNT = S.COMMISSION;\nCOMMIT;\n\nSELECT COMMISSION_FLAG, COUNT(1),SUM(COMMISSION_AMOUNT) FROM MY_BL_POT_RECHARGE_MONTHLY_31MAR25  GROUP BY COMMISSION_FLAG;\n-- Sample output:\n-- \"REGULAR\"     | 37,747   | 1,464,765.1\n-- \"SPECIAL_DAY\" | X,XXX    | XXX,XXX.XX\n-- \"HOURLY\"      | X,XXX    | XXX,XXX.XX\n\n--------------------------------- REPORT SETUP QUERY -----------------------------------------\n\n--STEP 5: PREPARE FOR REPORT PUBLISHING\n--REPORT_ID : 0011 (UPDATE WITH ACTUAL REPORT ID)\nSELECT REPORTID REPORT_ID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Commission for MyBL_Portonics_16th Mar25 to 31st Mar25';\n--BASE_CYCLE_ID : 0022 (UPDATE WITH ACTUAL BASE CYCLE ID)\n--# SPECIAL INSTRUCTION : BASE_CYCLE = month of commission END DATE (Mar_25) --#\nSELECT CYCLEID BASE_CYCLE_ID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Mar_25';  --# BASE_CYCLE(REPORT_MONTH) -- commission end date (BASE_CYCLE/REPORT_MONTH): 31-Mar-2025 ? 'Mar_25' --#\n--REPORT_CYCLE_ID : 0033 (UPDATE WITH ACTUAL REPORT CYCLE ID)\nSELECT REPORT_CYCLE_ID,* FROM COMMISSIONCYCLEREPORTS where REPORTID = 0011 and  CYCLEID = 0022; \n\n--CHECK ADHOC TABLE DATA\nSELECT * FROM ad_hoc_data where REPORT_CYCLE_ID = 0033;\n--delete from ad_hoc_data where REPORT_CYCLE_ID = 0033;\n--commit;\n\n--INSERT THE CHANNEL WISE CALCULATED COMMISSION DATA\nINSERT INTO AD_HOC_DATA (ID, REPORT_CYCLE_ID, CHANNEL_CODE,COMMISSION_AMOUNT,AMOUNT_TYPE_ID,AMOUNT)\nSELECT AD_HOC_DATA_ID.NEXTVAL ID, 0033 REPORT_CYCLE_ID, DD_CODE, COMMISSION_AMOUNT,1,TOTAL_RECHARGE\nFROM (\nSELECT DD_CODE, SUM(RECHARGE_AMOUNT*HIT) TOTAL_RECHARGE, SUM(COMMISSION_AMOUNT)  COMMISSION_AMOUNT\nFROM TEMP_FOR_DET1_MYBL_POT16_31MAR25\nGROUP BY DD_CODE\n);\ncommit;\n\n--CHECK SUM OF COMMISSION AMOUNT\nSELECT SUM(COMMISSION_AMOUNT) FROM ad_hoc_data where REPORT_CYCLE_ID = 0033; --  0 TK  \n\n--PURLISH_CYCLE_ID : 0044 (UPDATE WITH ACTUAL PURLISH CYCLE ID)\n--# SPECIAL INSTRUCTION : PUBLISH_CYCLE = current sysdate month (e.g. Jun_25 if today = 30-Jun-2025) --#\nSELECT CYCLEID PURLISH_CYCLE_ID FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Apr_25'; --PURLISH_CYCLE(REPORT_PUBLISH_MONTH)\n\n\n--STEP 6: SET UP COMMISSION DETAILS IN COMMISSION PLATFORM\n--# PROC_COMMISSION_DETAIL_SETUP(<REPORT_TITLE>, <PURLISH_CYCLE_ID>, <DETAIL1>, <LEVEL1>, ..., <DETAIL9>, <LEVEL9>); --#\nEXEC PROC_COMMISSION_DETAIL_SETUP('Commission for MyBL_Portonics_16th Mar25 to 31st Mar25',0044,'TEMP_FOR_DET1_MYBL_POT16_31MAR25','Deno Details');\n\n\n--STEP 7: FINALIZE AND PUBLISH COMMISSION REPORT\n--# FINALIZE_REPORT_ADHOC(<REPORT_NAME>, <REPORT_CYCLE_ID>, <BASE_CYCLE>, <PUBLISH_CYCLE>, <APPROVAL_FLOW_ID>, <PUBLISH_TYPE>) --#\nEXEC FINALIZE_REPORT_ADHOC('Commission for MyBL_Portonics_16th Mar25 to 31st Mar25', 0033,'Mar_25', 'Apr_25',290, 1); --# FOLLOW THE BASE_CYCLE & PUBLISH_CYCLE SPECIAL INSTRUCTION HERE ALSO --#\n"}
{"srf": "```markdown\n# Commission Business Logics: MyBL_Portonics_1st Mar25 to 31st Mar25_Postpaid\n**Commission Name:** Commission for MyBL_Portonics_1st Mar25 to 31st Mar25_Postpaid  \n**Start Date:** 1-Mar-2025  \n**End Date:** 31-Mar-2025  \n**Commission Receiver Channel:** BL Postpaid Self-channels (MYBL Channel)  \n\n**Commission Business Logics:**\n- **KPI:** EV Recharge (All Valid C2S Recharges)  \n- **Target:** Deno and Date specific commission targets, so no Target Required  \n- **Mapping:** Retailer MSISDN: Placeholder_MSISDN  \n- **Commission Calculation Logics:**  \n    - BL-Self channel (MyBL) will receive deno and date specific commission  \n    - Selected Deno (699, 799, 307, 698, 798, 998, 397) will be considered for performance calculation  \n    - All service class below 1000  \n    - Only MyBL App recharge will be considered  \n    - Customers can get cashback multiple times during the campaign period  \n    - Special day campaigns will get 3rd highest priority  \n    - Transactions of segmented and hourly campaigns will not be considered here and transactions of these campaigns will not be considered during calculating commission for regular campaigns of MyBL App  \n    - Need separate cashback commission for each retailer MSISDN  \n    - **Date and Deno Based Commission Structure:**  \n        - 1-Mar: Deno 699: Placeholder_Commission, Deno 799: Placeholder_Commission  \n        - 2-Mar: Deno 698: Placeholder_Commission, Deno 798: Placeholder_Commission  \n        - And so on...  \n\n**Detail formats:**  \n- **Detail 1:** RET_MSISDN, RECHARGE_AMOUNT, HIT, TOTAL_RECHARGE, COMMISSION_AMOUNT  \n```", "sql": "--------------------------------- REPORT HELPER QUERY -----------------------------------------\n----- STEP 1: VERIFY SUPPORTING DATA & THIS TABLE IS ALREADY EXISTING, NO NEED TO CREATE FURTHER \nSELECT * FROM TEMP_FOR_MYBL_SSL_REG_01_31_MAR25;--0  Rows; --# SUPPORTING DATA FROM SRF UPLOADED IN THIS TABLE --#\n--DROP TABLE MY_BL_POSTO_REC_MON_31MAR25 PURGE;\n\n--SELECT DISTINCT REFERENCE_ID FROM MY_BL_POSTO_REC_MON_31MAR25;--0  Rows --# THIS TABLE IS TEMP TABLE FOR EV RECHARGE TABLE FOR MAR 25 AS THE EV RECHAGE TABLE IS VERY BIG --#\n\n----- STEP 2: COMMISSION CALCULATION QUERY START\nCREATE TABLE MY_BL_POSTO_REC_MON_31MAR25 AS\nSELECT MY_BL_RECHARGE_MONTHLY_SEQ.NEXTVAL ID, RETAILER_MSISDN, SUB_MSISDN, TOP_UP_DATE, TOP_UP_TIME,SERVICE_CLASS_ID, RECHARGE_AMOUNT, SERVICE_TYPE, REFERENCE_ID\nFROM EV_RECHARGE_COM_DAILY\nWHERE TOP_UP_DATE BETWEEN TRUNC(LAST_DAY(ADD_MONTHS(SYSDATE,-2)))+1 AND TRUNC(LAST_DAY(ADD_MONTHS(SYSDATE,-1)))\nand SERVICE_CLASS_ID >= 1000 --# THIS IS FOR Others: All service class equal or above  1000 SRF LOGIC --#\n;\n\nSELECT * FROM TEMP_FOR_DET2_MYBL_SSL_01_30NOV24;--0  Rows --# THIS IS 2ND DETAILS TABLE FOR MYBL PORTONICS POSTPAID WHERE WE KEEP FLAG WISE DATA --#\nSELECT * FROM TEMP_FOR_DET1_MYB_POR_01_31MAR25; --# THIS IS 1ST DETAILS TABLE FOR MYBL PORTONICS POSTPAID, COMMISSION AMOUNT IS CALCULATED IN THIS TABLE --#\n\n--DROP TABLE TEMP_FOR_DET2_MYBL_SSL_01_30NOV24 PURGE;\n--CREATE TABLE TEMP_FOR_DET2_MYBL_SSL_01_30NOV24 AS --# THIS IS 2ND DETAILS TABLE FOR MYBL PORTONICS POSTPAID WHERE WE KEEP FLAG WISE DATA --#\n--DROP TABLE TEMP_FOR_DET1_MYB_POR_01_31MAR25 PURGE;\nCREATE TABLE TEMP_FOR_DET1_MYB_POR_01_31MAR25 AS --# THIS IS 1ST DETAILS TABLE FOR MYBL PORTONICS POSTPAID, COMMISSION AMOUNT IS CALCULATED IN THIS TABLE --#\nWITH RECHARGE_DETAIL AS\n(\nSELECT /*+ PARALLEL(10)*/ DISTINCT 'Online' DD_CODE,ID, RETAILER_MSISDN RET_MSISDN,RECHARGE_AMOUNT,COMMISSION,TOP_UP_DATE\nFROM MY_BL_POSTO_REC_MON_31MAR25 EV \nINNER JOIN TEMP_FOR_MYBL_SSL_REG_01_31_MAR25 DL ON RECHARGE_AMOUNT = DENO \nAND TRUNC(TOP_UP_DATE) BETWEEN TRUNC(START_DATE) AND TRUNC(END_DATE)\nWHERE RETAILER_MSISDN='01953348398' --# THIS LOGIC IS FOR THE BELOW SRF CONDITION --#\n--#\n--7.\tRecharge (retailer to subscriber) must be done from below list of retailer EV MSISDN:\n--     CHANNEL_TYPE\tPARTNER_NAMES\tRETAILER_MSISDN\n--     Online\tPortonics\t01953348398\n--#\n)\n--SELECT * FROM RECHARGE_DETAIL;--0  Rows; --# CREATE THE 2ND DETAILS TABLE FROM HERE (TEMP_FOR_DET2_MYBL_SSL_01_30NOV24) --#\n,RETAILER_WISE_HIT_COUNT AS (\n    SELECT /*+ PARALLEL(10)*/ DD_CODE,RET_MSISDN, RECHARGE_AMOUNT, COUNT(1) HIT,COUNT(1)*RECHARGE_AMOUNT TOTAL_RECHARGE,SUM(COMMISSION) COMMISSION_AMOUNT\n    FROM RECHARGE_DETAIL\n    GROUP BY DD_CODE,RET_MSISDN, RECHARGE_AMOUNT\n)\nSELECT * FROM RETAILER_WISE_HIT_COUNT;  -- 0  Rows; --# CREATE THE 1ST DETAILS TABLE FROM HERE (TEMP_FOR_DET1_MYB_POR_01_31MAR25) --#\nSELECT DD_CODE, SUM(RECHARGE_AMOUNT*HIT) TOTAL_RECHARGE, SUM(COMMISSION_AMOUNT)  COMMISSION_AMOUNT\nFROM RETAILER_WISE_HIT_COUNT\nGROUP BY DD_CODE; --34230.01 TK Total Recharge and Commission Amount\n\n--STEP 3: OVERLOOKING CREATED TABLE DATA\nSELECT * FROM TEMP_FOR_DET1_MYB_POR_01_31MAR25;--0  Rows\nSELECT SUM(COMMISSION_AMOUNT) FROM TEMP_FOR_DET1_MYB_POR_01_31MAR25;--245790.83 TK\n\n--------------------------------- REPORT SETUP QUERY -----------------------------------------\n\n--STEP 5: PREPARE FOR REPORT PUBLISHING\n--REPORT_ID : 0011 (UPDATE WITH ACTUAL REPORT ID)\nSELECT REPORTID REPORT_ID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Commission for MyBL_Portonics_1st Mar25 to 31st Mar25_Postpaid';\n--BASE_CYCLE_ID : 0022 (UPDATE WITH ACTUAL BASE CYCLE ID)\n--# SPECIAL INSTRUCTION : BASE_CYCLE = month of commission END DATE (Mar_25) --#\nSELECT CYCLEID BASE_CYCLE_ID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Mar_25'; --# BASE_CYCLE(REPORT_MONTH) -- commission end date (BASE_CYCLE/REPORT_MONTH): 31-Mar-2025 ? 'Mar_25' --#\n--REPORT_CYCLE_ID : 0033 (UPDATE WITH ACTUAL REPORT CYCLE ID)\nSELECT REPORT_CYCLE_ID,* FROM COMMISSIONCYCLEREPORTS where REPORTID = 0011 and  CYCLEID = 0022; \n\n--CHECK ADHOC TABLE DATA\nSELECT * FROM ad_hoc_data where REPORT_CYCLE_ID = 0033;\n--delete from ad_hoc_data where REPORT_CYCLE_ID = 0033;\n--commit;\n\n--INSERT THE CHANNEL WISE CALCULATED COMMISSION DATA\nINSERT INTO AD_HOC_DATA (ID, REPORT_CYCLE_ID, CHANNEL_CODE,COMMISSION_AMOUNT,AMOUNT_TYPE_ID,AMOUNT)\nSELECT AD_HOC_DATA_ID.NEXTVAL ID, 0033 REPORT_CYCLE_ID, DD_CODE, COMMISSION_AMOUNT,1,TOTAL_RECHARGE\nFROM (\nSELECT DD_CODE, SUM(RECHARGE_AMOUNT*HIT) TOTAL_RECHARGE, SUM(COMMISSION_AMOUNT)  COMMISSION_AMOUNT\nFROM TEMP_FOR_DET1_MYB_POR_01_31MAR25\nGROUP BY DD_CODE\n);\ncommit;\n\n--CHECK SUM OF COMMISSION AMOUNT\nSELECT SUM(COMMISSION_AMOUNT) FROM ad_hoc_data where REPORT_CYCLE_ID = 0033; --  0 TK  \n\n--PURLISH_CYCLE_ID : 0044 (UPDATE WITH ACTUAL PURLISH CYCLE ID)\n--# SPECIAL INSTRUCTION : PUBLISH_CYCLE = current sysdate month (e.g. Jun_25 if today = 30-Jun-2025) --#\nSELECT CYCLEID PURLISH_CYCLE_ID FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Apr_25'; --PURLISH_CYCLE(REPORT_PUBLISH_MONTH)\n\n\n--STEP 6: SET UP COMMISSION DETAILS IN COMMISSION PLATFORM\n--# PROC_COMMISSION_DETAIL_SETUP(<REPORT_TITLE>, <PURLISH_CYCLE_ID>, <DETAIL1>, <LEVEL1>, ..., <DETAIL9>, <LEVEL9>); --#\nEXEC PROC_COMMISSION_DETAIL_SETUP('Commission for MyBL_Portonics_1st Mar25 to 31st Mar25_Postpaid',0044,'TEMP_FOR_DET1_MYB_POR_01_31MAR25','Deno Details');\n\n\n--STEP 7: FINALIZE AND PUBLISH COMMISSION REPORT\n--# FINALIZE_REPORT_ADHOC(<REPORT_NAME>, <REPORT_CYCLE_ID>, <BASE_CYCLE>, <PUBLISH_CYCLE>, <APPROVAL_FLOW_ID>, <PUBLISH_TYPE>) --#\nEXEC FINALIZE_REPORT_ADHOC('Commission for MyBL_Portonics_1st Mar25 to 31st Mar25_Postpaid', 0033,'Mar_25', 'Apr_25',290, 1); --# FOLLOW THE BASE_CYCLE & PUBLISH_CYCLE SPECIAL INSTRUCTION HERE ALSO --#\n"}
{"srf": "```markdown\n# Commission Business Logics: MyBL_SSL_1st Mar25 to 31st Mar25_Postpaid\n**Commission Name:** Commission for MyBL_SSL_1st Mar25 to 31st Mar25_Postpaid  \n**Start Date:** 1-Mar-2025  \n**End Date:** 31-Mar-2025  \n**Commission Receiver Channel:** BL Self Care Channel (MYBL Channel)  \n\n**Commission Business Logics:**\n- **KPI:** EV Recharge (All Valid C2S Recharges)  \n- **Target:** Deno and Date specific commission targets, so no Target Required  \n- **Mapping:** Retailer MSISDN: 1967021235  \n- **Commission Calculation Logics:**  \n    - BL-Self channel (MyBL) will receive deno and date specific commission  \n    - Selected Deno (118, 157, 169, 184, 227, 229, 348, 397, 497, 548, 549, 599, 649, 777, 794, 998) will be considered for performance calculation  \n    - All service class equal or above 1000  \n    - Only MyBL App recharge will be considered  \n    - Customers can get cashback multiple times during the campaign period  \n    - Regular campaigns will get the lowest priority  \n    - Transactions of segmented, special day, and hourly campaigns will not be considered here  \n    - Need separate cashback commission for each retailer MSISDN  \n    - **Date and Deno Based Commission Structure:**  \n        - 1-Mar to 22-Mar: Deno 118: 11.11, Deno 169: 11.11, Deno 229: 38.89  \n        - 23-Mar to 31-Mar: Deno 118: 11.11, Deno 169: 11.11, Deno 229: 38.89  \n\n**Detail formats:**  \n- **Detail 1:** RET_MSISDN, RECHARGE_AMOUNT, HIT, TOTAL_RECHARGE, COMMISSION_AMOUNT  \n```", "sql": "--------------------------------- REPORT HELPER QUERY -----------------------------------------\n----- STEP 1: VERIFY SUPPORTING DATA & THIS TABLE IS ALREADY EXISTING, NO NEED TO CREATE FURTHER \nSELECT * FROM TEMP_FOR_MYBL_SSL_REG_01_31_MAR25;--0  Rows; --# SUPPORTING DATA FROM SRF UPLOADED IN THIS TABLE --#\n--DROP TABLE MY_BL_POSTO_REC_MON_31MAR25 PURGE;\n\n--SELECT DISTINCT REFERENCE_ID FROM MY_BL_POSTO_REC_MON_31MAR25;--0  Rows --# THIS TABLE IS TEMP TABLE FOR EV RECHARGE TABLE FOR MAR 25 AS THE EV RECHAGE TABLE IS VERY BIG --#\n\n----- STEP 2: COMMISSION CALCULATION QUERY START\nCREATE TABLE MY_BL_POSTO_REC_MON_31MAR25 AS\nSELECT MY_BL_RECHARGE_MONTHLY_SEQ.NEXTVAL ID, RETAILER_MSISDN, SUB_MSISDN, TOP_UP_DATE, TOP_UP_TIME,SERVICE_CLASS_ID, RECHARGE_AMOUNT, SERVICE_TYPE, REFERENCE_ID\nFROM EV_RECHARGE_COM_DAILY\nWHERE TOP_UP_DATE BETWEEN TRUNC(LAST_DAY(ADD_MONTHS(SYSDATE,-2)))+1 AND TRUNC(LAST_DAY(ADD_MONTHS(SYSDATE,-1)))\nand SERVICE_CLASS_ID >= 1000 --# THIS IS FOR Others: All service class equal or above  1000 SRF LOGIC --#\n;\n\nSELECT * FROM TEMP_FOR_DET2_MYBL_SSL_01_30NOV24;--0  Rows --# THIS IS 2ND DETAILS TABLE FOR MYBL SSL POSTPAID WHERE WE KEEP FLAG WISE DATA --#\nSELECT * FROM TEMP_FOR_DET1_MYB_SSLL_01_31MAR25; --# THIS IS 1ST DETAILS TABLE FOR MYBL SSL POSTPAID, COMMISSION AMOUNT IS CALCULATED IN THIS TABLE --#\n\n--DROP TABLE TEMP_FOR_DET2_MYBL_SSL_01_30NOV24 PURGE;\n--CREATE TABLE TEMP_FOR_DET2_MYBL_SSL_01_30NOV24 AS --# THIS IS 2ND DETAILS TABLE FOR MYBL SSL POSTPAID WHERE WE KEEP FLAG WISE DATA --#\n--DROP TABLE TEMP_FOR_DET1_MYB_SSLL_01_31MAR25 PURGE;\nCREATE TABLE TEMP_FOR_DET1_MYB_SSLL_01_31MAR25 AS --# THIS IS 1ST DETAILS TABLE FOR MYBL SSL POSTPAID, COMMISSION AMOUNT IS CALCULATED IN THIS TABLE --#\nWITH RECHARGE_DETAIL AS\n(\nSELECT /*+ PARALLEL(10)*/ DISTINCT 'Online' DD_CODE,ID, RETAILER_MSISDN RET_MSISDN,RECHARGE_AMOUNT,COMMISSION,TOP_UP_DATE\nFROM MY_BL_POSTO_REC_MON_31MAR25 EV \nINNER JOIN TEMP_FOR_MYBL_SSL_REG_01_31_MAR25 DL ON RECHARGE_AMOUNT = DENO \nAND TRUNC(TOP_UP_DATE) BETWEEN TRUNC(START_DATE) AND TRUNC(END_DATE)\nWHERE RETAILER_MSISDN='01967021235' AND REFERENCE_ID LIKE 'BLAPP%' --# THIS LOGIC IS FOR THE BELOW SRF CONDITION  --#\n--#\n--7.\tRecharge (retailer to subscriber) must be done from below list of retailer EV MSISDN:\n--    CHANNEL_TYPE\tPARTNER_NAMES\tRETAILER_MSISDN\n--    Online\tBL Self-channels\t01967021235\n--#\n)\n--SELECT * FROM RECHARGE_DETAIL;--0  Rows; --# CREATE THE 2ND DETAILS TABLE FROM HERE (TEMP_FOR_DET2_MYBL_SSL_01_30NOV24) --#\n,RETAILER_WISE_HIT_COUNT AS (\n    SELECT /*+ PARALLEL(10)*/ DD_CODE,RET_MSISDN, RECHARGE_AMOUNT, COUNT(1) HIT,COUNT(1)*RECHARGE_AMOUNT TOTAL_RECHARGE,SUM(COMMISSION) COMMISSION_AMOUNT\n    FROM RECHARGE_DETAIL\n    GROUP BY DD_CODE,RET_MSISDN, RECHARGE_AMOUNT\n)\nSELECT * FROM RETAILER_WISE_HIT_COUNT;  -- 0  Rows; --# CREATE THE 1ST DETAILS TABLE FROM HERE (TEMP_FOR_DET1_MYB_SSLL_01_31MAR25) --#\nSELECT DD_CODE, SUM(RECHARGE_AMOUNT*HIT) TOTAL_RECHARGE, SUM(COMMISSION_AMOUNT)  COMMISSION_AMOUNT\nFROM RETAILER_WISE_HIT_COUNT\nGROUP BY DD_CODE; --0 TK Total Recharge and Commission Amount\n\n--STEP 3: OVERLOOKING CREATED TABLE DATA\nSELECT * FROM TEMP_FOR_DET1_MYB_SSLL_01_31MAR25;\nSELECT SUM(COMMISSION_AMOUNT) FROM TEMP_FOR_DET1_MYB_SSLL_01_31MAR25;--128603.72 TK\n\n--------------------------------- REPORT SETUP QUERY -----------------------------------------\n\n--STEP 5: PREPARE FOR REPORT PUBLISHING\n--REPORT_ID : 0011 (UPDATE WITH ACTUAL REPORT ID)\nSELECT REPORTID REPORT_ID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Commission for MyBL_SSL_1st Mar25 to 31st Mar25_Postpaid';\n--BASE_CYCLE_ID : 0022 (UPDATE WITH ACTUAL REPORT ID)\n--# SPECIAL INSTRUCTION : BASE_CYCLE = month of commission END DATE (Mar_25) --#\nSELECT CYCLEID BASE_CYCLE_ID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Mar_25'; --# BASE_CYCLE(REPORT_MONTH) -- commission end date (BASE_CYCLE/REPORT_MONTH): 31-Mar-2025 ? 'Mar_25' --#\n--REPORT_CYCLE_ID : 0033 (UPDATE WITH ACTUAL REPORT CYCLE ID)\nSELECT REPORT_CYCLE_ID,* FROM COMMISSIONCYCLEREPORTS where REPORTID = 0011 and  CYCLEID = 0022; \n\n--CHECK ADHOC TABLE DATA\nSELECT * FROM ad_hoc_data where REPORT_CYCLE_ID = 0033;\n--delete from ad_hoc_data where REPORT_CYCLE_ID = 0033;\n--commit;\n\n--INSERT THE CHANNEL WISE CALCULATED COMMISSION DATA\nINSERT INTO AD_HOC_DATA (ID, REPORT_CYCLE_ID, CHANNEL_CODE,COMMISSION_AMOUNT,AMOUNT_TYPE_ID,AMOUNT)\nSELECT AD_HOC_DATA_ID.NEXTVAL ID, 0033 REPORT_CYCLE_ID, DD_CODE, COMMISSION_AMOUNT,1,TOTAL_RECHARGE\nFROM (\nSELECT DD_CODE, SUM(RECHARGE_AMOUNT*HIT) TOTAL_RECHARGE, SUM(COMMISSION_AMOUNT)  COMMISSION_AMOUNT\nFROM TEMP_FOR_DET1_MYB_SSLL_01_31MAR25\nGROUP BY DD_CODE\n);\ncommit;\n\n--CHECK SUM OF COMMISSION AMOUNT\nSELECT SUM(COMMISSION_AMOUNT) FROM ad_hoc_data where REPORT_CYCLE_ID = 0033; --  0 TK \n\n--PURLISH_CYCLE_ID : 0044 (UPDATE WITH ACTUAL PURLISH CYCLE ID)\n--# SPECIAL INSTRUCTION : PUBLISH_CYCLE = current sysdate month (e.g. Jun_25 if today = 30-Jun-2025) --#\nSELECT CYCLEID PURLISH_CYCLE_ID FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Apr_25'; --PURLISH_CYCLE(REPORT_PUBLISH_MONTH)\n\n\n--STEP 6: SET UP COMMISSION DETAILS IN COMMISSION PLATFORM\n--# PROC_COMMISSION_DETAIL_SETUP(<REPORT_TITLE>, <PURLISH_CYCLE_ID>, <DETAIL1>, <LEVEL1>, ..., <DETAIL9>, <LEVEL9>); --#\nEXEC PROC_COMMISSION_DETAIL_SETUP('Commission for MyBL_SSL_1st Mar25 to 31st Mar25_Postpaid',0044,'TEMP_FOR_DET1_MYB_SSLL_01_31MAR25','Deno Details');\n\n\n--STEP 7: FINALIZE AND PUBLISH COMMISSION REPORT\n--# FINALIZE_REPORT_ADHOC(<REPORT_NAME>, <REPORT_CYCLE_ID>, <BASE_CYCLE>, <PUBLISH_CYCLE>, <APPROVAL_FLOW_ID>, <PUBLISH_TYPE>) --#\nEXEC FINALIZE_REPORT_ADHOC('Commission for MyBL_SSL_1st Mar25 to 31st Mar25_Postpaid', 0033,'Mar_25', 'Apr_25',290, 1); --# FOLLOW THE BASE_CYCLE & PUBLISH_CYCLE SPECIAL INSTRUCTION HERE ALSO --#\n"}
{"srf": "# Commission Business Logics: DD HIT Campaign_27th to 31st May25\n\n**Commission Name:** DD HIT Campaign_27th to 31st May25  \n**Start Date:** 27-May-2025  \n**End Date:** 31-May-2025  \n**Commission Receiver Channel:** Distributor\n\n**Commission Business Logics:**\n- **KPI:** EV Recharge (All Valid C2S Recharges)\n- **Target:** Distributor has a target and it will be given by Business Team\n- **Mapping:** Agent list of 31st May'25 will be considered\n- **Commission Calculation Logics:**\n    - Selected Deno (709) will be considered for performance calculation.\n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.\n    - Upon achieving Deno HIT target (Count of 709 denomination), Distributor will be given achievement-based incentives.\n    - Maximum Achievement capping is 200%.\n    - Achievement Slab:\n        | Achievement        | Incentives     |\n        |-------------------|---------------|\n        | 200% and Above    | TARGET*2*50   |\n        | 100% and Above    | HIT*50        |\n        | Below 100%        | 0             |\n\n**Detail formats:**\n- **Detail 1:** DD_CODE, TARGET, HIT, ACH_PER, COMMISSION\n- **Detail 2:** DD_CODE, RETAILER_CODE, RET_MSISDN, CUSTOMER_MSISDN, RECHARGE_AMOUNT\n", "sql": "-------------------------------HELPER QUERY------------------------------------\n-- 7451 9574 61612\n\nCREATE TABLE TEMP_FOR_DD_HIT_TAR_31MAY25 AS\nselect CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET \nWHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \nwhere REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'DD HIT Campaign_27th to 31st May25') and  \nCYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'May_25'));--106  Rows\n\nSELECT * FROM TEMP_FOR_DD_HIT_TAR_31MAY25;--106  Rows\n\n--SELECT * FROM VW_EMPLOYEESALESCOM_MONTHLY;\n\n--DROP TABLE TEMP_FOR_AG_LST_MAP_31MAY25 PURGE;\nCREATE TABLE TEMP_FOR_AG_LST_MAP_31MAY25 AS\nSELECT TAR.*,AG.RET_CODE RETAILER_CODE, AG.RET_MOBILE RET_MSISDN \nFROM TEMP_FOR_DD_HIT_TAR_31MAY25 TAR \nINNER JOIN DD_RSO_RET_MAPPING_DAILY AG ON AG.DD_CODE=TAR.DD_CODE AND AG.DATA_DATE = '31-MAY-25';--553098  Rows\n\nSELECT * FROM TEMP_FOR_AG_LST_MAP_31MAY25;--553098  Rows\nSELECT * FROM EV_RECHARGE_COM_DAILY;\n\n--DROP TABLE TEMP_FOR_DD_HIT_DET_31_MAY25 PURGE;\nCREATE TABLE TEMP_FOR_DD_HIT_DET_31_MAY25 AS\nWITH RSO_WISE_ACHIEVEMENT AS ( \n    SELECT /*+ parallel(10) */ AG.DD_CODE,AG.TARGET,COUNT(RECHARGE_AMOUNT) HIT\n    FROM TEMP_FOR_AG_LST_MAP_31MAY25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '27-MAY-25' AND '31-MAY-25') AND EV.RECHARGE_AMOUNT IN (709)\n--    AND SERVICE_CLASS_ID NOT IN (141) \n--    AND NOT EXISTS(SELECT MOBILENO FROM TEMP_FOR_VW_EMPLOYEESALESCOM_MONTHLY VE WHERE VE.DATE_DATE='31-MAY-25' AND '0'||VE.MOBILENO=EV.SUB_MSISDN)\n    GROUP BY AG.DD_CODE,  AG.TARGET\n)\n--SELECT * FROM RSO_WISE_ACHIEVEMENT;--335  Rows\n,RET_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((HIT/TARGET)*100) ACH_PER\nFROM RSO_WISE_ACHIEVEMENT ACHIEVEMENT\n)\n--SELECT * FROM RET_WISE_PERCENTAGE;--354  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,  TARGET, HIT,ACH_PER,\n    CASE\n        WHEN  ACH_PER >= 200 THEN TARGET*2*50\n        WHEN  ACH_PER >= 100 THEN HIT*50\n        ELSE 0\n    END COMMISSION\n    FROM RET_WISE_PERCENTAGE \n)\nSELECT * FROM CALCULATE_COMMISSION;--134  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;--310950 TAKA\n\nSELECT * FROM TEMP_FOR_DD_HIT_DET_31_MAY25;--318  Rows\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_HIT_DET_31_MAY25;--53400         241835      177710      310950           276220           337595      360780  TK\n\n-------------DETAIL------------\n\n--DROP TABLE TEMP_FOR_DD_HIT_DET2_31MAY25 PURGE;\nCREATE TABLE TEMP_FOR_DD_HIT_DET2_31MAY25 AS\nWITH DD_WISE_ACHIEVEMENT AS ( \n    SELECT AG.DD_CODE,RETAILER_CODE,RET_MSISDN,SUB_MSISDN CUSTOMER_MSISDN,RECHARGE_AMOUNT--AG.TARGET,COUNT(RECHARGE_AMOUNT) HIT\n    FROM TEMP_FOR_AG_LST_MAP_31MAY25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '27-MAY-25' AND '31-MAY-25') AND EV.RECHARGE_AMOUNT IN (709)\n--    AND SERVICE_CLASS_ID NOT IN (141) \n--    AND NOT EXISTS(SELECT MOBILENO FROM TEMP_FOR_VW_EMPLOYEESALESCOM_MONTHLY VE WHERE VE.DATE_DATE='31-MAY-25' AND '0'||VE.MOBILENO=EV.SUB_MSISDN)\n)\nSELECT * FROM DD_WISE_ACHIEVEMENT;--1151  Rows\n\nselect * from TEMP_FOR_DD_HIT_DET2_31MAY25;--1151  Rows"}
{"srf": "# Commission Business Logics: Distributor Bundle Booster Campaign_19th to 23rd Feb25\n\n**Commission Name:** Distributor Bundle Booster Campaign_19th to 23rd Feb25  \n**Start Date:** 19-Feb-2025  \n**End Date:** 23-Feb-2025  \n**Commission Receiver Channel:** Distributor\n\n**Commission Business Logics:**\n- **KPI:** EV Recharge (All Valid C2S Recharges)\n- **Target:** Distributor will be given bundle targets with achievement levels (provided by Business Team)\n- **Mapping:** Agent list of 23rd Feb'25 will be considered\n- **Calculation Logics:**\n    - Selected bundle products and denominations will be considered for performance calculation. (Deno List will share by B2C)\n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.\n    - Upon achieving bundle target, Distributor will be given achievement-based incentives.\n    - Slab-based commission structure applies based on achievement percentage.\n    - In Addition: If Region achieved 100% Recharge target, then >=100% achiever DD’s will get additional 0.10% bonus incentive on total Recharge amount on top of their incentive slab.\n    - Example for Additional Bonus incentive Calculation: if DD achieves >=100% target, then  DD will get 0.8%+0.10% incentive. for >=110% achievers DD, incentive will be 0.9%+0.10% .\n    - **Achievement Slab:**\n        | Achievement     | Incentive of Total Recharge Amount | Additional Incentive if Region 100% |\n        |----------------|------------------------------------|-------------------------------------|\n        | 100%-109%      | 0.8% of Total Recharge Amount       | 0.8% + 0.10%                        |\n        | 110% and Above | 0.9% of Total Recharge Amount       | 0.9% + 0.10%                        |\n\n**Detail formats:**\n- **Detail 1:** DISTRIBUTOR_CODE, TARGET, HIT, ACH_PER, COMMISSION\n- **Detail 2:** DISTRIBUTOR_CODE, RETAILER_CODE, RET_MSISDN, CUSTOMER_MSISDN, RECHARGE_AMOUNT\n", "sql": "-------------------------------HELPER QUERY------------------------------------\n--drop table DD_19_23_FEB25_62372 purge;\n--CREATE TABLE DD_19_23_FEB25_62372 AS\n--select CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET \n--WHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \n--where REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Bundle Booster_Central Cluster_25th to 31sth Jan25') and  \n--CYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jan_25'));--1278  Rows\n\nSELECT * FROM DD_19_23_FEB25_62372;--238  Rows\n\nUPDATE DD_19_23_FEB25_62372 SET RECHARGE_TARGET = ROUND(RECHARGE_TARGET);\nCOMMIT;\n\n--DROP TABLE TEMP_FOR_AGLIST_MAP_23FEB25 PURGE;\nCREATE TABLE TEMP_FOR_AGLIST_MAP_23FEB25 AS\nSELECT TAR.*,AG.RETAILER_CODE, AG.TOPUP_MSISDN RET_MSISDN \nFROM DD_19_23_FEB25_62372 TAR \nINNER JOIN AGENT_LIST_DAILY AG ON AG.DIST_CODE=TAR.DD_CODE AND AG.DATA_DATE = '23-FEB-25';--117982  Rows     \n\nSELECT * FROM TEMP_FOR_AGLIST_MAP_23FEB25;--425194  Rows\n\n--DROP TABLE TEMP_FOR_DD_DN_DET_19_23FEB25 PURGE;\nCREATE TABLE TEMP_FOR_DD_DN_DET_19_23FEB25 AS\nWITH DD_WISE_ACHIEVEMENT AS ( \n    SELECT AG.REGION,AG.DD_CODE,AG.RECHARGE_TARGET TARGET,SUM(RECHARGE_AMOUNT) TOTAL_RECHARGE\n    FROM TEMP_FOR_AGLIST_MAP_23FEB25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '19-FEB-25' AND '23-FEB-25') AND EV.RECHARGE_AMOUNT IN (\n19,27,34,36,47,48,56,57,58,64,69,77,81,86,96,97,99,104,117,118,127,129,147,148,149,157,\n167,169,177,196,197,198,199,207,209,222,224,227,229,247,248,249,296,297,298,299,319,337,348,\n396,397,398,399,448,497,498,499,548,549,597,599,649,698,699,798,799,897,899,998,1397\n)\n    GROUP BY AG.REGION,AG.DD_CODE,  AG.RECHARGE_TARGET\n)\n--SELECT * FROM DD_WISE_ACHIEVEMENT;--53  Rows\n,DD_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((TOTAL_RECHARGE/TARGET)*100) ACH_PER\nFROM DD_WISE_ACHIEVEMENT ACHIEVEMENT\n)\n--SELECT * FROM DD_WISE_PERCENTAGE;--53  Rows\n,CENTRAL_WISE_PERCENTAGE AS (\nSELECT REGION, SUM(TARGET) REGION_TARGET, SUM(TOTAL_RECHARGE) CENTRAL_RECHARGE,ROUND((SUM(TOTAL_RECHARGE)/SUM(TARGET))*100) REGION_ACH_PER\nFROM DD_WISE_ACHIEVEMENT ACHIEVEMENT\nGROUP BY REGION\n)\n--SELECT * FROM CENTRAL_WISE_PERCENTAGE;--358  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,  TARGET, TOTAL_RECHARGE,ACH_PER,REGION_ACH_PER,\n    CASE\n        WHEN  ACH_PER >= 110 AND REGION_ACH_PER >= 100 THEN ROUND((TOTAL_RECHARGE*.009)+(TOTAL_RECHARGE*.0010))\n        WHEN  ACH_PER >= 110 THEN ROUND(TOTAL_RECHARGE*.009)\n        WHEN  ACH_PER >= 100 AND REGION_ACH_PER >= 100 THEN ROUND((TOTAL_RECHARGE*.008)+(TOTAL_RECHARGE*.0010))\n        WHEN  ACH_PER >= 100 THEN ROUND(TOTAL_RECHARGE*.008)\n        ELSE 0\n    END COMMISSION\n    FROM DD_WISE_PERCENTAGE DD\n    LEFT JOIN CENTRAL_WISE_PERCENTAGE CC ON CC.REGION = DD.REGION\n    \n)\nSELECT * FROM CALCULATE_COMMISSION;--53  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;--273873 TK\n\nSELECT * FROM TEMP_FOR_DD_DN_DET_19_23FEB25;--236  Rows\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_DN_DET_19_23FEB25;--273873 TK\n\n--SELECT SYSDATE-3 FROM DUAL;\n\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Bundle Booster_10th to 15th May25\n\n**Commission Name:** Distributor Bundle Booster_10th to 15th May25  \n**Start Date:** 10-May-2025  \n**End Date:** 15-May-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges)\n- **Target:** Distributor will be given Deno Recharge target (provided by B2C)  \n- **Mapping:** Agent list of 15th May'25 will be considered  \n- **Calculation Logics:**  \n    - Selected Deno will be considered for performance calculation (Deno List will be shared by B2C)  \n    - Campaign Date: Central Cluster (10th to 15th May’25)  \n    - Deno: ALL Deno (Deno List will be shared by B2C)  \n    - Upon achieving Deno Recharge target (Cumulative of DENO), Distributor will be given incentives as per below slab (Distributor wise Recharge Target will be shared by B2C)  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation  \n    - Slab-based commission structure applies based on achievement percentage  \n\n- **Incentive Slab:**  \n    | Slab   | Incentive of Total Recharge Amount |  \n    |--------|-----------------------------------|  \n    | Slab-1 | 0.7% of Total Recharge Amount      |  \n    | Slab-2 | 0.8% of Total Recharge Amount      |  \n    | Slab-3 | 0.9% of Total Recharge Amount      |  \n\n- **Example:**  \n    - Example calculation and formula as per campaign document  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, Target ach, % Ach, Incentive Amount  \n- **Detail 2:** DD_CODE, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount\n```", "sql": "-------------------------------HELPER QUERY------------------------------------\n--drop table DD_BOOSTER_10_15_MAY25_64075 purge;\n--CREATE TABLE DD_BOOSTER_10_15_MAY25_64075 AS\n--select CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET \n--WHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \n--where REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Bundle Booster Campaign_20th to 24th Mar25') and  \n--CYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Mar_25'));--1278  Rows\n\nSELECT * FROM DD_BOOSTER_10_15_MAY25_64075; -- 333  Rows\n\n\nUPDATE DD_BOOSTER_10_15_MAY25_64075 SET SLAB_1_TARGET = ROUND(SLAB_1_TARGET),SLAB_2_TARGET = ROUND(SLAB_2_TARGET),SLAB_3_TARGET = ROUND(SLAB_3_TARGET);\nCOMMIT;\n\nSELECT * FROM dd_rso_ret_mapping_daily;\n--DROP TABLE TEMP_FOR_AGLIST_MAP_15MAY25 PURGE;\nCREATE TABLE TEMP_FOR_AGLIST_MAP_15MAY25 AS\nSELECT TAR.*,AG.RET_CODE, AG.RET_MOBILE \nFROM DD_BOOSTER_10_15_MAY25_64075 TAR \nINNER JOIN dd_rso_ret_mapping_daily AG ON AG.DD_CODE=TAR.D_CODE AND AG.DATA_DATE = '15-MAY-25';--117982  Rows     \n\nSELECT * FROM TEMP_FOR_AGLIST_MAP_15MAY25;-- 554393  Rows\n\n--DROP TABLE TEMP_FOR_DD_DN_DET_10_15MAY25 PURGE;\n--CREATE TABLE TEMP_FOR_DD_DN_DET_10_15MAY25 AS\nWITH DD_WISE_ACHIEVEMENT AS ( \n    SELECT AG.D_CODE DD_CODE,AG.SLAB_1_TARGET,AG.SLAB_2_TARGET,AG.SLAB_3_TARGET,SUM(RECHARGE_AMOUNT) TOTAL_RECHARGE\n    FROM TEMP_FOR_AGLIST_MAP_15MAY25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MOBILE   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '10-MAY-25' AND '15-MAY-25') AND EV.RECHARGE_AMOUNT IN (\n    19,27,32,42,48,57,58,69,74,77,79,81,97,99,104,117,118,\n    124,127,129,147,149,167,169,177,197,198,199,207,209,219,\n    222,224,227,239,247,249,297,298,299,347,348,349,397,398,\n    399,448,449,497,498,499,548,549,629,648,649,719,729,748,\n    797,848,849,897,899,997,998,1199,1258,1397,1899,1999\n    )\n    GROUP BY AG.D_CODE, AG.SLAB_1_TARGET,AG.SLAB_2_TARGET,AG.SLAB_3_TARGET\n)\n--SELECT * FROM DD_WISE_ACHIEVEMENT;-- 328  Rows\n,DD_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,\nROUND((TOTAL_RECHARGE/SLAB_1_TARGET)*100) ACH_PER_1,\nROUND((TOTAL_RECHARGE/SLAB_2_TARGET)*100) ACH_PER_2,\nROUND((TOTAL_RECHARGE/SLAB_3_TARGET)*100) ACH_PER_3\nFROM DD_WISE_ACHIEVEMENT ACHIEVEMENT\n)\nSELECT * FROM DD_WISE_PERCENTAGE;-- 328  Rows\n--,CENTRAL_WISE_PERCENTAGE AS (\n--SELECT CLUSTER_NAME, \n--SUM(SLAB_1_TARGET) CLUSTER_TARGET_1,\n--SUM(SLAB_2_TARGET) CLUSTER_TARGET_2, \n--SUM(SLAB_3_TARGET) CLUSTER_TARGET_3, \n--SUM(TOTAL_RECHARGE) CENTRAL_RECHARGE,\n--ROUND((SUM(TOTAL_RECHARGE)/SUM(SLAB_1_TARGET))*100) CLUSTER_ACH_PER_1,\n--ROUND((SUM(TOTAL_RECHARGE)/SUM(SLAB_2_TARGET))*100) CLUSTER_ACH_PER_2,\n--ROUND((SUM(TOTAL_RECHARGE)/SUM(SLAB_3_TARGET))*100) CLUSTER_ACH_PER_3\n--FROM DD_WISE_ACHIEVEMENT ACHIEVEMENT\n--GROUP BY CLUSTER_NAME\n--)\n--SELECT * FROM CENTRAL_WISE_PERCENTAGE;--22  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,SLAB_3_TARGET,SLAB_2_TARGET, SLAB_1_TARGET, TOTAL_RECHARGE,ACH_PER_3,ACH_PER_2,ACH_PER_1,\n    CASE\n--        WHEN  TOTAL_RECHARGE >= SLAB_3_TARGET AND CLUSTER_ACH_PER_1 >= 100 THEN ROUND((TOTAL_RECHARGE*.009)+(TOTAL_RECHARGE*.0010))\n        WHEN  TOTAL_RECHARGE >= SLAB_3_TARGET THEN ROUND(TOTAL_RECHARGE*.009)\n--        WHEN  TOTAL_RECHARGE >= SLAB_2_TARGET AND CLUSTER_ACH_PER_2 >= 100 THEN ROUND((TOTAL_RECHARGE*.008)+(TOTAL_RECHARGE*.0010))\n        WHEN  TOTAL_RECHARGE >= SLAB_2_TARGET THEN ROUND(TOTAL_RECHARGE*.008)\n--        WHEN  TOTAL_RECHARGE >= SLAB_1_TARGET AND CLUSTER_ACH_PER_3 >= 100 THEN ROUND((TOTAL_RECHARGE*.007)+(TOTAL_RECHARGE*.0010))\n        WHEN  TOTAL_RECHARGE >= SLAB_1_TARGET THEN ROUND(TOTAL_RECHARGE*.007)\n        ELSE 0\n    END COMMISSION\n    FROM DD_WISE_PERCENTAGE DD\n--    LEFT JOIN CENTRAL_WISE_PERCENTAGE CC ON CC.CLUSTER_NAME = DD.CLUSTER_NAME  \n)\nSELECT * FROM CALCULATE_COMMISSION;-- 328  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;-- 1035602 TK\n\nSELECT * FROM TEMP_FOR_DD_DN_DET_10_15MAY25;-- 336  Rows\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_DN_DET_10_15MAY25;-- 1035602 TK\n\n--SELECT SYSDATE-3 FROM DUAL;\n\n"}
{"srf": "# Commission Business Logics: Distributor Bundle Booster_1st to 5th Jun25\n\n**Commission Name:** Distributor Bundle Booster_1st to 5th Jun25  \n**Start Date:** 1-Jun-2025  \n**End Date:** 5-Jun-2025  \n**Commission Receiver Channel:** Distributor\n\n**Commission Business Logics:**\n- **KPI:** EV Recharge (All Valid C2S Recharges)\n- **Target:** Distributor will be given Deno Recharge target (provided by B2C)\n- **Mapping:** Agent list of 5th Jun'25 will be considered\n- **Calculation Logics:**\n    - Selected Deno will be considered for performance calculation (Deno List will be shared by B2C)\n    - Campaign Date: Central Cluster (1st to 5th Jun’25), Gazipur Region (2nd to 5th Jun’25)\n    - Deno: ALL Deno (Deno List will be shared by B2C)\n    - Upon achieving Deno Recharge target (Cumulative of DENO), Distributor will be given incentives as per below slab (Distributor wise Recharge Target will be shared by B2C)\n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation\n    - Slab-based commission structure applies based on achievement percentage\n- **Incentive Slab:**\n    | Slab   | Incentive of Total Recharge Amount |\n    |--------|-----------------------------------|\n    | Slab-1 | 0.7% of Total Recharge Amount      |\n    | Slab-2 | 0.8% of Total Recharge Amount      |\n    | Slab-3 | 0.9% of Total Recharge Amount      |\n- **Example:**\n    - Example calculation and formula as per campaign document\n\n**Detail formats:**\n- **Detail 1:** DD_CODE, Target, Target ach, % Ach, Incentive Amount\n- **Detail 2:** DD_CODE, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount\n", "sql": "-------------------------------HELPER QUERY------------------------------------\n-- 7451 9574 61612\n\n--CREATE TABLE TEMP_FOR_DENO_CAM_TAR_5JUN25 AS\n--select CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET \n--WHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \n--where REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Bundle Booster_1st to 5th Jun25') and  \n--CYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jun_25'));--10  Rows\n\nSELECT * FROM TEMP_FOR_DENO_CAM_TAR_5JUN25;--64  Rows\n\nUPDATE TEMP_FOR_DENO_CAM_TAR_5JUN25 SET DD_CODE = TRIM(DD_CODE), SLAB_1_TARGET = ROUND(SLAB_1_TARGET), SLAB_2_TARGET = ROUND(SLAB_2_TARGET), SLAB_3_TARGET = ROUND(SLAB_3_TARGET);\nCOMMIT;\n\n--DROP TABLE TEMP_FOR_AG_LST_MAP_5JUN25 PURGE;\nCREATE TABLE TEMP_FOR_AG_LST_MAP_5JUN25 AS\nSELECT TAR.*,AG.RET_CODE RETAILER_CODE, AG.RET_MOBILE RET_MSISDN \nFROM TEMP_FOR_DENO_CAM_TAR_5JUN25 TAR \nINNER JOIN DD_RSO_RET_MAPPING_DAILY AG ON AG.DD_CODE=TAR.DD_CODE AND AG.DATA_DATE = '5-JUN-25';--145806  Rows\n\nSELECT * FROM TEMP_FOR_AG_LST_MAP_5JUN25;-- 145806  Rows\n\nCREATE TABLE TEMP_FOR_EV_RECHARGE_5JUN25 AS\nSELECT * FROM EV_RECHARGE_COM_DAILY WHERE TOP_UP_DATE BETWEEN '1-JUN-25' AND '5-JUN-25';\n\n--DROP TABLE TEMP_FOR_DD_DN_DET_5JUN25 PURGE;\nCREATE TABLE TEMP_FOR_DD_DN_DET_5JUN25 AS\nWITH RSO_WISE_ACHIEVEMENT AS ( \n\n    SELECT /*+ parallel(10) */ CLUSTER_NAME, REGION,DD_CODE,SLAB_1_TARGET, SLAB_2_TARGET, SLAB_3_TARGET,SUM(RECHARGE_AMOUNT) TOTAL_RECHARGE\n    FROM (\n    SELECT /*+ parallel(10) */ CLUSTER_NAME, REGION,AG.DD_CODE,SLAB_1_TARGET, SLAB_2_TARGET, SLAB_3_TARGET,RECHARGE_AMOUNT\n    FROM TEMP_FOR_AG_LST_MAP_5JUN25 AG \n    INNER JOIN TEMP_FOR_EV_RECHARGE_5JUN25 EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '1-JUN-25' AND '5-JUN-25') AND EV.RECHARGE_AMOUNT IN (19,27,32,42,48,57,58,69,74,77,79,81,97,99,104,117,118,124,127,129,147,149,167,169,177,197,198,199,207,209,219,222,224,227,239,247,249,297,298,299,347,348,349,397,398,399,448,449,497,498,\n    499,548,549,629,648,649,719,729,748,797,848,849,897,899,997,998,1199,1258,1397,1899,1999)\n    AND REGION NOT IN ('Gazipur')\n  \n    \n    UNION ALL \n    \n    SELECT /*+ parallel(10) */ CLUSTER_NAME, REGION,AG.DD_CODE,SLAB_1_TARGET, SLAB_2_TARGET, SLAB_3_TARGET, RECHARGE_AMOUNT\n    FROM TEMP_FOR_AG_LST_MAP_5JUN25 AG \n    INNER JOIN TEMP_FOR_EV_RECHARGE_5JUN25 EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '2-JUN-25' AND '5-JUN-25') AND EV.RECHARGE_AMOUNT IN (19,27,32,42,48,57,58,69,74,77,79,81,97,99,104,117,118,124,127,129,147,149,167,169,177,197,198,199,207,209,219,222,224,227,239,247,249,297,298,299,347,348,349,397,398,399,448,449,497,498,\n    499,548,549,629,648,649,719,729,748,797,848,849,897,899,997,998,1199,1258,1397,1899,1999)\n    AND REGION IN ('Gazipur')\n    )\n    GROUP BY CLUSTER_NAME, REGION,DD_CODE, SLAB_1_TARGET, SLAB_2_TARGET, SLAB_3_TARGET\n    \n)\n--SELECT * FROM RSO_WISE_ACHIEVEMENT;--63  Rows\n,RET_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((TOTAL_RECHARGE/SLAB_1_TARGET)*100) SLAB_1_ACH_PER, ROUND((TOTAL_RECHARGE/SLAB_2_TARGET)*100) SLAB_2_ACH_PER, ROUND((TOTAL_RECHARGE/SLAB_3_TARGET)*100) SLAB_3_ACH_PER\nFROM RSO_WISE_ACHIEVEMENT ACHIEVEMENT\n)\n--SELECT * FROM RET_WISE_PERCENTAGE;--63  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD.*,\n    CASE\n        WHEN  SLAB_3_ACH_PER >= 100 THEN ROUND(TOTAL_RECHARGE*.009)\n        WHEN  SLAB_2_ACH_PER >= 100 THEN ROUND(TOTAL_RECHARGE*.008)\n        WHEN  SLAB_1_ACH_PER >= 100 THEN ROUND(TOTAL_RECHARGE*.007)\n        ELSE 0\n    END COMMISSION\n    FROM RET_WISE_PERCENTAGE DD\n)\nSELECT * FROM CALCULATE_COMMISSION;--322  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;--337595 TAKA\n\nSELECT * FROM TEMP_FOR_DD_DN_DET_5JUN25;--63  Rows\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_DN_DET_5JUN25;--418491           337595      360780  TK\n\n-------------DETAIL------------\n\n--DROP TABLE TEMP_FOR_DD_DN_DET2_5JUN25 PURGE;\nCREATE TABLE TEMP_FOR_DD_DN_DET2_5JUN25 AS\nWITH DD_WISE_ACHIEVEMENT AS ( \n\n    SELECT /*+ parallel(10) */ CLUSTER_NAME, REGION,AG.DD_CODE,SLAB_1_TARGET, SLAB_2_TARGET, SLAB_3_TARGET,RECHARGE_AMOUNT,TOP_UP_DATE,SUB_MSISDN CUSTOMER_MSISDN\n    FROM TEMP_FOR_AG_LST_MAP_5JUN25 AG \n    INNER JOIN TEMP_FOR_EV_RECHARGE_5JUN25 EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '1-JUN-25' AND '5-JUN-25') AND EV.RECHARGE_AMOUNT IN (19,27,32,42,48,57,58,69,74,77,79,81,97,99,104,117,118,124,127,129,147,149,167,169,177,197,198,199,207,209,219,222,224,227,239,247,249,297,298,299,347,348,349,397,398,399,448,449,497,498,\n    499,548,549,629,648,649,719,729,748,797,848,849,897,899,997,998,1199,1258,1397,1899,1999)\n    AND REGION NOT IN ('Gazipur')\n  \n    \n    UNION ALL \n    \n    SELECT /*+ parallel(10) */ CLUSTER_NAME, REGION,AG.DD_CODE,SLAB_1_TARGET, SLAB_2_TARGET, SLAB_3_TARGET, RECHARGE_AMOUNT,TOP_UP_DATE,SUB_MSISDN CUSTOMER_MSISDN\n    FROM TEMP_FOR_AG_LST_MAP_5JUN25 AG \n    INNER JOIN TEMP_FOR_EV_RECHARGE_5JUN25 EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '2-JUN-25' AND '5-JUN-25') AND EV.RECHARGE_AMOUNT IN (19,27,32,42,48,57,58,69,74,77,79,81,97,99,104,117,118,124,127,129,147,149,167,169,177,197,198,199,207,209,219,222,224,227,239,247,249,297,298,299,347,348,349,397,398,399,448,449,497,498,\n    499,548,549,629,648,649,719,729,748,797,848,849,897,899,997,998,1199,1258,1397,1899,1999)\n    AND REGION IN ('Gazipur')\n)\nSELECT * FROM DD_WISE_ACHIEVEMENT;--470907  Rows\n\nselect * from TEMP_FOR_DD_DN_DET2_5JUN25;--470907  Rows"}
{"srf": "# Commission Business Logics: Distributor Bundle Booster_1st to 8th May25\n\n**Commission Name:** Distributor Bundle Booster_1st to 8th May25  \n**Start Date:** 1-May-2025  \n**End Date:** 8-May-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges)  \n- **Target:** Distributor will be given Deno Recharge target (provided by B2C)  \n- **Mapping:** Agent list of 8th May'25 will be considered  \n- **Calculation Logics:**  \n    - Selected Deno will be considered for performance calculation (Deno List will be shared by B2C)  \n    - Campaign Date: Central Cluster (1st to 8th May’25)  \n    - Deno: ALL Deno (Deno List will be shared by B2C)  \n    - Upon achieving Deno Recharge target (Cumulative of DENO), Distributor will be given incentives as per below slab (Distributor wise Recharge Target will be shared by B2C)  \n    - Bonus incentive: If Cluster achieves 100% Recharge target, then ≥100% achiever DDs will get an additional 0.10% bonus incentive on total Recharge amount on top of their incentive slab  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation  \n    - Slab-based commission structure applies based on achievement percentage  \n\n- **Incentive Slab:**  \n    | Slab   | Incentive of Total Recharge Amount | Additional Incentives if Cluster achieves 100% |  \n    |--------|-----------------------------------|-----------------------------------------------|  \n    | Slab-1 | 0.7% of Total Recharge Amount      | 0.7% + 0.10%                                  |  \n    | Slab-2 | 0.8% of Total Recharge Amount      | 0.8% + 0.10%                                  |  \n    | Slab-3 | 0.9% of Total Recharge Amount      | 0.9% + 0.10%                                  |  \n\n- **Example:**  \n    - Example calculation and formula as per campaign document  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, Target ach, % Ach, Incentive Amount  \n- **Detail 2:** DD_CODE, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n", "sql": "-------------------------------HELPER QUERY------------------------------------\n--drop table TEMP_DD_1_8_MAY25_63897 purge;\n--CREATE TABLE TEMP_DD_1_8_MAY25_63897 AS\n--select CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET \n--WHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \n--where REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Bundle Booster Campaign_20th to 24th Mar25') and  \n--CYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Mar_25'));--1278  Rows\n\nSELECT * FROM TEMP_DD_1_8_MAY25_63897; -- 333  Rows\nSELECT * FROM DD_BOS_1ST_8TH_MAY25_63897; -- 333  Rows\n--CREATE TABLE TEMP_DD_1_8_MAY25_63897 AS\nSELECT CLUSTER_NAME,REGION,D_CODE DD_CODE,SLAB_1_TGT SLAB_1_TARGET,SLAB_2_TGT SLAB_2_TARGET,SLAB_3_TGT SLAB_3_TARGET FROM DD_BOS_1ST_8TH_MAY25_63897;\n\n\n--UPDATE TEMP_DD_1_8_MAY25_63897 SET DD_CODE = trim(DD_CODE), SLAB_1_TARGET = ROUND(SLAB_1_TARGET),SLAB_2_TARGET = ROUND(SLAB_2_TARGET),SLAB_3_TARGET = ROUND(SLAB_3_TARGET);\n--COMMIT;\n\nSELECT * FROM dd_rso_ret_mapping_daily;\n--DROP TABLE TEMP_FOR_AGLIST_MAP_8MAY25 PURGE;\n--CREATE TABLE TEMP_FOR_AGLIST_MAP_8MAY25 AS\nSELECT TAR.*,AG.RET_CODE, AG.RET_MOBILE \nFROM TEMP_DD_1_8_MAY25_63897 TAR \nINNER JOIN dd_rso_ret_mapping_daily AG ON AG.DD_CODE=TAR.DD_CODE AND AG.DATA_DATE = '8-MAY-25';--117982  Rows     \n\nSELECT * FROM TEMP_FOR_AGLIST_MAP_8MAY25;-- 555485  Rows\n\n--DROP TABLE TEMP_FOR_DD_DN_DET_1_8MAY25 PURGE; \n--CREATE TABLE TEMP_FOR_DD_DN_DET_1_8MAY25 AS\nWITH DD_WISE_ACHIEVEMENT AS ( \n    SELECT AG.CLUSTER_NAME,AG.REGION,AG.DD_CODE,AG.SLAB_1_TARGET,AG.SLAB_2_TARGET,AG.SLAB_3_TARGET,SUM(RECHARGE_AMOUNT) TOTAL_RECHARGE\n    FROM TEMP_FOR_AGLIST_MAP_8MAY25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MOBILE   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '1-MAY-25' AND '8-MAY-25') AND EV.RECHARGE_AMOUNT IN (\n    32,42,69,74,79,124,209,219,239,249,349,449,629,648,729,748,\n    848,1258,48,81,104,222,224,19,57,58,97,117,147,149,167,169,199,\n    297,347,348,399,448,497,499,649,849,998,27,77,99,118,127,129,\n    177,197,198,207,227,247,298,299,397,398,498,548,549,719,797,\n    897,899,997,1199,1397,1899,1999\n    )\n    GROUP BY AG.CLUSTER_NAME,AG.REGION,AG.DD_CODE, AG.SLAB_1_TARGET,AG.SLAB_2_TARGET,AG.SLAB_3_TARGET\n)\n--SELECT * FROM DD_WISE_ACHIEVEMENT;-- 331  Rows\n,DD_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,\nROUND((TOTAL_RECHARGE/SLAB_1_TARGET)*100) ACH_PER_1,\nROUND((TOTAL_RECHARGE/SLAB_2_TARGET)*100) ACH_PER_2,\nROUND((TOTAL_RECHARGE/SLAB_3_TARGET)*100) ACH_PER_3\nFROM DD_WISE_ACHIEVEMENT ACHIEVEMENT\n)\n--SELECT * FROM DD_WISE_PERCENTAGE;-- 331  Rows\n,CENTRAL_WISE_PERCENTAGE AS (\nSELECT CLUSTER_NAME, \nSUM(SLAB_1_TARGET) CLUSTER_TARGET_1,\nSUM(SLAB_2_TARGET) CLUSTER_TARGET_2, \nSUM(SLAB_3_TARGET) CLUSTER_TARGET_3, \nSUM(TOTAL_RECHARGE) CENTRAL_RECHARGE,\nROUND((SUM(TOTAL_RECHARGE)/SUM(SLAB_1_TARGET))*100) CLUSTER_ACH_PER_1,\nROUND((SUM(TOTAL_RECHARGE)/SUM(SLAB_2_TARGET))*100) CLUSTER_ACH_PER_2,\nROUND((SUM(TOTAL_RECHARGE)/SUM(SLAB_3_TARGET))*100) CLUSTER_ACH_PER_3\nFROM DD_WISE_ACHIEVEMENT ACHIEVEMENT\nGROUP BY CLUSTER_NAME\n)\n--SELECT * FROM CENTRAL_WISE_PERCENTAGE;-- 5  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,SLAB_3_TARGET,SLAB_2_TARGET, SLAB_1_TARGET, TOTAL_RECHARGE,ACH_PER_3,ACH_PER_2,ACH_PER_1,\n    CASE\n        WHEN  TOTAL_RECHARGE >= SLAB_3_TARGET AND CLUSTER_ACH_PER_1 >= 100 THEN ROUND((TOTAL_RECHARGE*.009)+(TOTAL_RECHARGE*.0010))\n        WHEN  TOTAL_RECHARGE >= SLAB_3_TARGET THEN ROUND(TOTAL_RECHARGE*.009)\n        WHEN  TOTAL_RECHARGE >= SLAB_2_TARGET AND CLUSTER_ACH_PER_2 >= 100 THEN ROUND((TOTAL_RECHARGE*.008)+(TOTAL_RECHARGE*.0010))\n        WHEN  TOTAL_RECHARGE >= SLAB_2_TARGET THEN ROUND(TOTAL_RECHARGE*.008)\n        WHEN  TOTAL_RECHARGE >= SLAB_1_TARGET AND CLUSTER_ACH_PER_3 >= 100 THEN ROUND((TOTAL_RECHARGE*.007)+(TOTAL_RECHARGE*.0010))\n        WHEN  TOTAL_RECHARGE >= SLAB_1_TARGET THEN ROUND(TOTAL_RECHARGE*.007)\n        ELSE 0\n    END COMMISSION\n    FROM DD_WISE_PERCENTAGE DD\n    LEFT JOIN CENTRAL_WISE_PERCENTAGE CC ON CC.CLUSTER_NAME = DD.CLUSTER_NAME  \n)\nSELECT * FROM CALCULATE_COMMISSION;-- 331  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;-- 1538508 TK\n\nSELECT * FROM TEMP_FOR_DD_DN_DET_1_8MAY25;-- 331  Rows\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_DN_DET_1_8MAY25;-- 1538508 TK\n\n--SELECT SYSDATE-3 FROM DUAL;\n\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Bundle Booster_Central Cluster_25th to 31st Jan25\n\n**Commission Name:** Distributor Bundle Booster_Central Cluster_25th to 31st Jan25  \n**Start Date:** 25-Jan-2025  \n**End Date:** 31-Jan-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges)\n- **Target:** Distributor will be given Deno Recharge target (provided by B2C)  \n- **Mapping:** Agent list of 31st Jan'25 will be considered  \n- **Calculation Logics:**  \n    - Selected Deno will be considered for performance calculation (Deno List will be shared by B2C)  \n    - Campaign Date: Central Cluster (25th to 31st Jan’25)  \n    - Deno: ALL Deno (Deno List will be shared by B2C)  \n    - Upon achieving Deno Recharge target (Cumulative of DENO), Distributor will be given incentives as per below slab (Distributor wise Recharge Target will be shared by B2C)  \n    - Bonus incentive: If the total Central Cluster achieves 100% Recharge target, each DD will get an additional 0.15% bonus incentive on the total Recharge amount on top of their incentive slab  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation  \n    - Slab-based commission structure applies based on achievement percentage  \n\n- **Incentive Slab:**  \n    | Achievement % | Incentive of Total Recharge Amount | Additional Incentives if Total Cluster achieves 100% |  \n    |---------------|-----------------------------------|----------------------------------------------------|  \n    | 100%-109%     | 0.8% of Total Recharge Amount      | 0.8% + 0.15%                                       |  \n    | ≥110%         | 1% of Total Recharge Amount        | 1% + 0.15%                                         |  \n\n- **Example:**  \n    - Example calculation and formula as per campaign document  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, Target ach, % Ach, Incentive Amount  \n- **Detail 2:** DD_CODE, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount\n```", "sql": "-------------------------------HELPER QUERY------------------------------------\n--drop table TEMP_FOR_DN_BB_CAM_TAR_31JAN25 purge;\n--CREATE TABLE TEMP_FOR_DN_BB_CAM_TAR_31JAN25 AS\n--select CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET \n--WHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \n--where REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Bundle Booster_Central Cluster_25th to 31sth Jan25') and  \n--CYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jan_25'));--1278  Rows\n\nSELECT * FROM TEMP_FOR_DN_BB_CAM_TAR_31JAN25;--53  Rows\n\nUPDATE TEMP_FOR_DN_BB_CAM_TAR_31JAN25 SET DD_CODE = TRIM(DD_CODE), TARGET = ROUND(TARGET);\nCOMMIT;\n\n--DROP TABLE TEMP_FOR_AGLIST_MAP_31JAN25 PURGE;\nCREATE TABLE TEMP_FOR_AGLIST_MAP_31JAN25 AS\nSELECT TAR.*,AG.RETAILER_CODE, AG.TOPUP_MSISDN RET_MSISDN \nFROM TEMP_FOR_DN_BB_CAM_TAR_31JAN25 TAR \nINNER JOIN AGENT_LIST_DAILY AG ON AG.DIST_CODE=TAR.DD_CODE AND AG.DATA_DATE = '31-JAN-25';--117982  Rows     \n\nSELECT * FROM TEMP_FOR_AGLIST_MAP_31JAN25;--118169  Rows\n\n--DROP TABLE TEMP_FOR_DD_DN_DET1_31JAN25 PURGE;\nCREATE TABLE TEMP_FOR_DD_DN_DET1_31JAN25 AS\nWITH DD_WISE_ACHIEVEMENT AS ( \n    SELECT AG.CLUSTER_TYPE,AG.DD_CODE,AG.TARGET,SUM(RECHARGE_AMOUNT) TOTAL_RECHARGE\n    FROM TEMP_FOR_AGLIST_MAP_31JAN25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '25-JAN-25' AND '31-JAN-25') AND EV.RECHARGE_AMOUNT IN (28,38,49,58,69,79,89,96,99,108,118,129,149,169,199,209,229,249,279,299,399,499,549,599,649,699,799,859,899,42,48,78,81,98,104,148,198,222,224,248,298,348\n,398,448,498,548,648,698,798,998,19,27,33,34,47,57,64,77,97,117,127,147,157,167,177,197,207,227,247,297,337,397,447,497,597,897,1397)\n    GROUP BY AG.CLUSTER_TYPE,AG.DD_CODE,  AG.TARGET\n)\n--SELECT * FROM DD_WISE_ACHIEVEMENT;--53  Rows\n,DD_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((TOTAL_RECHARGE/TARGET)*100) ACH_PER\nFROM DD_WISE_ACHIEVEMENT ACHIEVEMENT\n)\n--SELECT * FROM DD_WISE_PERCENTAGE;--53  Rows\n,CENTRAL_WISE_PERCENTAGE AS (\nSELECT CLUSTER_TYPE, SUM(TARGET) CENTRAL_TARGET, SUM(TOTAL_RECHARGE) CENTRAL_RECHARGE,ROUND((SUM(TOTAL_RECHARGE)/SUM(TARGET))*100) CLUSTER_ACH_PER\nFROM DD_WISE_ACHIEVEMENT ACHIEVEMENT\nGROUP BY CLUSTER_TYPE\n)\n--SELECT * FROM CENTRAL_WISE_PERCENTAGE;--358  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,  TARGET, TOTAL_RECHARGE,ACH_PER,CLUSTER_ACH_PER,\n    CASE\n        WHEN  ACH_PER >= 110 AND CLUSTER_ACH_PER >= 100 THEN ROUND((TOTAL_RECHARGE*.01)+(TOTAL_RECHARGE*.0015))\n        WHEN  ACH_PER >= 110 THEN ROUND(TOTAL_RECHARGE*.01)\n        WHEN  ACH_PER >= 100 AND CLUSTER_ACH_PER >= 100 THEN ROUND((TOTAL_RECHARGE*.008)+(TOTAL_RECHARGE*.0015))\n        WHEN  ACH_PER >= 100 THEN ROUND(TOTAL_RECHARGE*.008)\n        ELSE 0\n    END COMMISSION\n    FROM DD_WISE_PERCENTAGE DD\n    LEFT JOIN CENTRAL_WISE_PERCENTAGE CC ON CC.CLUSTER_TYPE = DD.CLUSTER_TYPE\n    \n)\nSELECT * FROM CALCULATE_COMMISSION;--53  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;--353146           353146 TK\n\nSELECT * FROM TEMP_FOR_DD_DN_DET1_31JAN25;--53  Rows\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_DN_DET1_31JAN25;--353146 TK\n\n--SELECT SYSDATE-3 FROM DUAL;\n\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Bundle Booster_Central Cluster_8th to 14th Jan25\n\n**Commission Name:** Distributor Bundle Booster_Central Cluster_8th to 14th Jan25  \n**Start Date:** 8-Jan-2025  \n**End Date:** 14-Jan-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges) \n- **Target:** Distributor will be given Deno Recharge target (provided by B2C)  \n- **Mapping:** Agent list of 14th Jan'25 will be considered  \n- **Calculation Logics:**  \n    - Selected Deno will be considered for performance calculation (Deno List will be shared by B2C)  \n    - Campaign Date: Central Cluster (8th to 14th Jan’25)  \n    - Deno: ALL Deno (Deno List will be shared by B2C)  \n    - Upon achieving Deno Recharge target (Cumulative of DENO), Distributor will be given incentives as per below slab (Distributor wise Recharge Target will be shared by B2C)  \n    - Bonus incentive: If the total Central Cluster achieves 100% Recharge target, each DD will get an additional 0.15% bonus incentive on the total Recharge amount on top of their incentive slab  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation  \n    - Slab-based commission structure applies based on achievement percentage  \n\n- **Incentive Slab:**  \n    | Achievement % | Incentive of Total Recharge Amount | Additional Incentives if Total Cluster achieves 100% |  \n    |---------------|-----------------------------------|----------------------------------------------------|  \n    | 100%-109%     | 0.8% of Total Recharge Amount      | 0.8% + 0.15%                                       |  \n    | ≥110%         | 1% of Total Recharge Amount        | 1% + 0.15%                                         |  \n\n- **Example:**  \n    - Example calculation and formula as per campaign document  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, Target ach, % Ach, Incentive Amount  \n- **Detail 2:** DD_CODE, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount\n```", "sql": "-------------------------------HELPER QUERY------------------------------------\n--CREATE TABLE TEMP_FOR_DN_BB_CAM_TAR_15JAN25 AS\n--select CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET \n--WHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \n--where REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Bundle Booster_Central Cluster_8th to 14th Jan25') and  \n--CYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jan_25'));--1278  Rows\n\nSELECT * FROM TEMP_FOR_DN_BB_CAM_TAR_15JAN25;--53  Rows\n\nUPDATE TEMP_FOR_DN_BB_CAM_TAR_15JAN25 SET DD_CODE = TRIM(DD_CODE), TARGET = ROUND(TARGET);\nCOMMIT;\n\n--DROP TABLE TEMP_FOR_AGLIST_MAP_14JAN25 PURGE;\nCREATE TABLE TEMP_FOR_AGLIST_MAP_14JAN25 AS\nSELECT TAR.*,AG.RETAILER_CODE, AG.TOPUP_MSISDN RET_MSISDN \nFROM TEMP_FOR_DN_BB_CAM_TAR_15JAN25 TAR \nINNER JOIN AGENT_LIST_DAILY AG ON AG.DIST_CODE=TAR.DD_CODE AND AG.DATA_DATE = '14-JAN-25';--117982  Rows     \n\nSELECT * FROM TEMP_FOR_AGLIST_MAP_14JAN25;--563756  Rows\n\n--DROP TABLE TEMP_FOR_DD_DN_DET1_14JAN25 PURGE;\nCREATE TABLE TEMP_FOR_DD_DN_DET1_14JAN25 AS\nWITH DD_WISE_ACHIEVEMENT AS ( \n    SELECT AG.CLUSTER_TYPE,AG.DD_CODE,AG.TARGET,SUM(RECHARGE_AMOUNT) TOTAL_RECHARGE\n    FROM TEMP_FOR_AGLIST_MAP_14JAN25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '8-JAN-25' AND '14-JAN-25') AND EV.RECHARGE_AMOUNT IN (19,27,28,33,34,38,42,47,48,49,57,58,64,69,77,78,79,81,89,96,97,98,99,104,108,117,118,127,129,147,148,149,157,167,169\n,177,197,198,199,207,209,222,224,227,229,247,248,249,279,297,298,299,337,348,397,398,399,447,448,497,498,499,548,549\n,597,599,648,649,698,699,798,799,859,897,899,998,1397)\n    GROUP BY AG.CLUSTER_TYPE,AG.DD_CODE,  AG.TARGET\n)\n--SELECT * FROM DD_WISE_ACHIEVEMENT;--53  Rows\n,DD_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((TOTAL_RECHARGE/TARGET)*100) ACH_PER\nFROM DD_WISE_ACHIEVEMENT ACHIEVEMENT\n)\n--SELECT * FROM DD_WISE_PERCENTAGE;--53  Rows\n,CENTRAL_WISE_PERCENTAGE AS (\nSELECT CLUSTER_TYPE, SUM(TARGET) CENTRAL_TARGET, SUM(TOTAL_RECHARGE) CENTRAL_RECHARGE,ROUND((SUM(TOTAL_RECHARGE)/SUM(TARGET))*100) CLUSTER_ACH_PER\nFROM DD_WISE_ACHIEVEMENT ACHIEVEMENT\nGROUP BY CLUSTER_TYPE\n)\n--SELECT * FROM CENTRAL_WISE_PERCENTAGE;--358  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,  TARGET, TOTAL_RECHARGE,ACH_PER,CLUSTER_ACH_PER,\n    CASE\n        WHEN  ACH_PER >= 110 AND CLUSTER_ACH_PER >= 100 THEN ROUND((TOTAL_RECHARGE*.01)+(TOTAL_RECHARGE*.0015))\n        WHEN  ACH_PER >= 110 THEN ROUND(TOTAL_RECHARGE*.01)\n        WHEN  ACH_PER >= 100 AND CLUSTER_ACH_PER >= 100 THEN ROUND((TOTAL_RECHARGE*.008)+(TOTAL_RECHARGE*.0015))\n        WHEN  ACH_PER >= 100 THEN ROUND(TOTAL_RECHARGE*.008)\n        ELSE 0\n    END COMMISSION\n    FROM DD_WISE_PERCENTAGE DD\n    LEFT JOIN CENTRAL_WISE_PERCENTAGE CC ON CC.CLUSTER_TYPE = DD.CLUSTER_TYPE\n    \n)\nSELECT * FROM CALCULATE_COMMISSION;--53  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;--523360            523358.276 TK\n\nSELECT * FROM TEMP_FOR_DD_DN_DET1_14JAN25;--53  Rows\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_DN_DET1_14JAN25;--523360 TK\n\n--SELECT SYSDATE-3 FROM DUAL;\n\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Bundle Booster_GAZ_TAN_11th to 20th Jan25\n\n**Commission Name:** Distributor Bundle Booster_GAZ_TAN_11th to 20th Jan25  \n**Start Date:** 11-Jan-2025  \n**End Date:** 20-Jan-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges)\n- **Target:** Distributor will be given Deno Recharge target (provided by B2C)  \n- **Mapping:** Agent list of 20th Jan'25 will be considered  \n- **Calculation Logics:**  \n    - Selected Deno will be considered for performance calculation (Deno List will be shared by B2C)  \n    - Campaign Date: GAZ_TAN Cluster (11th to 20th Jan’25)  \n    - Deno: ALL Deno (Deno List will be shared by B2C)  \n    - Upon achieving Deno Recharge target (Cumulative of DENO), Distributor will be given 0.8% incentives on Recharge amount till 100% achievement (Distributor wise Recharge Target and Incentives amount will be shared by B2C)  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation  \n\n- **Incentive Slab:**  \n    | Achievement % | Incentive of Total Recharge Amount |  \n    |---------------|-----------------------------------|  \n    | 100%          | 0.8% of Total Recharge Amount      |  \n\n- **Example:**  \n    - Example calculation and formula as per campaign document  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, Target ach, % Ach, Incentive Amount  \n- **Detail 2:** DD_CODE, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount\n```", "sql": "-------------------------------HELPER QUERY------------------------------------\n--CREATE TABLE TEMP_FOR_DENO_CAMP_TAR_20JAN25 AS\n--select CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET \n--WHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \n--where REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Bundle Booster_GAZ_TAN_11th to 20th Jan25') and  \n--CYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jan_25'));--1278  Rows\n\nSELECT * FROM TEMP_FOR_DENO_CAMP_TAR_20JAN25;--362  Rows\n\nUPDATE TEMP_FOR_DENO_CAMP_TAR_20JAN25 SET DD_CODE = TRIM(DD_CODE),TARGET = round(TARGET), INCENTIVE = round(INCENTIVE);\nCOMMIT;\n\n--DROP TABLE TEMP_FOR_AGLIST_MAP_20JAN25 PURGE;\nCREATE TABLE TEMP_FOR_AGLIST_MAP_20JAN25 AS\nSELECT TAR.*,AG.RETAILER_CODE, AG.TOPUP_MSISDN RET_MSISDN \nFROM TEMP_FOR_DENO_CAMP_TAR_20JAN25 TAR \nINNER JOIN AGENT_LIST_DAILY AG ON AG.DIST_CODE=TAR.DD_CODE AND AG.DATA_DATE = '20-JAN-25';--563642  Rows\n\nSELECT * FROM TEMP_FOR_AGLIST_MAP_20JAN25;--63631  Rows\n\n--DROP TABLE TEMP_FOR_DD_DN_DET1_20JAN25 PURGE;\n--CREATE TABLE TEMP_FOR_DD_DN_DET1_20JAN25 AS\nWITH DD_WISE_ACHIEVEMENT AS ( \n    SELECT AG.DD_CODE,AG.TARGET,SUM(RECHARGE_AMOUNT) TOTAL_RECHARGE,INCENTIVE\n    FROM TEMP_FOR_AGLIST_MAP_20JAN25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '11-JAN-25' AND '20-JAN-25') AND EV.RECHARGE_AMOUNT IN (19,27,28,33,34,38,42,47,48,49,57,58,64,69,77,78,79,81,89,96,97,98,99,104,108,117,118,127,129,147,148,149,157,167,169,177,197,198,199,207,209,222,224,227,229,247,248,249,279\n,297,298,299,337,348,397,398,399,447,448,497,498,499,548,549,597,599,648,649,698,699,798,799,859,897,899,998,1397)\n    GROUP BY AG.DD_CODE,  AG.TARGET,INCENTIVE\n)\n--SELECT * FROM DD_WISE_ACHIEVEMENT;--35  Rows\n,DD_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((TOTAL_RECHARGE/TARGET)*100) ACH_PER\nFROM DD_WISE_ACHIEVEMENT ACHIEVEMENT\n)\n--SELECT * FROM DD_WISE_PERCENTAGE;--357  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,  TARGET, TOTAL_RECHARGE,ACH_PER,\n    CASE\n        WHEN  ACH_PER >= 100 THEN INCENTIVE\n        ELSE 0\n    END COMMISSION\n    FROM DD_WISE_PERCENTAGE \n)\n--SELECT * FROM CALCULATE_COMMISSION;--35  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;--284993 TK\n\nSELECT * FROM TEMP_FOR_DD_DN_DET1_20JAN25;--35  Rows\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_DN_DET1_20JAN25;--284993 TK\n\n--SELECT SYSDATE-3 FROM DUAL;\n\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Bundle Booster_MYM_20th to 31st Jan25\n\n**Commission Name:** Distributor Bundle Booster_MYM_20th to 31st Jan25  \n**Start Date:** 20-Jan-2025  \n**End Date:** 31-Jan-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges) \n- **Target:** Distributor will be given Deno Recharge target (provided by B2C)  \n- **Mapping:** Agent list of 31st Jan'25 will be considered  \n- **Calculation Logics:**  \n    - Selected Deno will be considered for performance calculation (Deno List will be shared by B2C)  \n    - Campaign Date: MYM Cluster (20th to 31st Jan’25)  \n    - Deno: ALL Deno (Deno List will be shared by B2C)  \n    - Upon achieving Deno Recharge target (Cumulative of DENO), Distributor will be given 0.8% incentives on Recharge amount till 100% achievement (Distributor wise Recharge Target and Incentives amount will be shared by B2C)  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation  \n\n- **Incentive Slab:**  \n    | Achievement % | Incentive of Total Recharge Amount |  \n    |---------------|-----------------------------------|  \n    | 100%          | 0.8% of Total Recharge Amount      |  \n\n- **Example:**  \n    - Example calculation and formula as per campaign document  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, Target ach, % Ach, Incentive Amount  \n- **Detail 2:** DD_CODE, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount\n```", "sql": "-------------------------------HELPER QUERY------------------------------------\n--CREATE TABLE TEMP_FOR_DENO_CAMP_TAR_31JAN25 AS\n--select CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET \n--WHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \n--where REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Bundle Booster_MYM_20th to 31st Jan25') and  \n--CYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jan_25'));--1278  Rows\n\nSELECT * FROM TEMP_FOR_DENO_CAMP_TAR_31JAN25;--362  Rows\n\nUPDATE TEMP_FOR_DENO_CAMP_TAR_31JAN25 SET DD_CODE = TRIM(DD_CODE),TARGET = round(TARGET), INCENTIVE = round(INCENTIVE);\nCOMMIT;\n\n--DROP TABLE TEMP_FOR_AG_MAP_31JAN25 PURGE;\nCREATE TABLE TEMP_FOR_AG_MAP_31JAN25 AS\nSELECT TAR.*,AG.RETAILER_CODE, AG.TOPUP_MSISDN RET_MSISDN \nFROM TEMP_FOR_DENO_CAMP_TAR_31JAN25 TAR \nINNER JOIN AGENT_LIST_DAILY AG ON AG.DIST_CODE=TAR.DD_CODE AND AG.DATA_DATE = '31-JAN-25';--563642  Rows\n\nSELECT * FROM TEMP_FOR_AG_MAP_31JAN25;--35016  Rows\n\n--DROP TABLE TEMP_FOR_DD_MYM_DET1_31JAN25 PURGE;\nCREATE TABLE TEMP_FOR_DD_MYM_DET1_31JAN25 AS\nWITH DD_WISE_ACHIEVEMENT AS ( \n    SELECT AG.DD_CODE,AG.TARGET,SUM(RECHARGE_AMOUNT) TOTAL_RECHARGE,INCENTIVE\n    FROM TEMP_FOR_AG_MAP_31JAN25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '20-JAN-25' AND '31-JAN-25') AND EV.RECHARGE_AMOUNT IN (28,38,49,58,69,79,89,96,99,108,118,129,149,169,199,209,229,249,279,299,399,499,549,599,649,699,799,859,899,42,48,78,81,98,104,148,198,222,224,248,298,348,398,448,498,548,\n648,698,798,998,19,27,33,34,47,57,64,77,97,117,127,147,157,167,177,197,207,227,247,297,337,397,447,497,597,897,1397)\n    GROUP BY AG.DD_CODE,  AG.TARGET,INCENTIVE\n)\n--SELECT * FROM DD_WISE_ACHIEVEMENT;--35  Rows\n,DD_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((TOTAL_RECHARGE/TARGET)*100) ACH_PER\nFROM DD_WISE_ACHIEVEMENT ACHIEVEMENT\n)\n--SELECT * FROM DD_WISE_PERCENTAGE;--357  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,  TARGET, TOTAL_RECHARGE,ACH_PER,\n    CASE\n        WHEN  ACH_PER >= 100 THEN INCENTIVE\n        ELSE 0\n    END COMMISSION\n    FROM DD_WISE_PERCENTAGE \n)\nSELECT * FROM CALCULATE_COMMISSION;--29  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;--228026 TK\n\nSELECT * FROM TEMP_FOR_DD_MYM_DET1_31JAN25;--29  Rows\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_MYM_DET1_31JAN25;--228026 TK\n\n--SELECT SYSDATE-3 FROM DUAL;\n\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Bundle Campaign_Central Cluster_22nd to 31st Jan25\n\n**Commission Name:** Distributor Bundle Campaign_Central Cluster_22nd to 31st Jan25  \n**Start Date:** 22-Jan-2025  \n**End Date:** 31-Jan-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges) \n- **Target:** Distributor will be given Deno Recharge target (provided by B2C)  \n- **Mapping:** Agent list of 31st Jan'25 will be considered  \n- **Calculation Logics:**  \n    - Selected Deno will be considered for performance calculation (Deno List: 199, 227, 397, 448, 549)  \n    - Campaign Date: Central Cluster (22nd to 31st Jan’25)  \n    - Upon achieving Deno Recharge target (Cumulative of DENO), Distributor will be given incentives as per the following slab:  \n        - **100K~200K volume DD:** 10K incentives  \n        - **200K~400K volume DD:** 20K incentives  \n        - **400K & above volume DD:** 30K incentives  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation  \n\n**Incentive Slab:**  \n| Volume DD Range | Incentive Amount |  \n|------------------|------------------|  \n| 100K~200K        | 10K              |  \n| 200K~400K        | 20K              |  \n| 400K & above     | 30K              |  \n\n**Example:**  \n- Example calculation and formula as per campaign document  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, Target ach, % Ach, Incentive Amount  \n- **Detail 2:** DD_CODE, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n```", "sql": "-------------------------------HELPER QUERY------------------------------------\n-- 7429 9574 61554\nSELECT * FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Bundle Campaign_Central Cluster_22nd to 31st Jan25';\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jan_25'; --base month\nSELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS where REPORTID = 7429 and  CYCLEID = 9574;--61554\n\n-- *** Create TEMP TARGET Table *** \n--CREATE TABLE TEMP_FOR_DENO_CAMP_TAR_22_31_JAN25 AS\nSELECT CHANNEL_CODE DD_CODE, TARGET FROM COM_KPI_CONDITION_TARGET where REPORTCYCLE_ID = 61554;\n\n--drop table TEMP_FOR_DENO_CAMP_TAR_22_31_JAN25 purge;\nSELECT * FROM TEMP_FOR_DENO_CAMP_TAR_22_31_JAN25;--53  Rows\n--update TEMP_FOR_DENO_CAMP_TAR_22_31_JAN25 set DD_CODE = trim(DD_CODE),target=round(target);\n--commit;\nSELECT * FROM DD_RSO_RET_MAPPING_DAILY;\nSELECT * FROM EV_RECHARGE_COM_DAILY;\n\n--DROP TABLE TEMP_FOR_AG_LIST_MAP_22_31_JAN25 PURGE;\nCREATE TABLE TEMP_FOR_AG_LIST_MAP_22_31_JAN25 AS\nSELECT TAR.*,AG.RET_CODE RETAILER_CODE, AG.RET_MOBILE RET_MSISDN FROM \nTEMP_FOR_DENO_CAMP_TAR_22_31_JAN25 TAR \nINNER JOIN DD_RSO_RET_MAPPING_DAILY AG ON AG.DD_CODE=TAR.DD_CODE AND AG.DATA_DATE = '31-JAN-25';--118169  Rows\n\nSELECT * FROM TEMP_FOR_AG_LIST_MAP_22_31_JAN25;-- 118169  Rows\n\n--DROP TABLE TEMP_FOR_DD_DENO_DAT_22_31JAN25 PURGE;\n--CREATE TABLE TEMP_FOR_DD_DENO_DAT_22_31JAN25 AS\nWITH DD_WISE_ACHIEVEMENT AS ( \n    SELECT AG.DD_CODE,AG.TARGET,SUM(RECHARGE_AMOUNT) ACH\n    FROM TEMP_FOR_AG_LIST_MAP_22_31_JAN25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '22-JAN-25' AND '31-JAN-25') \n    AND EV.RECHARGE_AMOUNT IN (199,227,397,448,549)\n    GROUP BY AG.DD_CODE,  AG.TARGET\n)\n--SELECT * FROM DD_WISE_ACHIEVEMENT; --57  Rows\n--,DD_WISE_PERCENTAGE AS (\n--SELECT ACHIEVEMENT.*,ROUND((ACH/TARGET)*100) ACH_PER\n--FROM DD_WISE_ACHIEVEMENT ACHIEVEMENT\n--)\n--SELECT * FROM DD_WISE_PERCENTAGE;--119 Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,  TARGET, ACH,\n    CASE \n    WHEN  ACH >= 400000 THEN 30000\n    WHEN  ACH >= 200000 THEN 20000\n    WHEN  ACH >= 100000 THEN 10000\n    ELSE 0 END COMMISSION\n    FROM DD_WISE_ACHIEVEMENT \n)\nSELECT * FROM CALCULATE_COMMISSION;--53 Rows\nSELECT SUM(COMMISSION) FROM CALCULATE_COMMISSION;--1010000 TAKA\nSELECT * FROM TEMP_FOR_DD_DENO_DAT_22_31JAN25;--53  Rows\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_DENO_DAT_22_31JAN25;--1010000 TK\n-------detail---------\n\nselect * from EV_RECHARGE_COM_DAILY;\nSELECT * FROM TEMP_FOR_AG_LIST_MAP_22_31_JAN25;\n\nCREATE TABLE TEMP_FOR_DD_DENO_DAT2_22_31JAN25 AS\nWITH DD_WISE_ACHIEVEMENT AS ( \n    SELECT AG.DD_CODE,RETAILER_MSISDN,SUB_MSISDN CUSTOMER_MSISDN,AG.TARGET,RECHARGE_AMOUNT\n    FROM TEMP_FOR_AG_LIST_MAP_22_31_JAN25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '22-JAN-25' AND '31-JAN-25') AND EV.RECHARGE_AMOUNT IN (199,227,397,448,549)\n--    GROUP BY AG.DD_CODE,  AG.TARGET\n)\nSELECT * FROM DD_WISE_ACHIEVEMENT;\n\nSELECT * FROM TEMP_FOR_DD_DENO_DAT2_22_31JAN25; --50172  Rows\n\n\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Bundle Campaign_GAZ_TAN_SYL_23rd to 31st Jan25\n\n**Commission Name:** Distributor Bundle Campaign_GAZ_TAN_SYL_23rd to 31st Jan25  \n**Start Date:** 23-Jan-2025  \n**End Date:** 31-Jan-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges)\n- **Target:** Distributor will be given Deno Recharge target (provided by B2C)  \n- **Mapping:** Agent list of 31st Jan'25 will be considered  \n- **Calculation Logics:**  \n    - Selected Deno will be considered for performance calculation (Deno List will be shared by B2C)  \n    - Campaign Date: GAZ_TAN_SYL (23rd to 31st Jan’25)  \n    - Upon achieving Deno Recharge target (Cumulative of DENO), Distributor will be given 0.8% incentives on total recharge amount (Distributor-wise recharge target will be shared by B2C).  \n    - Incentive is capped up to 120%.  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation  \n\n**Incentive Slab:**  \n| Achievement % | Incentive % |  \n|---------------|-------------|  \n| Up to 120%    | 0.8%        |  \n\n**Example:**  \n- Example calculation and formula as per campaign document  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, Target ach, % Ach, Incentive Amount  \n- **Detail 2:** DD_CODE, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n```", "sql": "-------------------------------HELPER QUERY------------------------------------\nCREATE TABLE TEMP_FOR_DENO_GTS_TAR_31JAN25 AS\nselect CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET \nWHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \nwhere REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Bundle Campaign_GAZ_TAN_SYL_23rd to 31st Jan25') and  \nCYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jan_25'));--49  Rows\n\nSELECT * FROM TEMP_FOR_DENO_GTS_TAR_31JAN25;--49  Rows\n\n--UPDATE TEMP_FOR_DENO_GTS_TAR_31JAN25 SET DD_CODE = TRIM(DD_CODE),TARGET = round(TARGET), INCENTIVE = round(INCENTIVE);\n--COMMIT;\n\n--DROP TABLE TEMP_FOR_AG_GTS_MAP_31JAN25 PURGE;\nCREATE TABLE TEMP_FOR_AG_GTS_MAP_31JAN25 AS\nSELECT TAR.*,AG.RETAILER_CODE, AG.TOPUP_MSISDN RET_MSISDN \nFROM TEMP_FOR_DENO_GTS_TAR_31JAN25 TAR \nINNER JOIN AGENT_LIST_DAILY AG ON AG.DIST_CODE=TAR.DD_CODE AND AG.DATA_DATE = '31-JAN-25';--86632  Rows\n\nSELECT * FROM TEMP_FOR_AG_GTS_MAP_31JAN25;--86632  Rows\n\n--DROP TABLE TEMP_FOR_DD_GTS_DET1_31JAN25 PURGE;\nCREATE TABLE TEMP_FOR_DD_GTS_DET1_31JAN25 AS\nWITH DD_WISE_ACHIEVEMENT AS ( \n    SELECT AG.DD_CODE,AG.TARGET,SUM(RECHARGE_AMOUNT) TOTAL_RECHARGE,ROUND(TARGET*1.20) MAX_CAP\n    FROM TEMP_FOR_AG_GTS_MAP_31JAN25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '23-JAN-25' AND '31-JAN-25') AND EV.RECHARGE_AMOUNT IN (28,38,49,58,69,79,89,96,99,108,118,129,149,169,199,209,229,249,279,299,399,499,549,599,649,699,799,859,899,42,48,78,81,98,104,148,198,222,224,248,298,348,398,448,498,548,\n648,698,798,998,19,27,33,34,47,57,64,77,97,117,127,147,157,167,177,197,207,227,247,297,337,397,447,497,597,897,1397)\n    GROUP BY AG.DD_CODE,  AG.TARGET\n)\n--SELECT * FROM DD_WISE_ACHIEVEMENT;--35  Rows\n,DD_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((TOTAL_RECHARGE/TARGET)*100) ACH_PER\nFROM DD_WISE_ACHIEVEMENT ACHIEVEMENT\n)\n--SELECT * FROM DD_WISE_PERCENTAGE;--357  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,  TARGET, TOTAL_RECHARGE,ACH_PER,\n    CASE\n        WHEN  ACH_PER >= 120 THEN ROUND(MAX_CAP * .008)\n        WHEN  ACH_PER >= 100 THEN ROUND(TOTAL_RECHARGE * .008)\n        ELSE 0\n    END COMMISSION\n    FROM DD_WISE_PERCENTAGE \n)\nSELECT * FROM CALCULATE_COMMISSION;--49  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;--311939 TK\n\nSELECT * FROM TEMP_FOR_DD_GTS_DET1_31JAN25;--49  Rows\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_GTS_DET1_31JAN25;--311939 TK\n\n\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Deno Booster Campaign_1st to 9th Mar25\n\n**Commission Name:** Distributor Deno Booster Campaign_1st to 9th Mar25  \n**Start Date:** 1-Mar-2025  \n**End Date:** 9-Mar-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges) \n- **Target:** Distributor will be given Deno HIT target (provided by B2C)  \n- **Mapping:** Agent list of 9th Mar'25 will be considered  \n- **Calculation Logics:**  \n    - Selected Deno will be considered for performance calculation (Deno List: 397, 548, 549)  \n    - Upon achieving Deno HIT target (Cumulative of DENO), Distributor will be given BDT 50 incentives per HIT (Distributor-wise HIT target will be shared by B2C).  \n    - Upon achieving 90% to 99% Deno HIT target (Cumulative of DENO), Distributor will be given BDT 40 incentives per HIT.  \n    - Incentive is capped up to 200% achievement.  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation  \n\n**Additional Incentives:**  \n- If Distributor achieves 100% of the target from 1st to 9th Mar’25:  \n    - **Celebration Budget:** BDT 150 per RSO (No celebration budget for West Cluster).  \n    - **Extra Incentive (7th to 9th Mar’25):**  \n        - North East, Central, East, North Clusters: BDT 10 per Deno HIT (uncapped).  \n        - West Cluster: BDT 20 per Deno HIT (uncapped).  \n\n**Example:**  \n- Example calculation for North East, Central, East, North Clusters:  \n    - If DD achieves 500 Deno hits between 7th to 9th Mar’25, DD will receive: 500 × BDT 10 = BDT 5,000  \n- Example calculation for West Cluster:  \n    - If DD achieves 500 Deno hits between 7th to 9th Mar’25, DD will receive: 500 × BDT 20 = BDT 10,000  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, HIT Target ach, % Ach, Incentive Amount  \n- **Detail 2:** DD_CODE, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n```", "sql": "-------------------------------HELPER QUERY------------------------------------\n-- 7451 9574 61612\n\n--create table TEMP_FOR_DENO_TAR_9_MAR25 as\n--select CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET \n--WHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \n--where REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Deno_North East Cluster_BDT_399_448_548_498_549_10th to 15th Feb25') and  \n--CYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Feb_25'));--355  Rows\n\nSELECT DISTINCT CLUSTER_NAME FROM TEMP_FOR_DENO_TAR_9_MAR25;--342  Rows\n\n--DROP TABLE TEMP_FOR_AG_MAP_09_MAR25 PURGE;\nCREATE TABLE TEMP_FOR_AG_MAP_09_MAR25 AS\nSELECT TAR.*,AG.RET_CODE RETAILER_CODE, AG.RET_MOBILE RET_MSISDN \nFROM TEMP_FOR_DENO_TAR_9_MAR25 TAR \nINNER JOIN DD_RSO_RET_MAPPING_DAILY AG ON AG.DD_CODE=TAR.DD_CODE AND AG.DATA_DATE = '09-MAR-25';--118276  Rows \n\nSELECT * FROM TEMP_FOR_AG_MAP_09_MAR25;-- 561279  Rows\nSELECT * FROM EV_RECHARGE_COM_DAILY;\n\n--DROP TABLE TEMP_FOR_DD_DN_DET_09MAR25 PURGE;\nCREATE TABLE TEMP_FOR_DD_DN_DET_09MAR25 AS\nWITH RSO_WISE_ACHIEVEMENT AS ( \n    SELECT CLUSTER_NAME,AG.DD_CODE,AG.TARGET,COUNT(RECHARGE_AMOUNT) HIT,RSO_COUNT, CELEBRATION_BUDGET\n    FROM TEMP_FOR_AG_MAP_09_MAR25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '1-MAR-25' AND '09-MAR-25') AND EV.RECHARGE_AMOUNT IN (397,548,549)\n    GROUP BY AG.DD_CODE,  AG.TARGET,RSO_COUNT, CELEBRATION_BUDGET,CLUSTER_NAME\n)\n--SELECT * FROM RSO_WISE_ACHIEVEMENT;--335  Rows,\n,DD_DATE_WISE_ACH AS(\nSELECT AG.DD_CODE,COUNT(RECHARGE_AMOUNT) HIT\n    FROM TEMP_FOR_AG_MAP_09_MAR25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '7-MAR-25' AND '09-MAR-25') AND EV.RECHARGE_AMOUNT IN (397,548,549)\n    GROUP BY AG.DD_CODE,  AG.TARGET,RSO_COUNT, CELEBRATION_BUDGET,CLUSTER_NAME\n)\n--SELECT * FROM DD_DATE_WISE_ACH;\n,RET_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((HIT/TARGET)*100) ACH_PER\nFROM RSO_WISE_ACHIEVEMENT ACHIEVEMENT\n)\n--SELECT * FROM RET_WISE_PERCENTAGE;--52  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT ACH.CLUSTER_NAME,ACH.DD_CODE,  ACH.TARGET, ACH.HIT,ACH_PER, ACH.RSO_COUNT, ACH.CELEBRATION_BUDGET,DAT.HIT HIT_7_9,\n    CASE \n    WHEN ACH.CLUSTER_NAME IN ('East Cluster','North Cluster','North East Cluster','Central Cluster') THEN\n        CASE \n            WHEN  ACH_PER >= 200 THEN ((ACH.TARGET*2)*50)+CELEBRATION_BUDGET+(DAT.HIT*10)\n            WHEN  ACH_PER >= 100 THEN (ACH.HIT*50)+CELEBRATION_BUDGET+(DAT.HIT*10)\n            WHEN  ACH_PER >= 90 THEN ACH.HIT*40\n            ELSE 0 END\n     WHEN ACH.CLUSTER_NAME IN ('West Cluster') THEN\n        CASE \n            WHEN  ACH_PER >= 200 THEN ((TARGET*2)*50)+(DAT.HIT*20)\n            WHEN  ACH_PER >= 100 THEN (ACH.HIT*50)+(DAT.HIT*20)\n            WHEN  ACH_PER >= 90 THEN ACH.HIT*40\n            ELSE 0 END\n     ELSE 0 END COMMISSION\n    FROM RET_WISE_PERCENTAGE ACH\n    LEFT JOIN DD_DATE_WISE_ACH DAT ON DAT.DD_CODE = ACH.DD_CODE\n)\nSELECT * FROM CALCULATE_COMMISSION;--354  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;--529020        308025   TAKA\n\nSELECT * FROM TEMP_FOR_DD_DN_DET_09MAR25;--73  Rows\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_DN_DET_09MAR25;--6225490 TK\n\n-------------DETAIL------------\n\n--DROP TABLE TEMP_FOR_DD_BOS_DET2_9MAR25 PURGE;\nCREATE TABLE TEMP_FOR_DD_BOS_DET2_9MAR25 AS\nWITH DD_WISE_ACHIEVEMENT AS ( \n    SELECT AG.DD_CODE,RETAILER_CODE,RET_MSISDN,SUB_MSISDN CUSTOMER_MSISDN,RECHARGE_AMOUNT--AG.TARGET,COUNT(RECHARGE_AMOUNT) HIT\n    FROM TEMP_FOR_AG_MAP_09_MAR25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '1-MAR-25' AND '09-MAR-25') AND EV.RECHARGE_AMOUNT IN (397,548,549)\n--    AND REGION IN ('Sylhet')\n--    AND SERVICE_CLASS_ID NOT IN (141) \n--    AND NOT EXISTS(SELECT MOBILENO FROM VW_EMPLOYEESALESCOM_MONTHLY VE WHERE VE.DATE_DATE='1-JAN-24' AND VE.MOBILENO=EV.SUB_MSISDN)\n\n)\nSELECT * FROM DD_WISE_ACHIEVEMENT;--109117  Rows\n\nSELECT * FROM TEMP_FOR_DD_BOS_DET2_9MAR25;--14686  Rows  54522146"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Deno Campaign_10th July25\n\n**Commission Name:** Distributor Deno Campaign_10th July25  \n**Start Date:** 10-Jul-2025  \n**End Date:** 10-Jul-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges) \n- **Target:** Distributor will be given Deno HIT targets (provided by B2C).  \n- **Mapping:** Agent list of 10th Jul’25 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno will be considered for performance calculation (Deno List: 497, 629, 748, 729, 848, 849, 998).  \n    - Upon achieving Deno HIT target (Cumulative of DENO), Distributor will be given slab-based incentives:  \n        - **91%-100%:** BDT 10 per HIT  \n        - **101%-120%:** BDT 15 per HIT  \n        - **121% and Above:** BDT 20 per HIT  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n    - Recharge of campaign Deno at BL employee pool phone numbers will not be considered for DH & Retail achievement. Employee mapping as of 31st May’25 will be considered.  \n    - Ryze Recharge (Service Class 141) will not be considered for performance calculation.  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, HIT Target Ach, % Ach, Incentive Amount  \n- **Detail 2:** DD_CODE, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n```", "sql": "-------------------------------HELPER QUERY------------------------------------\n-- 7451 9574 61612\n--DROP TABLE TEMP_FOR_DENO_CAM_TAR_10JUL25 PURGE;\nCREATE TABLE TEMP_FOR_DENO_CAM_TAR_10JUL25 AS\nselect CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET \nWHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \nwhere REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Deno Campaign_10th July25') and  \nCYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jul_25'));--337  Rows\n\nSELECT * FROM TEMP_FOR_DENO_CAM_TAR_10JUL25;--337  Rows\n\n--DROP TABLE TEMP_FOR_AG_LST_MAP_10JUL25 PURGE;\nCREATE TABLE TEMP_FOR_AG_LST_MAP_10JUL25 AS\nSELECT TAR.*,AG.RET_CODE RETAILER_CODE, AG.RET_MOBILE RET_MSISDN \nFROM TEMP_FOR_DENO_CAM_TAR_10JUL25 TAR \nINNER JOIN DD_RSO_RET_MAPPING_DAILY AG ON AG.DD_CODE=TAR.DD_CODE AND AG.DATA_DATE = '10-JUL-25';--561446  Rows\n\nSELECT * FROM TEMP_FOR_AG_LST_MAP_10JUL25;-- 554906  Rows\nSELECT * FROM EV_RECHARGE_COM_DAILY;\n\n--DROP TABLE TEMP_FOR_DD_DN_DET_10JUL25 PURGE;\nCREATE TABLE TEMP_FOR_DD_DN_DET_10JUL25 AS\nWITH RSO_WISE_ACHIEVEMENT AS ( \n    SELECT /*+ parallel(10) */ AG.DD_CODE,AG.TARGET,COUNT(RECHARGE_AMOUNT) HIT\n    FROM TEMP_FOR_AG_LST_MAP_10JUL25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '10-JUL-25' AND '10-JUL-25') AND EV.RECHARGE_AMOUNT IN (497, 629, 748, 729, 848, 849, 998)\n    AND SERVICE_CLASS_ID NOT IN (141) \n    AND NOT EXISTS(SELECT MOBILENO FROM TEMP_FOR_VW_EMPLOYEESALESCOM_MONTHLY VE WHERE VE.DATE_DATE='31-MAY-25' AND VE.MOBILENO=EV.SUB_MSISDN)\n    GROUP BY AG.DD_CODE,  AG.TARGET\n)\n--SELECT * FROM RSO_WISE_ACHIEVEMENT;--322  Rows\n,RET_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((HIT/TARGET)*100) ACH_PER\nFROM RSO_WISE_ACHIEVEMENT ACHIEVEMENT\n)\n--SELECT * FROM RET_WISE_PERCENTAGE;--354  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,  TARGET, HIT,ACH_PER,\n    CASE\n        WHEN  ACH_PER >= 121 THEN HIT*20\n        WHEN  ACH_PER >= 101 THEN HIT*15\n        WHEN  ACH_PER >= 91 THEN HIT*10\n        ELSE 0\n    END COMMISSION\n    FROM RET_WISE_PERCENTAGE \n)\nSELECT * FROM CALCULATE_COMMISSION;--309  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;--218265 TAKA\n\nSELECT * FROM TEMP_FOR_DD_DN_DET_10JUL25;--309  Rows\nSELECT SUM(HIT) FROM TEMP_FOR_DD_DN_DET_10JUL25;--254820           234065        119175    TK   14895\n\n-------------DETAIL------------\n\n--DROP TABLE TEMP_FOR_DD_DN_DET2_10JUL25 PURGE;\nCREATE TABLE TEMP_FOR_DD_DN_DET2_10JUL25 AS\nWITH DD_WISE_ACHIEVEMENT AS ( \n    SELECT AG.DD_CODE,RETAILER_CODE,RET_MSISDN,SUB_MSISDN CUSTOMER_MSISDN,RECHARGE_AMOUNT--AG.TARGET,COUNT(RECHARGE_AMOUNT) HIT\n    FROM TEMP_FOR_AG_LST_MAP_10JUL25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '10-JUL-25' AND '10-JUL-25') AND EV.RECHARGE_AMOUNT IN (497, 629, 748, 729, 848, 849, 998)\n    AND SERVICE_CLASS_ID NOT IN (141) \n    AND NOT EXISTS(SELECT MOBILENO FROM TEMP_FOR_VW_EMPLOYEESALESCOM_MONTHLY VE WHERE VE.DATE_DATE='31-MAY-25' AND VE.MOBILENO=EV.SUB_MSISDN)\n)\nSELECT * FROM DD_WISE_ACHIEVEMENT;--14105  Rows\n\nselect * from TEMP_FOR_DD_DN_DET2_10JUL25;--12286  Rows  97,08,419  9708419\n\n--------------SETUP--------------\n\nSELECT APP.REPORT_NAME, CT.CHANNELTYPE, APP.CHANNEL_TYPE_ID\nFROM REPORT_APPROVAL APP \nINNER JOIN CHANNELTYPE CT ON CT.CHANNELTYPEID = APP.CHANNEL_TYPE_ID\nWHERE APP.REPORT_NAME = 'Distributor Deno Campaign_10th July25';\n--CHANNEL_TYPE_ID   1\n\n--EXEC ADHOC_REPORT_SETUP('Distributor Deno Campaign_10th July25', 'Nov_24', 'Nov_24', 1, '12-Nov-24', '12-Nov-24', '', '13-NOV-24');\n\n-- 8104 10174 65101\nSELECT * FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Deno Campaign_10th July25';\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jul_25'; --base month\nSELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS where REPORTID = 8104 and  CYCLEID = 10174;--65101\n\nSELECT * FROM AD_HOC_DATA WHERE REPORT_CYCLE_ID = 65101;\n--delete from ad_hoc_data where REPORT_CYCLE_ID = 65101;\n--commit;\n\nINSERT INTO AD_HOC_DATA (ID, REPORT_CYCLE_ID, CHANNEL_CODE,COMMISSION_AMOUNT)\nSELECT /*+ parallel(16) */  AD_HOC_DATA_ID.nextval id, 65101 REPORT_CYCLE_ID, DD_CODE, COMMISSION\nFROM (\nSELECT * FROM TEMP_FOR_DD_DN_DET_10JUL25\n);\nCOMMIT;\n\nSELECT SUM(COMMISSION_AMOUNT) FROM ad_hoc_data where REPORT_CYCLE_ID = 65101; --254820            234065        119175        193245        218265   TAKA\n\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jul_25'; --Publish month --10174\n \nEXEC PROC_COMMISSION_DETAIL_SETUP('Distributor Deno Campaign_10th July25',10174,'TEMP_FOR_DD_DN_DET_10JUL25','SUMMERY_DETAIL','TEMP_FOR_DD_DN_DET2_10JUL25','MSISDN_DETAIL');\n \nEXEC FINALIZE_REPORT_ADHOC('Distributor Deno Campaign_10th July25', 65101,'Jul_25', 'Jul_25',290, 1);\n\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Deno Campaign_12th Feb25\n\n**Commission Name:** Distributor Deno Campaign_12th Feb25  \n**Start Date:** 12-Feb-2025  \n**End Date:** 12-Feb-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges)\n- **Target:** Distributor will be given Deno HIT targets (provided by B2C).  \n- **Mapping:** Agent list of 12th Feb’25 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno will be considered for performance calculation (Deno List: 497, 597, 698, 699, 798, 799, 998).  \n    - Upon achieving Deno HIT target (Cumulative of DENO), Distributor will be given slab-based incentives:  \n        - **70%-90%:** BDT 10 per HIT  \n        - **91%-100%:** BDT 15 per HIT  \n        - **101%-110%:** BDT 20 per HIT  \n        - **111% and Above:** BDT 25 per HIT  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n    - Recharge of campaign Deno at BL employee pool phone numbers will not be considered for DH & Retail achievement.  \n    - Ryze Recharge (Service Class 141) will not be considered for performance calculation.  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, HIT Target Ach, % Ach, Incentive Amount  \n- **Detail 2:** DD_CODE, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n```", "sql": "-------------------------------HELPER QUERY------------------------------------\n-- 7451 9574 61612\n\ncreate table TEMP_FOR_DENO_CAMP_TAR_12_FEB25 as\nselect CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET \nWHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \nwhere REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Deno Campaign_12th Feb25') and  \nCYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Feb_25'));--355  Rows\n\nSELECT * FROM TEMP_FOR_DENO_CAMP_TAR_12_FEB25;--355  Rows\n\n--DROP TABLE TEMP_FOR_AG_LIST_MAP_12_FEB25 PURGE;\nCREATE TABLE TEMP_FOR_AG_LIST_MAP_12_FEB25 AS\nSELECT TAR.*,AG.RET_CODE RETAILER_CODE, AG.RET_MOBILE RET_MSISDN \nFROM TEMP_FOR_DENO_CAMP_TAR_12_FEB25 TAR \nINNER JOIN DD_RSO_RET_MAPPING_DAILY AG ON AG.DD_CODE=TAR.DD_CODE AND AG.DATA_DATE = '12-FEB-25';--117449  Rows\n\nSELECT * FROM TEMP_FOR_AG_LIST_MAP_12_FEB25;-- 563873  Rows\nSELECT * FROM EV_RECHARGE_COM_DAILY;\n\n--DROP TABLE TEMP_FOR_DD_DENO_DET_12_FEB25 PURGE;\nCREATE TABLE TEMP_FOR_DD_DENO_DET_12_FEB25 AS\nWITH RSO_WISE_ACHIEVEMENT AS ( \n    SELECT AG.DD_CODE,AG.TARGET,COUNT(RECHARGE_AMOUNT) HIT\n    FROM TEMP_FOR_AG_LIST_MAP_12_FEB25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '12-FEB-25' AND '12-FEB-25') AND EV.RECHARGE_AMOUNT IN (497,597,698,699,798,799,998)\n    AND SERVICE_CLASS_ID NOT IN (141) \n    AND NOT EXISTS(SELECT MOBILENO FROM VW_EMPLOYEESALESCOM_MONTHLY VE WHERE VE.DATE_DATE='1-JAN-24' AND VE.MOBILENO=EV.SUB_MSISDN)\n    GROUP BY AG.DD_CODE,  AG.TARGET\n)\n--SELECT * FROM RSO_WISE_ACHIEVEMENT;--334  Rows\n,RET_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((HIT/TARGET)*100) ACH_PER\nFROM RSO_WISE_ACHIEVEMENT ACHIEVEMENT\n)\n--SELECT * FROM RET_WISE_PERCENTAGE;--354  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,  TARGET, HIT,ACH_PER,\n    CASE\n        WHEN  ACH_PER >= 111 THEN HIT*25\n        WHEN  ACH_PER >= 101 THEN HIT*20\n        WHEN  ACH_PER >= 91 THEN HIT*15\n        WHEN  ACH_PER >= 70 THEN HIT*10\n        ELSE 0\n    END COMMISSION\n    FROM RET_WISE_PERCENTAGE \n)\nSELECT * FROM CALCULATE_COMMISSION;--354  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;--308025    408575 TAKA\n\nSELECT * FROM TEMP_FOR_DD_DENO_DET_12_FEB25;--354  Rows\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_DENO_DET_12_FEB25;--308025            408575 TK\n\n-------------DETAIL------------\n\n--DROP TABLE TEMP_FOR_DD_DENO_DET2_12_FEB25 PURGE;\nCREATE TABLE TEMP_FOR_DD_DENO_DET2_12_FEB25 AS\nWITH DD_WISE_ACHIEVEMENT AS ( \n    SELECT AG.DD_CODE,RETAILER_CODE,RET_MSISDN,SUB_MSISDN CUSTOMER_MSISDN,RECHARGE_AMOUNT--AG.TARGET,COUNT(RECHARGE_AMOUNT) HIT\n    FROM TEMP_FOR_AG_LIST_MAP_12_FEB25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '12-FEB-25' AND '12-FEB-25') AND EV.RECHARGE_AMOUNT IN (497,597,698,699,798,799,998)\n    AND SERVICE_CLASS_ID NOT IN (141) \n    AND NOT EXISTS(SELECT MOBILENO FROM VW_EMPLOYEESALESCOM_MONTHLY VE WHERE VE.DATE_DATE='1-JAN-24' AND VE.MOBILENO=EV.SUB_MSISDN)\n)\nSELECT * FROM DD_WISE_ACHIEVEMENT;--15446  Rows\n\nselect * from TEMP_FOR_DD_DENO_DET2_12_FEB25;--15446  Rows\n\n----------------SETUP-----------\n\nSELECT APP.REPORT_NAME, CT.CHANNELTYPE, APP.CHANNEL_TYPE_ID\nFROM REPORT_APPROVAL APP \nINNER JOIN CHANNELTYPE CT ON CT.CHANNELTYPEID = APP.CHANNEL_TYPE_ID\nWHERE APP.REPORT_NAME = 'Distributor Deno Campaign_12th Feb25';\n--CHANNEL_TYPE_ID   1\n\n--EXEC ADHOC_REPORT_SETUP('Distributor Deno Campaign_12th Feb25', 'Nov_24', 'Nov_24', 1, '12-Nov-24', '12-Nov-24', '', '13-NOV-24');\n\n-- 7522 9674 62034\nSELECT * FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Deno Campaign_12th Feb25';\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Feb_25'; --base month\nSELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS where REPORTID = 7522 and  CYCLEID = 9674;--62034\n\nSELECT * FROM AD_HOC_DATA WHERE REPORT_CYCLE_ID = 62034;\n--delete from ad_hoc_data where REPORT_CYCLE_ID = 62034;\n--commit;\n\nINSERT INTO AD_HOC_DATA (ID, REPORT_CYCLE_ID, CHANNEL_CODE,COMMISSION_AMOUNT)\nSELECT /*+ parallel(16) */  AD_HOC_DATA_ID.nextval id, 62034 REPORT_CYCLE_ID, DD_CODE, COMMISSION\nFROM (\nSELECT * FROM TEMP_FOR_DD_DENO_DET_12_FEB25\n);\nCOMMIT;\n\nSELECT SUM(COMMISSION_AMOUNT) FROM ad_hoc_data where REPORT_CYCLE_ID = 62034; -- 308025 TAKA\n\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Feb_25'; --Publish month --9674\n \nEXEC PROC_COMMISSION_DETAIL_SETUP('Distributor Deno Campaign_12th Feb25',9674,'TEMP_FOR_DD_DENO_DET_12_FEB25','SUMMERY_DETAIL','TEMP_FOR_DD_DENO_DET2_12_FEB25','MSISDN_DETAIL');\n \nEXEC FINALIZE_REPORT_ADHOC('Distributor Deno Campaign_12th Feb25', 62034,'Feb_25', 'Feb_25',290, 1);\n\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Deno Campaign_1st Jan25\n\n**Commission Name:** Distributor Deno Campaign_1st Jan25  \n**Start Date:** 1-Jan-2025  \n**End Date:** 1-Jan-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges)  \n- **Target:** Distributor will be given Deno HIT target (provided by B2C).  \n- **Mapping:** Agent list of 1st Jan’25 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno will be considered for performance calculation (Deno List: 497, 597, 648, 699, 798, 799, 998).  \n    - Upon achieving Deno HIT target (Cumulative of DENO), Distributor will be given slab-based incentives:  \n        - **70%-80% Achievement:** BDT 10  \n        - **81%-90% Achievement:** BDT 15  \n        - **91%-100% Achievement:** BDT 20  \n        - **101%-110% Achievement:** BDT 25  \n        - **111% and Above Achievement:** BDT 30  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, HIT Target ach, % Ach, Incentive Amount  \n- **Detail 2:** DD_CODE, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n```", "sql": "-------------------------------HELPER QUERY------------------------------------\nCREATE TABLE TEMP_FOR_DENO_CAMP_TAR_1JAN25 AS\nselect CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET \nWHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \nwhere REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Deno Campaign_1st Jan25') and  \nCYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jan_25'));--1278  Rows\n\nSELECT * FROM TEMP_FOR_DENO_CAMP_TAR_1JAN25;--370  Rows\n\n--DROP TABLE TEMP_FOR_AGLIST_MAP_1JAN25 PURGE;\nCREATE TABLE TEMP_FOR_AGLIST_MAP_1JAN25 AS\nSELECT TAR.*,AG.RETAILER_CODE, AG.TOPUP_MSISDN RET_MSISDN \nFROM TEMP_FOR_DENO_CAMP_TAR_1JAN25 TAR \nINNER JOIN AGENT_LIST_DAILY AG ON AG.DIST_CODE=TAR.DD_CODE AND AG.DATA_DATE = '1-JAN-25';--134230  Rows\n\nSELECT * FROM TEMP_FOR_AGLIST_MAP_1JAN25;--560646  Rows\n\n--DROP TABLE TEMP_FOR_DD_DN_DET1_1JAN25 PURGE;\nCREATE TABLE TEMP_FOR_DD_DN_DET1_1JAN25 AS\nWITH DD_WISE_ACHIEVEMENT AS ( \n    SELECT AG.DD_CODE,AG.TARGET,COUNT(RECHARGE_AMOUNT) HIT\n    FROM TEMP_FOR_AGLIST_MAP_1JAN25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '1-JAN-25' AND '1-JAN-25') AND EV.RECHARGE_AMOUNT IN (497,597,648,699,798,799,998)\n    GROUP BY AG.DD_CODE,  AG.TARGET\n)\n--SELECT * FROM DD_WISE_ACHIEVEMENT;--355  Rows\n,DD_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((HIT/TARGET)*100) ACH_PER\nFROM DD_WISE_ACHIEVEMENT ACHIEVEMENT\n)\n--SELECT * FROM DD_WISE_PERCENTAGE;--355  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,  TARGET, HIT,ACH_PER,\n    CASE\n        WHEN  ACH_PER >= 111 THEN HIT*30\n        WHEN  ACH_PER >= 101 THEN HIT*25\n        WHEN  ACH_PER >= 91 THEN HIT*20\n        WHEN  ACH_PER >= 81 THEN HIT*15\n        WHEN  ACH_PER >= 70 THEN HIT*10\n        ELSE 0\n    END COMMISSION\n    FROM DD_WISE_PERCENTAGE \n)\nSELECT * FROM CALCULATE_COMMISSION;--365  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;--527940 TK\n\nSELECT * FROM TEMP_FOR_DD_DN_DET1_1JAN25;--355  Rows\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_DN_DET1_1JAN25;--599170 TK\n\n--SELECT SYSDATE-3 FROM DUAL;\n\n--------------------SETUP----------------\nSELECT APP.REPORT_NAME, CT.CHANNELTYPE, APP.CHANNEL_TYPE_ID\nFROM REPORT_APPROVAL APP \nINNER JOIN CHANNELTYPE CT ON CT.CHANNELTYPEID = APP.CHANNEL_TYPE_ID\nWHERE APP.REPORT_NAME = 'Distributor Deno Campaign_1st Jan25';\n--CHANNEL_TYPE_ID   1\n\n\n--EXEC ADHOC_REPORT_SETUP('Distributor Deno Campaign_1st Jan25', 'Jan_25', 'Jan_25', 1, '27-NOV-24', '27-NOV-24', '', '28-NOV-24');\n\n\n-- 7314 9574 60652\nSELECT * FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Deno Campaign_1st Jan25';\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jan_25'; --base month\nSELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS where REPORTID = 7314 and  CYCLEID = 9574;--60652\n\nSELECT * FROM AD_HOC_DATA WHERE REPORT_CYCLE_ID = 60652;\n--delete from ad_hoc_data where REPORT_CYCLE_ID = 60652;\n--commit;\n\nINSERT INTO AD_HOC_DATA (ID, REPORT_CYCLE_ID, CHANNEL_CODE,COMMISSION_AMOUNT)\nSELECT /*+ parallel(16) */  AD_HOC_DATA_ID.nextval id, 60652 REPORT_CYCLE_ID, DD_CODE, COMMISSION\nFROM (\nSELECT * FROM TEMP_FOR_DD_DN_DET1_1JAN25\n);\nCOMMIT;\n\nSELECT SUM(COMMISSION_AMOUNT) FROM ad_hoc_data where REPORT_CYCLE_ID = 60652; -- 599170 TAKA\n\n\nEXEC PROC_COMMISSION_DETAIL_SETUP('Distributor Deno Campaign_1st Jan25',9574,'TEMP_FOR_DD_DN_DET1_1JAN25','SUMMARY DETAILS');\n\n \nEXEC FINALIZE_REPORT_ADHOC('Distributor Deno Campaign_1st Jan25', 60652,'Jan_25', 'Jan_25',290, 1);\n\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Deno Campaign_1st July25\n\n**Commission Name:** Distributor Deno Campaign_1st July25  \n**Start Date:** 1-Jul-2025  \n**End Date:** 1-Jul-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges)\n- **Target:** Distributor will be given Deno HIT target (provided by B2C)  \n- **Mapping:** Agent list of 1st Jul’25 will be considered  \n- **Calculation Logics:**  \n    - Selected Deno will be considered for performance calculation (Deno List: 497, 629, 748, 729, 848, 849, 998)  \n    - Upon achieving Deno HIT target (Cumulative of DENO), Distributor will be given slab-based incentives:  \n        - **91%-100% Achievement:** BDT 10  \n        - **101%-120% Achievement:** BDT 15  \n        - **121% and Above Achievement:** BDT 25  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation  \n\n**Exclusions:**  \n- Any recharge of campaign Deno at BL employee pool phone numbers will not be considered for DH & Retail achievement (Employee mapping as of 31st May’25).  \n- Ryze Recharge (Service Class 141) will not be considered for performance calculation.  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, HIT Target ach, % Ach, Incentive Amount  \n- **Detail 2:** DD_CODE, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n```", "sql": "-------------------------------HELPER QUERY------------------------------------\n-- 7451 9574 61612\nDROP TABLE TEMP_FOR_DENO_CAM_TAR_1JUL25 PURGE;\nCREATE TABLE TEMP_FOR_DENO_CAM_TAR_1JUL25 AS\nselect CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET \nWHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \nwhere REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Deno Campaign_1st July25') and  \nCYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jul_25'));--337  Rows\n\nSELECT * FROM TEMP_FOR_DENO_CAM_TAR_1JUL25;--337  Rows\n\n--DROP TABLE TEMP_FOR_AG_LST_MAP_1_JUL25 PURGE;\nCREATE TABLE TEMP_FOR_AG_LST_MAP_1_JUL25 AS\nSELECT TAR.*,AG.RET_CODE RETAILER_CODE, AG.RET_MOBILE RET_MSISDN \nFROM TEMP_FOR_DENO_CAM_TAR_1JUL25 TAR \nINNER JOIN DD_RSO_RET_MAPPING_DAILY AG ON AG.DD_CODE=TAR.DD_CODE AND AG.DATA_DATE = '1-JUL-25';--561446  Rows\n\nSELECT * FROM TEMP_FOR_AG_LST_MAP_1_JUL25;-- 554906  Rows\nSELECT * FROM EV_RECHARGE_COM_DAILY;\n\n--DROP TABLE TEMP_FOR_DD_DN_DET_1JUL25 PURGE;\nCREATE TABLE TEMP_FOR_DD_DN_DET_1JUL25 AS\nWITH RSO_WISE_ACHIEVEMENT AS ( \n    SELECT /*+ parallel(10) */ AG.DD_CODE,AG.TARGET,COUNT(RECHARGE_AMOUNT) HIT\n    FROM TEMP_FOR_AG_LST_MAP_1_JUL25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '1-JUL-25' AND '1-JUL-25') AND EV.RECHARGE_AMOUNT IN (497, 629, 748, 729, 848, 849, 998)\n    AND SERVICE_CLASS_ID NOT IN (141) \n    AND NOT EXISTS(SELECT MOBILENO FROM TEMP_FOR_VW_EMPLOYEESALESCOM_MONTHLY VE WHERE VE.DATE_DATE='31-MAY-25' AND VE.MOBILENO=EV.SUB_MSISDN)\n    GROUP BY AG.DD_CODE,  AG.TARGET\n)\n--SELECT * FROM RSO_WISE_ACHIEVEMENT;--322  Rows\n,RET_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((HIT/TARGET)*100) ACH_PER\nFROM RSO_WISE_ACHIEVEMENT ACHIEVEMENT\n)\n--SELECT * FROM RET_WISE_PERCENTAGE;--354  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,  TARGET, HIT,ACH_PER,\n    CASE\n        WHEN  ACH_PER >= 121 THEN HIT*25\n        WHEN  ACH_PER >= 101 THEN HIT*15\n        WHEN  ACH_PER >= 91 THEN HIT*10\n        ELSE 0\n    END COMMISSION\n    FROM RET_WISE_PERCENTAGE \n)\nSELECT * FROM CALCULATE_COMMISSION;--68  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;--218265 TAKA\n\nSELECT * FROM TEMP_FOR_DD_DN_DET_1JUL25;--315  Rows\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_DN_DET_1JUL25;--234065        119175    TK\n\n-------------DETAIL------------\n\n--DROP TABLE TEMP_FOR_DD_DN_DET2_1JUL25 PURGE;\nCREATE TABLE TEMP_FOR_DD_DN_DET2_1JUL25 AS\nWITH DD_WISE_ACHIEVEMENT AS ( \n    SELECT AG.DD_CODE,RETAILER_CODE,RET_MSISDN,SUB_MSISDN CUSTOMER_MSISDN,RECHARGE_AMOUNT--AG.TARGET,COUNT(RECHARGE_AMOUNT) HIT\n    FROM TEMP_FOR_AG_LST_MAP_1_JUL25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '1-JUL-25' AND '1-JUL-25') AND EV.RECHARGE_AMOUNT IN (497, 629, 748, 729, 848, 849, 998)\n    AND SERVICE_CLASS_ID NOT IN (141) \n    AND NOT EXISTS(SELECT MOBILENO FROM TEMP_FOR_VW_EMPLOYEESALESCOM_MONTHLY VE WHERE VE.DATE_DATE='31-MAY-25' AND VE.MOBILENO=EV.SUB_MSISDN)\n)\nSELECT * FROM DD_WISE_ACHIEVEMENT;--14105  Rows\n\nselect * from TEMP_FOR_DD_DN_DET2_1JUL25;--12286  Rows  97,08,419  9708419\n\n----------------------SETUP--------------------\n\nSELECT APP.REPORT_NAME, CT.CHANNELTYPE, APP.CHANNEL_TYPE_ID\nFROM REPORT_APPROVAL APP \nINNER JOIN CHANNELTYPE CT ON CT.CHANNELTYPEID = APP.CHANNEL_TYPE_ID\nWHERE APP.REPORT_NAME = 'Distributor Deno Campaign_1st July25';\n--CHANNEL_TYPE_ID   1\n\n--EXEC ADHOC_REPORT_SETUP('Distributor Deno Campaign_1st July25', 'Nov_24', 'Nov_24', 1, '12-Nov-24', '12-Nov-24', '', '13-NOV-24');\n\n-- 8080 10174 64977\nSELECT * FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Deno Campaign_1st July25';\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jul_25'; --base month\nSELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS where REPORTID = 8080 and  CYCLEID = 10174;--64977\n\nSELECT * FROM AD_HOC_DATA WHERE REPORT_CYCLE_ID = 64977;\n--delete from ad_hoc_data where REPORT_CYCLE_ID = 64977;\n--commit;\n\nINSERT INTO AD_HOC_DATA (ID, REPORT_CYCLE_ID, CHANNEL_CODE,COMMISSION_AMOUNT)\nSELECT /*+ parallel(16) */  AD_HOC_DATA_ID.nextval id, 64977 REPORT_CYCLE_ID, DD_CODE, COMMISSION\nFROM (\nSELECT * FROM TEMP_FOR_DD_DN_DET_1JUL25\n);\nCOMMIT;\n\nSELECT SUM(COMMISSION_AMOUNT) FROM ad_hoc_data where REPORT_CYCLE_ID = 64977; --234065        119175        193245        218265   TAKA\n\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jul_25'; --Publish month --10174\n \nEXEC PROC_COMMISSION_DETAIL_SETUP('Distributor Deno Campaign_1st July25',10174,'TEMP_FOR_DD_DN_DET_1JUL25','SUMMERY_DETAIL','TEMP_FOR_DD_DN_DET2_1JUL25','MSISDN_DETAIL');\n \nEXEC FINALIZE_REPORT_ADHOC('Distributor Deno Campaign_1st July25', 64977,'Jun_25', 'Jul_25',290, 1);\n\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Deno Campaign_2 Distributor_10th Mar25\n\n**Commission Name:** Distributor Deno Campaign_2 Distributor_10th Mar25  \n**Start Date:** 10-Mar-2025  \n**End Date:** 10-Mar-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges)  \n- **Target:** Distributor will be given Deno Recharge target (provided by B2C)  \n- **Mapping:** Agent list of 10th Mar’25 will be considered  \n- **Calculation Logics:**  \n    - Selected Deno will be considered for performance calculation (Deno List will be shared by B2C)  \n    - Upon achieving Deno Recharge target (Cumulative of DENO), Distributor will be given incentives (Distributor-wise Recharge Target and Incentives will be shared by B2C).  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation  \n\n**Exclusions:**  \n- Any recharge of campaign Deno at BL employee pool phone numbers will not be considered for DH & Retail achievement (Employee mapping as of 9th Mar’25).  \n- Invalid recharge types or service classes will not be considered for performance calculation.  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, Recharge Target ach, % Ach, Incentive Amount  \n- **Detail 2:** DD_CODE, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n```", "sql": "-------------------------------HELPER QUERY------------------------------------\nCREATE TABLE DD_10TH_MAR25_62812 AS\nselect CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET \nWHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \nwhere REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Deno Campaign_28th Feb25') and  \nCYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Feb_25'));\n\n--drop table DD_10TH_MAR25_62812 purge;\nSELECT * FROM DD_10TH_MAR25_62812;--2  Rows\nupdate DD_10TH_MAR25_62812 set DD_CODE = trim(DD_CODE);\ncommit;\nSELECT * FROM DD_RSO_RET_MAPPING_DAILY;\n\nCREATE TABLE TEMP_FOR_EV_10FEB25 AS\nSELECT * FROM TEMP_FOR_EV_10FEB25 WHERE TOP_UP_DATE BETWEEN '10-MAR-25' AND '10-MAR-25';\nSELECT * FROM TEMP_FOR_EV_10FEB25;\n\n--DROP TABLE TEMP_FOR_AG_LIST_10_MAR25 PURGE;\nCREATE TABLE TEMP_FOR_AG_LIST_10_MAR25 AS\nSELECT TAR.*,AG.RET_CODE RETAILER_CODE, AG.RET_MOBILE RET_MSISDN \nFROM DD_10TH_MAR25_62812 TAR \nINNER JOIN DD_RSO_RET_MAPPING_DAILY AG ON AG.DD_CODE=TAR.DD_CODE AND AG.DATA_DATE = '10-MAR-25';--236872  Rows\n\nSELECT * FROM TEMP_FOR_AG_LIST_10_MAR25;-- 3000  Rows\n\nselect max(DATE_DATE) from VW_EMPLOYEESALESCOM_MONTHLY;\n--DROP TABLE TEMP_FOR_2DD_DENO_DAT_10_MAR25 PURGE;\nCREATE TABLE TEMP_FOR_2DD_DENO_DAT_10_MAR25 AS\nWITH DD_WISE_ACHIEVEMENT AS ( \n    SELECT AG.DD_CODE,AG.TARGET,SUM(RECHARGE_AMOUNT) TOTAL_RECHARGE,INCENTIVE\n    FROM TEMP_FOR_AG_LIST_10_MAR25 AG \n    INNER JOIN TEMP_FOR_EV_10FEB25 EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '10-MAR-25' AND '10-MAR-25') AND EV.RECHARGE_AMOUNT IN (\n    19,27,34,36,47,48,56,57,58,64,69,77,81,86,96,97,99,104,\n117,118,127,129,137,147,149,157,167,169,177,188,196,197,\n198,199,207,209,222,224,227,229,247,248,259,296,297,298,\n299,307,347,348,396,397,398,399,448,497,498,499,548,\n549,597,599,649,698,699,719,797,798,799,897,899,997,\n998,1199,1397,1899,1999\n    )\n--    AND SERVICE_CLASS_ID NOT IN (141) \n--    AND NOT EXISTS(SELECT MOBILENO FROM VW_EMPLOYEESALESCOM_MONTHLY VE WHERE VE.DATE_DATE='1-JAN-24' AND VE.MOBILENO=EV.SUB_MSISDN)\n    GROUP BY AG.DD_CODE,  AG.TARGET,INCENTIVE\n)\n--SELECT * FROM DD_WISE_ACHIEVEMENT; --67  Rows\n--,DD_WISE_PERCENTAGE AS (\n--SELECT ACHIEVEMENT.*,ROUND((HIT/TARGET)*100) ACH_PER\n--FROM DD_WISE_ACHIEVEMENT ACHIEVEMENT\n--)\n--SELECT * FROM DD_WISE_PERCENTAGE;--67  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,  TARGET, TOTAL_RECHARGE,\n    CASE WHEN  TOTAL_RECHARGE >= TARGET THEN INCENTIVE ELSE 0 END COMMISSION\n    FROM DD_WISE_ACHIEVEMENT \n)\nSELECT * FROM CALCULATE_COMMISSION;--2 Rows\nSELECT SUM(COMMISSION) FROM CALCULATE_COMMISSION;--12000\n\nSELECT * FROM TEMP_FOR_2DD_DENO_DAT_10_MAR25;--2  Rows\nSELECT SUM(COMMISSION) FROM TEMP_FOR_2DD_DENO_DAT_10_MAR25;--12000 TK\n\n-------detail---------\nselect * from TEMP_FOR_AG_LIST_10_MAR25;\nselect * from TEMP_FOR_EV_10FEB25;\n--drop table TEMP_FOR_2DD_DENO_DAT2_10MAR25 purge;\nCREATE TABLE TEMP_FOR_2DD_DENO_DAT2_10MAR25 AS\nWITH DD_WISE_ACHIEVEMENT AS ( \n    SELECT AG.DD_CODE,RETAILER_CODE,RET_MSISDN,SUB_MSISDN CUSTOMER_MSISDN,RECHARGE_AMOUNT\n    FROM TEMP_FOR_AG_LIST_10_MAR25 AG \n    INNER JOIN TEMP_FOR_EV_10FEB25 EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '10-MAR-25' AND '10-MAR-25') AND EV.RECHARGE_AMOUNT IN (\n    19,27,34,36,47,48,56,57,58,64,69,77,81,86,96,97,99,104,\n117,118,127,129,137,147,149,157,167,169,177,188,196,197,\n198,199,207,209,222,224,227,229,247,248,259,296,297,298,\n299,307,347,348,396,397,398,399,448,497,498,499,548,\n549,597,599,649,698,699,719,797,798,799,897,899,997,\n998,1199,1397,1899,1999\n    )\n--    AND SERVICE_CLASS_ID NOT IN (141) \n--    AND NOT EXISTS(SELECT MOBILENO FROM VW_EMPLOYEESALESCOM_MONTHLY VE WHERE VE.DATE_DATE='1-JAN-24' AND VE.MOBILENO=EV.SUB_MSISDN)\n--    GROUP BY AG.DD_CODE,  AG.TARGET\n)\nSELECT * FROM DD_WISE_ACHIEVEMENT;--6438  Rows\nSELECT * FROM TEMP_FOR_2DD_DENO_DAT2_10MAR25; --2833  Rows\n\n\n------------------SETUP--------------\nSELECT APP.REPORT_NAME, CT.CHANNELTYPE, APP.CHANNEL_TYPE_ID\nFROM REPORT_APPROVAL APP \nINNER JOIN CHANNELTYPE CT ON CT.CHANNELTYPEID = APP.CHANNEL_TYPE_ID\nWHERE APP.REPORT_NAME = 'Distributor Deno Campaign_2 Distributor_10th Mar25';\n--CHANNEL_TYPE_ID   1\n\n--EXEC ADHOC_REPORT_SETUP('Distributor Deno Campaign_2 Distributor_10th Mar25', 'Nov_24', 'Nov_24', 1, '2-Nov-24', '2-Nov-24', '', '3-NOV-24');\n\n-- 7654 9754 62812\nSELECT * FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Deno Campaign_2 Distributor_10th Mar25';\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Mar_25'; --base month\nSELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS where REPORTID = 7654 and  CYCLEID = 9754;--62812\n\nSELECT * FROM AD_HOC_DATA WHERE REPORT_CYCLE_ID = 62812;\n--delete from ad_hoc_data where REPORT_CYCLE_ID = 62812;\n--commit;\n\nINSERT INTO AD_HOC_DATA (ID, REPORT_CYCLE_ID, CHANNEL_CODE,COMMISSION_AMOUNT)\nSELECT /*+ parallel(16) */  AD_HOC_DATA_ID.nextval id, 62812 REPORT_CYCLE_ID, DD_CODE, COMMISSION\nFROM (\nSELECT * FROM TEMP_FOR_2DD_DENO_DAT_10_MAR25\n);\nCOMMIT;\n\nSELECT SUM(COMMISSION_AMOUNT) FROM ad_hoc_data where REPORT_CYCLE_ID = 62812; -- 12000 TAKA\n\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Mar_25'; --Publish month --9754\n\n--EXEC PROC_COMMISSION_DETAIL_SETUP('Distributor Deno Campaign_2 Distributor_10th Mar25',9754,'TEMP_FOR_2DD_DENO_DAT_10_MAR25','SUMMERY_DETAIL','TEMP_FOR_2DD_DENO_DAT2_10MAR25','SUMMERY_DETAIL');\n \n--EXEC FINALIZE_REPORT_ADHOC('Distributor Deno Campaign_2 Distributor_10th Mar25', 62812,'Mar_25', 'Mar_25',290, 1);\n\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Deno Campaign_7th to 8th Aug24\n\n**Commission Name:** Distributor Deno Campaign_7th to 8th Aug24  \n**Start Date:** 7-Aug-2024  \n**End Date:** 8-Aug-2024  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges) \n- **Target:** Distributor will be given Deno HIT targets (provided by B2C).  \n- **Mapping:** Agent list of 8th Aug’24 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno will be considered for performance calculation (Deno List: 397, 497, 647, 699, 798, 799, 899, 998).  \n    - Upon achieving Deno HIT target (Cumulative of DENO), Distributor will be given slab-based incentives:  \n        - **70%-80%:** BDT 10 per HIT  \n        - **81%-90%:** BDT 15 per HIT  \n        - **91%-100%:** BDT 20 per HIT  \n        - **101%-110%:** BDT 25 per HIT  \n        - **111% and Above:** BDT 30 per HIT  \n        - **Special Condition:** If the region achieves 80% of its Deno HIT target, distributors will receive BDT 40 per HIT. Otherwise, no celebration budget will be allocated.  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, Deno Ach Count, Commission Amount  \n```", "sql": "-------------------------------HELPER QUERY------------------------------------\n--drop table TEMP_FOR_DENO_CAMP_TAR_8AUG24 purge;\nSELECT * FROM TEMP_FOR_DENO_CAMP_TAR_8AUG24;--374  Rows\nupdate TEMP_FOR_DENO_CAMP_TAR_8AUG24 set DD_CODE = trim(DD_CODE);\ncommit;\n\n--DROP TABLE TEMP_FOR_AG_LIST_MAP_8AUG24 PURGE;\nCREATE TABLE TEMP_FOR_AG_LIST_MAP_8AUG24 AS\nSELECT TAR.*,AG.RETAILER_CODE, AG.TOPUP_MSISDN RET_MSISDN FROM \nTEMP_FOR_DENO_CAMP_TAR_8AUG24 TAR \nINNER JOIN AGENT_LIST_DAILY AG ON AG.DIST_CODE=TAR.DD_CODE AND AG.DATA_DATE = '8-AUG-24';--559623  Rows\n\nSELECT * FROM TEMP_FOR_AG_LIST_MAP_8AUG24;-- 559623  Rows\n\n--DROP TABLE TEMP_FOR_DD_DENO_DET1_8AUG24 PURGE;\n--CREATE TABLE TEMP_FOR_DD_DENO_DET1_8AUG24 AS\nWITH RSO_WISE_ACHIEVEMENT AS ( \n    SELECT REGION,AG.DD_CODE,AG.TARGET,COUNT(RECHARGE_AMOUNT) HIT\n    FROM TEMP_FOR_AG_LIST_MAP_8AUG24 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '7-AUG-24' AND '8-AUG-24') AND EV.RECHARGE_AMOUNT IN (397,497,647,699,798,799,899,998)\n    GROUP BY AG.DD_CODE,  AG.TARGET,REGION\n)\nSELECT * FROM RSO_WISE_ACHIEVEMENT;--372  Rows\n,RET_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((HIT/TARGET)*100) ACH_PER\nFROM RSO_WISE_ACHIEVEMENT ACHIEVEMENT\n)\n--SELECT * FROM RET_WISE_PERCENTAGE;--375  Rows\n,REGION_WISE_ACH AS (\nSELECT REGION,  SUM(TARGET) REGION_TARGET, SUM(HIT) REGION_HIT\nFROM RSO_WISE_ACHIEVEMENT ACHIEVEMENT\nGROUP BY REGION\n)\n--SELECT * FROM REGION_WISE_ACH;--375  Rows\n,REGION_WISE_PERCENTAGE AS (\nSELECT AL.REGION, DD_CODE, TARGET, HIT, ACH_PER ,REGION_ACH_PER\nFROM RET_WISE_PERCENTAGE AL \nINNER JOIN (\nSELECT REGION,ROUND((REGION_HIT/REGION_TARGET)*100) REGION_ACH_PER\nFROM REGION_WISE_ACH PER\n) RE ON RE.REGION = AL.REGION\n)\nSELECT * FROM REGION_WISE_PERCENTAGE;\n,CALCULATE_COMMISSION AS (\n    SELECT REGION,DD_CODE,  TARGET, HIT,ACH_PER,REGION_ACH_PER,\n    CASE\n        WHEN  ACH_PER >= 111 AND REGION_ACH_PER >=80 THEN HIT*40\n        WHEN  ACH_PER >= 111 THEN HIT*30\n        WHEN  ACH_PER >= 101 THEN HIT*25\n        WHEN  ACH_PER >= 91 THEN HIT*20\n        WHEN  ACH_PER >= 81 THEN HIT*15\n        WHEN  ACH_PER >= 70 THEN HIT*10\n        ELSE 0\n    END COMMISSION\n    FROM REGION_WISE_PERCENTAGE \n)\nSELECT * FROM CALCULATE_COMMISSION;--372  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;--1938125 TAKA\n\nSELECT * FROM TEMP_FOR_DD_DENO_DET1_8AUG24;--372  Rows\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_DENO_DET1_8AUG24;--1938125             1491950 TK\n\n---------------------SETUP-------------\n\nSELECT APP.REPORT_NAME, CT.CHANNELTYPE, APP.CHANNEL_TYPE_ID\nFROM REPORT_APPROVAL APP \nINNER JOIN CHANNELTYPE CT ON CT.CHANNELTYPEID = APP.CHANNEL_TYPE_ID\nWHERE APP.REPORT_NAME = 'Distributor Deno Campaign_7th to 8th Aug24';\n--CHANNEL_TYPE_ID   1\n\n\nEXEC ADHOC_REPORT_SETUP('Distributor Deno Campaign_7th to 8th Aug24', 'Aug_24', 'Aug_24', 1, '7-AUG-24', '8-AUG-24', '', '9-AUG-24');\n\n\n-- 6689 9114 55598\nSELECT * FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Deno Campaign_7th to 8th Aug24';\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Aug_24'; --base month\nSELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS where REPORTID = 6689 and  CYCLEID = 9114;--55598\n\nSELECT * FROM AD_HOC_DATA WHERE REPORT_CYCLE_ID = 55598;\n--delete from ad_hoc_data where REPORT_CYCLE_ID = 55598;\n--commit;\n\nINSERT INTO AD_HOC_DATA (ID, REPORT_CYCLE_ID, CHANNEL_CODE,COMMISSION_AMOUNT)\nSELECT /*+ parallel(16) */  AD_HOC_DATA_ID.nextval id, 55598 REPORT_CYCLE_ID, DD_CODE, COMMISSION\nFROM (\nSELECT * FROM TEMP_FOR_DD_DENO_DET1_8AUG24\n);\nCOMMIT;\n\nSELECT SUM(COMMISSION_AMOUNT) FROM ad_hoc_data where REPORT_CYCLE_ID = 55598; -- 1938125 TAKA\n\n\nEXEC PROC_COMMISSION_DETAIL_SETUP('Distributor Deno Campaign_7th to 8th Aug24',9114,'TEMP_FOR_DD_DENO_DET1_8AUG24','SUMMARY DETAILS');\n\n \nEXEC FINALIZE_REPORT_ADHOC('Distributor Deno Campaign_7th to 8th Aug24', 55598,'Aug_24', 'Aug_24',290, 1);\n\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Deno Campaign_BDT 227_337_14th to 15th Jan25\n\n**Commission Name:** Distributor Deno Campaign_BDT 227_337_14th to 15th Jan25  \n**Start Date:** 14-Jan-2025  \n**End Date:** 15-Jan-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges)\n- **Target:** Distributor will be given Deno HIT targets (provided by B2C).  \n- **Mapping:** Agent list of 15th Jan’25 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno will be considered for performance calculation (Deno List: 227, 337).  \n    - Upon achieving Deno HIT target (Cumulative of DENO), Distributor will be given BDT 20 incentives per HIT (Distributor-wise HIT Target will be shared by B2C).  \n    - Regional top-performing Distributor, based on hit target vs achievement, will receive BDT 3,000 Celebration budget for Endless Victory Campaign.  \n    - Minimum qualifier for celebration budget is 105% target achievement.  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, HIT Target Ach, % Ach, Incentive Amount  \n- **Detail 2:** DD_CODE, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n```  ", "sql": "--TARGET\n--ALTER TABLE TEMP_FOR_DD_DNO_TAR_15_JAN25 RENAME TO TEMP_FOR_DD_DNO_TAR_15_JAN25;\n--DROP TABLE TEMP_FOR_DD_DNO_TAR_15_JAN25;\n\nSELECT * FROM TEMP_FOR_DD_DNO_TAR_15_JAN25;-- 249  Rows\nSELECT DD_CODE, COUNT(DD_CODE) FROM TEMP_FOR_DD_DNO_TAR_15_JAN25 GROUP BY DD_CODE HAVING COUNT(DD_CODE)>1;--0 ROW\n--SELECT * FROM TEMP_FOR_DD_DNO_TAR_15_JAN25 t where t.PARTICIPATION_TARGET <=0;--0 ROW\n--update TEMP_FOR_DD_DNO_TAR_15_JAN25 set DD_CODE = trim(DD_CODE), TARGET = round(TARGET);\n--commit;\n\nselect * from DD_RSO_RET_MAPPING_DAILY;\n------------------AGENT LIST--------------------\n--drop table TEMP_FOR_DDAGENT_DNO_15_JAN25 purge;\n--CREATE TABLE TEMP_FOR_DDAGENT_DNO_15_JAN25 AS\nSELECT /*+ parallel(10) */ DISTINCT\n    TAR.REGION,\n    TAR.DD_CODE,\n--    MAPING.RSO_CODE,\n--    MAPING.RSO_MOBILE,\n    MAPING.RET_CODE,\n    MAPING.RET_MOBILE,\n    --TAR.PARTICIPATION_TARGET,\n--    TAR.INCENTIVE,\n    --TAR.SLAB,\n    TAR.TARGET\nFROM DD_RSO_RET_MAPPING_DAILY MAPING\nINNER JOIN TEMP_FOR_DD_DNO_TAR_15_JAN25 TAR ON MAPING.DD_CODE=TAR.DD_CODE\nWHERE DATA_DATE='15-JAN-25'; --AND PARTICIPATION_TARGET != 0;-- 428069  Rows\nSELECT * FROM TEMP_FOR_DDAGENT_DNO_15_JAN25;-- 428069  Rows\n--1915273989  87                          \n-------------------------------HELPER QUERY------------------------------------\n--drop table TEMP_FOR_DD_EV_DN_DET_14_15JAN25 purge;\n--CREATE TABLE TEMP_FOR_DD_EV_DN_DET_14_15JAN25 AS\nselect * from EV_RECHARGE_COM_DAILY RECHARGE WHERE \n        RECHARGE.TOP_UP_DATE BETWEEN '14-JAN-25' AND '15-JAN-25'; -- 3721356  Rows\nselect * from TEMP_FOR_DD_EV_DN_DET_14_15JAN25; -- 3721356  Rows\n\n--drop table TEMP_FOR_DD_FCS_DN_DET_15_JAN25 purge;\n--CREATE TABLE TEMP_FOR_DD_FCS_DN_DET_15_JAN25 AS\nWITH DD_WISE_ACHIEVEMENT AS (\n    SELECT DD_CODE, COUNT(RECHARGE.RECHARGE_AMOUNT) AS ACH, AG.TARGET,AG.REGION\n    FROM TEMP_FOR_DD_EV_DN_DET_14_15JAN25 RECHARGE\n    INNER JOIN TEMP_FOR_DDAGENT_DNO_15_JAN25 AG \n        ON AG.RET_MOBILE = RECHARGE.RETAILER_MSISDN\n    WHERE RECHARGE.TOP_UP_DATE BETWEEN '14-JAN-25' AND '15-JAN-25'\n        AND RECHARGE.RECHARGE_AMOUNT IN (227,337)\n    GROUP BY DD_CODE, AG.TARGET, AG.REGION\n)\n--select * from DD_WISE_ACHIEVEMENT; -- 244  Rows\n,DD_WISE_PERCENTAGE AS (\n    SELECT ACHIEVEMENT.*, ROUND((ACH / TARGET) * 100) AS ACH_PER\n    FROM DD_WISE_ACHIEVEMENT ACHIEVEMENT\n)\n--select * from DD_WISE_PERCENTAGE; -- 244  Rows\n,DD_RANKED AS (\n    SELECT REGION, DD_CODE, TARGET, ACH, ACH_PER, ROW_NUMBER() OVER (PARTITION BY REGION ORDER BY ACH_PER DESC) AS RN\n    FROM DD_WISE_PERCENTAGE\n)\n--select * from DD_RANKED; -- 244  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE, TARGET, ACH, ACH_PER,\n        CASE\n            WHEN RN = 1 AND ACH_PER >= 105 THEN (ACH * 20) + 3000\n            WHEN ACH_PER >= 100 THEN ACH * 20\n            ELSE 0\n        END AS COMMISSION\n    FROM DD_RANKED\n)\nSELECT * FROM CALCULATE_COMMISSION;-- 244  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;-- 120240\n\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_FCS_DN_DET_15_JAN25;-- 120240 TK\n\nSELECT * FROM TEMP_FOR_DD_FCS_DN_DET_15_JAN25; -- 244  Rows\n\n---------------------MSISDN DETAIL---------------------------\n--DROP TABLE TEMP_FOR_DD_FCS_DN_DET2_15_JAN25 PURGE;\n--CREATE TABLE TEMP_FOR_DD_FCS_DN_DET2_15_JAN25 AS\n SELECT DD_CODE,AG.RET_CODE, RET_MOBILE,RECHARGE.SUB_MSISDN CUSTOMER_MSISDN,RECHARGE.RECHARGE_AMOUNT\n    FROM TEMP_FOR_DD_EV_DN_DET_14_15JAN25 RECHARGE\n    INNER JOIN TEMP_FOR_DDAGENT_DNO_15_JAN25 AG \n    ON AG.RET_MOBILE=RECHARGE.RETAILER_MSISDN\n    WHERE (RECHARGE.TOP_UP_DATE  BETWEEN '14-JAN-25' AND '15-JAN-25') AND RECHARGE.RECHARGE_AMOUNT IN (227,337); -- 11532  Rows\n    \nSELECT * FROM TEMP_FOR_DD_FCS_DN_DET2_15_JAN25;-- 11532  Rows\n    \nSELECT * FROM EV_RECHARGE_COM_DAILY;\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Deno Campaign_BDT 397_497_648_699_798_799_899_998_13th to 14th Aug24\n\n**Commission Name:** Distributor Deno Campaign_BDT 397_497_648_699_798_799_899_998_13th to 14th Aug24  \n**Start Date:** 13-Aug-2024  \n**End Date:** 14-Aug-2024  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges)\n- **Target:** Distributor will be given Deno HIT targets (provided by B2C).  \n- **Mapping:** Agent list of 14th Aug’24 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno will be considered for performance calculation (Deno List: 397, 497, 648, 699, 798, 799, 899, 998).  \n    - Upon achieving Deno HIT target (Cumulative of DENO), Distributor will be given slab-based incentives:  \n        - **70%-80%:** BDT 10 per HIT  \n        - **81%-90%:** BDT 15 per HIT  \n        - **91%-100%:** BDT 20 per HIT  \n        - **101%-109%:** BDT 25 per HIT (BDT 35 for West Cluster and Dhk-West)  \n        - **110% and Above:** BDT 30 per HIT (BDT 40 for West Cluster and Dhk-West)  \n        - **Special Condition:** If the region achieves 90% of its Deno HIT target, 110% and above achievement will receive BDT 40 per HIT.  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n\n**Special Notes:**  \n- DH will be entitled to an additional BDT 10 celebration budget for 110% & above achievement (except West Cluster).  \n- West Cluster will be entitled to a celebration budget for 100% & above achievement.  \n- For payout eligibility, the region must achieve a minimum of 90% of Deno HIT targets; otherwise, no DD of the assigned region will get a celebration budget (except West Cluster and Dhk-West).  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, Deno Ach Count, Commission Amount  \n```", "sql": "-------------------------------HELPER QUERY------------------------------------\n--drop table TEMP_FOR_DENO_CAMP_TAR_14AUG24 purge;\nSELECT * FROM TEMP_FOR_DENO_CAMP_TAR_14AUG24;--375  Rows\nupdate TEMP_FOR_DENO_CAMP_TAR_14AUG24 set DD_CODE = trim(DD_CODE);\ncommit;\n\n--DROP TABLE TEMP_FOR_AG_LIST_MAP_14AUG24 PURGE;\nCREATE TABLE TEMP_FOR_AG_LIST_MAP_14AUG24 AS\nSELECT TAR.*,AG.RETAILER_CODE, AG.TOPUP_MSISDN RET_MSISDN FROM \nTEMP_FOR_DENO_CAMP_TAR_14AUG24 TAR \nINNER JOIN AGENT_LIST_DAILY AG ON AG.DIST_CODE=TAR.DD_CODE AND AG.DATA_DATE = '14-AUG-24';--563663  Rows\n\nSELECT * FROM TEMP_FOR_AG_LIST_MAP_14AUG24;-- 563663  Rows\n\n--DROP TABLE TEMP_FOR_DD_DENO_DET1_14AUG24 PURGE;\nCREATE TABLE TEMP_FOR_DD_DENO_DET1_14AUG24 AS\nWITH RSO_WISE_ACHIEVEMENT AS ( \n    SELECT CLUSTER_NAME,REGION,AG.DD_CODE,AG.TARGET,COUNT(RECHARGE_AMOUNT) HIT\n    FROM TEMP_FOR_AG_LIST_MAP_14AUG24 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '13-AUG-24' AND '14-AUG-24') AND EV.RECHARGE_AMOUNT IN (397,497,648,699,798,799,899,998)\n    GROUP BY AG.DD_CODE,  AG.TARGET,REGION,CLUSTER_NAME\n)\n--SELECT * FROM RSO_WISE_ACHIEVEMENT;--375  Rows\n,RET_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((HIT/TARGET)*100) ACH_PER\nFROM RSO_WISE_ACHIEVEMENT ACHIEVEMENT\n)\n--SELECT * FROM RET_WISE_PERCENTAGE;--375  Rows\n,REGION_WISE_ACH AS (\nSELECT REGION,  SUM(TARGET) REGION_TARGET, SUM(HIT) REGION_HIT\nFROM RSO_WISE_ACHIEVEMENT ACHIEVEMENT\nGROUP BY REGION\n)\n--SELECT * FROM REGION_WISE_ACH;--23  Rows\n,REGION_WISE_PERCENTAGE AS (\nSELECT CLUSTER_NAME,AL.REGION, DD_CODE, TARGET, HIT, ACH_PER ,REGION_ACH_PER\nFROM RET_WISE_PERCENTAGE AL \nINNER JOIN (\nSELECT REGION,ROUND((REGION_HIT/REGION_TARGET)*100) REGION_ACH_PER\nFROM REGION_WISE_ACH PER\n) RE ON RE.REGION = AL.REGION\n)\n--SELECT * FROM REGION_WISE_PERCENTAGE;--375  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT CLUSTER_NAME,REGION,DD_CODE,  TARGET, HIT,ACH_PER,REGION_ACH_PER,\n    CASE\n        WHEN  ACH_PER >= 110 AND REGION_ACH_PER >=90 THEN HIT*40\n        WHEN  ACH_PER >= 110 AND (CLUSTER_NAME = 'West Cluster' OR REGION = 'Dhk-West') THEN HIT*40\n        WHEN  ACH_PER >= 101 AND (CLUSTER_NAME = 'West Cluster' OR REGION = 'Dhk-West') THEN HIT*35\n        WHEN  ACH_PER >= 110  THEN HIT*30\n        WHEN  ACH_PER >= 101 THEN HIT*25\n        WHEN  ACH_PER >= 91 THEN HIT*20\n        WHEN  ACH_PER >= 81 THEN HIT*15\n        WHEN  ACH_PER >= 70 THEN HIT*10\n        ELSE 0\n    END COMMISSION\n    FROM REGION_WISE_PERCENTAGE \n)\nSELECT * FROM CALCULATE_COMMISSION;--375  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;--1787900 TAKA\n\nSELECT * FROM TEMP_FOR_DD_DENO_DET1_14AUG24;--372  Rows\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_DENO_DET1_14AUG24;--1849300             1491950 TK\n\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Deno Campaign_BDT 497_498_648_699_799_899_998_North_North East_20th Aug24\n\n**Commission Name:** Distributor Deno Campaign_BDT 497_498_648_699_799_899_998_North_North East_20th Aug24  \n**Start Date:** 20-Aug-2024  \n**End Date:** 20-Aug-2024  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges) \n- **Target:** Distributor will be given Deno HIT targets (provided by B2C).  \n- **Mapping:** Agent list of 20th Aug’24 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno will be considered for performance calculation (Deno List: 497, 498, 648, 699, 799, 899, 998).  \n    - Upon achieving Deno HIT target (Cumulative of DENO), Distributor will be given BDT 30 per Deno HIT incentive.  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, Deno Ach Count, Commission Amount  \n```", "sql": "-------------------------------HELPER QUERY------------------------------------\n--drop table TEMP_FOR_DENO_CAMP_TAR_20AUG24 purge;\nSELECT * FROM TEMP_FOR_DENO_CAMP_TAR_20AUG24;--375  Rows\nupdate TEMP_FOR_DENO_CAMP_TAR_20AUG24 set DD_CODE = trim(DD_CODE);\ncommit;\n\n--DROP TABLE TEMP_FOR_AG_LIST_MAP_20AUG24 PURGE;\nCREATE TABLE TEMP_FOR_AG_LIST_MAP_20AUG24 AS\nSELECT TAR.*,AG.RETAILER_CODE, AG.TOPUP_MSISDN RET_MSISDN \nFROM TEMP_FOR_DENO_CAMP_TAR_20AUG24 TAR \nINNER JOIN AGENT_LIST_DAILY AG ON AG.DIST_CODE=TAR.DD_CODE AND AG.DATA_DATE = '20-AUG-24';--562930  Rows\n\nSELECT * FROM TEMP_FOR_AG_LIST_MAP_20AUG24;-- 199438  Rows\n\n--DROP TABLE TEMP_FOR_DD_DENO_DET1_20AUG24 PURGE;\nCREATE TABLE TEMP_FOR_DD_DENO_DET1_20AUG24 AS\nWITH RSO_WISE_ACHIEVEMENT AS ( \n    SELECT AG.DD_CODE,AG.TARGET,COUNT(RECHARGE_AMOUNT) HIT\n    FROM TEMP_FOR_AG_LIST_MAP_20AUG24 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '20-AUG-24' AND '20-AUG-24') AND EV.RECHARGE_AMOUNT IN (497,498,648,699,799,899,998)\n    GROUP BY AG.DD_CODE,  AG.TARGET\n)\n--SELECT * FROM RSO_WISE_ACHIEVEMENT;--138  Rows\n,RET_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((HIT/TARGET)*100) ACH_PER\nFROM RSO_WISE_ACHIEVEMENT ACHIEVEMENT\n)\n--SELECT * FROM RET_WISE_PERCENTAGE;--138  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,  TARGET, HIT,ACH_PER,\n    CASE\n        WHEN  ACH_PER >= 100 THEN HIT*30\n        ELSE 0\n    END COMMISSION\n    FROM RET_WISE_PERCENTAGE \n)\nSELECT * FROM CALCULATE_COMMISSION;--375  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;--192930 TAKA\n\nSELECT * FROM TEMP_FOR_DD_DENO_DET1_20AUG24;--138  Rows\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_DENO_DET1_20AUG24;--192930 TK\n\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Deno Campaign_Central Cluster_10th to 17th Feb25\n\n**Commission Name:** Distributor Deno Campaign_Central Cluster_10th to 17th Feb25  \n**Start Date:** 10-Feb-2025  \n**End Date:** 17-Feb-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges)  \n- **Target:** Distributor will be given Deno Recharge targets (provided by B2C).  \n- **Mapping:** Agent list of 17th Feb’25 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno will be considered for performance calculation (Deno List will be shared by B2C).  \n    - Upon achieving Deno Recharge target (Cumulative of DENO), Distributor will be given incentives as per the below slab:  \n        - **100%-109%:** 0.8% of Total Recharge Amount  \n        - **110% and Above:** 0.9% of Total Recharge Amount  \n    - **Bonus Incentive:** If the total Central Cluster achieves 100% Recharge target, then >=100% achiever DDs will get an additional 0.10% bonus incentive on the total Recharge amount on top of their incentive slab.  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target Recharge, Target Ach %, Incentive Amount  \n- **Detail 2:** DD_CODE, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n```", "sql": "-------------------------------HELPER QUERY------------------------------------\n--drop table TEMP_FOR_DN_BB_CAM_TAR_17FEB25 purge;\n--CREATE TABLE TEMP_FOR_DN_BB_CAM_TAR_17FEB25 AS\n--select CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET \n--WHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \n--where REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Deno Campaign_Central Cluster_10th to 17th Feb25') and  \n--CYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Feb_25'));--1278  Rows\n\nSELECT DISTINCT REGION FROM TEMP_FOR_DN_BB_CAM_TAR_17FEB25;--53  Rows\n\nUPDATE TEMP_FOR_DN_BB_CAM_TAR_17FEB25 SET DD_CODE = TRIM(DD_CODE), TARGET = ROUND(TARGET);\nCOMMIT;\n\n--DROP TABLE TEMP_FOR_AGLIST_MAP_17FEB25 PURGE;\nCREATE TABLE TEMP_FOR_AGLIST_MAP_17FEB25 AS\nSELECT TAR.*,AG.RETAILER_CODE, AG.TOPUP_MSISDN RET_MSISDN \nFROM TEMP_FOR_DN_BB_CAM_TAR_17FEB25 TAR \nINNER JOIN AGENT_LIST_DAILY AG ON AG.DIST_CODE=TAR.DD_CODE AND AG.DATA_DATE = '17-FEB-25';--117982  Rows     \n\nSELECT * FROM TEMP_FOR_AGLIST_MAP_17FEB25;--118169  Rows\n\n--DROP TABLE TEMP_FOR_DD_DN_DET1_17FEB25 PURGE;\nCREATE TABLE TEMP_FOR_DD_DN_DET1_17FEB25 AS\nWITH DD_WISE_ACHIEVEMENT AS ( \n    SELECT AG.CLUSTER_TYPE,AG.DD_CODE,AG.TARGET,SUM(RECHARGE_AMOUNT) TOTAL_RECHARGE\n    FROM TEMP_FOR_AGLIST_MAP_17FEB25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '10-FEB-25' AND '16-FEB-25') AND EV.RECHARGE_AMOUNT IN (19,27,34,47,48,57,58,64,69,77,81,96,97,99,104,117,118,127,129,147,148,149,157,167,169\n    ,177,197,198,199,207,209,222,224,227,229,247,248,249,297,298,299,319,337,348,397,398,399,448,497,498,499,548,549,597,599,649,698,699,798,799,897,899,998,1397)\n    AND REGION NOT IN ('Dhk-North')\n    GROUP BY AG.CLUSTER_TYPE,AG.DD_CODE,  AG.TARGET\n    \n    UNION ALL\n    \n    SELECT AG.CLUSTER_TYPE,AG.DD_CODE,AG.TARGET,SUM(RECHARGE_AMOUNT) TOTAL_RECHARGE\n    FROM TEMP_FOR_AGLIST_MAP_17FEB25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '10-FEB-25' AND '17-FEB-25') AND EV.RECHARGE_AMOUNT IN (19,27,34,47,48,57,58,64,69,77,81,96,97,99,104,117,118,127,129,147,148,149,157,167,169\n    ,177,197,198,199,207,209,222,224,227,229,247,248,249,297,298,299,319,337,348,397,398,399,448,497,498,499,548,549,597,599,649,698,699,798,799,897,899,998,1397)\n    AND REGION IN ('Dhk-North')\n    GROUP BY AG.CLUSTER_TYPE,AG.DD_CODE,  AG.TARGET\n)\n--SELECT * FROM DD_WISE_ACHIEVEMENT;--53  Rows\n,DD_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((TOTAL_RECHARGE/TARGET)*100) ACH_PER\nFROM DD_WISE_ACHIEVEMENT ACHIEVEMENT\n)\n--SELECT * FROM DD_WISE_PERCENTAGE;--53  Rows\n,CENTRAL_WISE_PERCENTAGE AS (\nSELECT CLUSTER_TYPE, SUM(TARGET) CENTRAL_TARGET, SUM(TOTAL_RECHARGE) CENTRAL_RECHARGE,ROUND((SUM(TOTAL_RECHARGE)/SUM(TARGET))*100) CLUSTER_ACH_PER\nFROM DD_WISE_ACHIEVEMENT ACHIEVEMENT\nGROUP BY CLUSTER_TYPE\n)\n--SELECT * FROM CENTRAL_WISE_PERCENTAGE;--358  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,  TARGET, TOTAL_RECHARGE,ACH_PER,CLUSTER_ACH_PER,\n    CASE\n        WHEN  ACH_PER >= 110 AND CLUSTER_ACH_PER >= 100 THEN ROUND((TOTAL_RECHARGE*.009)+(TOTAL_RECHARGE*.001))\n        WHEN  ACH_PER >= 110 THEN ROUND(TOTAL_RECHARGE*.009)\n        WHEN  ACH_PER >= 100 AND CLUSTER_ACH_PER >= 100 THEN ROUND((TOTAL_RECHARGE*.008)+(TOTAL_RECHARGE*.001))\n        WHEN  ACH_PER >= 100 THEN ROUND(TOTAL_RECHARGE*.008)\n        ELSE 0\n    END COMMISSION\n    FROM DD_WISE_PERCENTAGE DD\n    LEFT JOIN CENTRAL_WISE_PERCENTAGE CC ON CC.CLUSTER_TYPE = DD.CLUSTER_TYPE\n    \n)\nSELECT * FROM CALCULATE_COMMISSION;--53  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;--353146           353146 TK\n\nSELECT * FROM TEMP_FOR_DD_DN_DET1_17FEB25;--52  Rows\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_DN_DET1_17FEB25;--721337 TK\n\n--SELECT SYSDATE-3 FROM DUAL;\n\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Deno Campaign_Central Cluster_13th Nov24\n\n**Commission Name:** Distributor Deno Campaign_Central Cluster_13th Nov24  \n**Start Date:** 13-Nov-2024  \n**End Date:** 13-Nov-2024  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges) \n- **Target:** Distributor will be given Deno HIT and C2S targets (provided by B2C).  \n- **Mapping:** Agent list of 13th Nov’24 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno will be considered for performance calculation.  \n    - **Deno List:** 497, 597, 648, 699, 798, 799, 998.  \n    - Upon achieving Deno HIT target (Cumulative of DENO), Distributor will be given BDT 30 per HIT incentive.  \n    - If Distributor achieves C2S target, additional incentives will be provided (C2S target and incentives will be shared by B2C).  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n\n**Special Notes:**  \n- Targets and Deno lists will be provided by B2C.  \n\n**Detail formats:**  \n- **Detail 1:** DD Code, HIT Target, Deno HIT Ach Count, Commission Amount, C2S Target, C2S Ach, Incentive Amount  \n```", "sql": "-------------------------------HELPER QUERY------------------------------------\n--drop table TEMP_FOR_DENO_CAMP_TAR_13NOV24 purge;\nSELECT * FROM TEMP_FOR_DENO_CAMP_TAR_13NOV24;--55  Rows\nupdate TEMP_FOR_DENO_CAMP_TAR_13NOV24 set DD_CODE = trim(DD_CODE);\ncommit;\n\n--DROP TABLE TEMP_FOR_AG_LIST_MAP_13NOV24 PURGE;\nCREATE TABLE TEMP_FOR_AG_LIST_MAP_13NOV24 AS\nSELECT TAR.*,AG.RETAILER_CODE, AG.TOPUP_MSISDN RET_MSISDN \nFROM TEMP_FOR_DENO_CAMP_TAR_13NOV24 TAR \nINNER JOIN AGENT_LIST_DAILY AG ON AG.DIST_CODE=TAR.DD_CODE AND AG.DATA_DATE = '13-NOV-24';--118487  Rows    118371  Rows    \n\nSELECT * FROM TEMP_FOR_AG_LIST_MAP_13NOV24;--118487  Rows\n\nCREATE TABLE TEMP_FOR_EV_RECHARGE_13NOV24 AS\nSELECT * FROM EV_RECHARGE_COM_DAILY WHERE (TOP_UP_DATE  BETWEEN '13-NOV-24' AND '13-NOV-24');\n\n--DROP TABLE TEMP_FOR_DD_DENO_DET1_10NOV24 PURGE;\n--CREATE TABLE TEMP_FOR_DD_DENO_DET1_10NOV24 AS\nWITH DD_WISE_ACHIEVEMENT AS ( \n    SELECT AG.DD_CODE,AG.TARGET,COUNT(RECHARGE_AMOUNT) HIT,C2S_TARGET\n    FROM TEMP_FOR_AG_LIST_MAP_13NOV24 AG \n    INNER JOIN TEMP_FOR_EV_RECHARGE_13NOV24 EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '13-NOV-24' AND '13-NOV-24') AND EV.RECHARGE_AMOUNT IN (497, 597, 648, 699, 798, 799, 998)\n    GROUP BY AG.DD_CODE,  AG.TARGET,C2S_TARGET\n)\n--SELECT * FROM DD_WISE_ACHIEVEMENT;--55  Rows\n,DD_WISE_C2S_ACHIEVEMENT AS ( \n    SELECT AG.DD_CODE,AG.TARGET,SUM(RECHARGE_AMOUNT) TOTAL_RECHARGE,C2S_TARGET\n    FROM TEMP_FOR_AG_LIST_MAP_13NOV24 AG \n    INNER JOIN TEMP_FOR_EV_RECHARGE_13NOV24 EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '13-NOV-24' AND '13-NOV-24') --AND EV.RECHARGE_AMOUNT IN (497, 597, 648, 699, 798, 799, 998)\n    GROUP BY AG.DD_CODE,  AG.TARGET,C2S_TARGET\n)\n--SELECT * FROM DD_WISE_C2S_ACHIEVEMENT;--55  Rows\n,DD_WISE_TOTAL_ACH AS (\nSELECT HIT.*,TOTAL_RECHARGE\nFROM DD_WISE_C2S_ACHIEVEMENT C2S \nLEFT JOIN DD_WISE_ACHIEVEMENT HIT ON HIT.DD_CODE = C2S.DD_CODE\n)\n--SELECT * FROM DD_WISE_TOTAL_ACH;--55  Rows\n,DD_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((HIT/TARGET)*100) ACH_PER,ROUND((TOTAL_RECHARGE/C2S_TARGET)*100) C2S_ACH_PER\nFROM DD_WISE_TOTAL_ACH ACHIEVEMENT\n)\nSELECT * FROM DD_WISE_PERCENTAGE;--367  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,  TARGET, HIT,ACH_PER,\n    CASE\n        WHEN  ACH_PER >= 100 AND C2S_ACH_PER >= 100 THEN (HIT*30)+\n        ELSE 0\n    END COMMISSION\n    FROM DD_WISE_PERCENTAGE \n)\nSELECT * FROM CALCULATE_COMMISSION;--367  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;--499165 TAKA\n\nSELECT * FROM TEMP_FOR_DD_DENO_DET1_10NOV24;--367  Rows\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_DENO_DET1_10NOV24;--499165 TK\n\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Deno Campaign_Central Cluster_1st to 9th Feb25\n\n**Commission Name:** Distributor Deno Campaign_Central Cluster_1st to 9th Feb25  \n**Start Date:** 1-Feb-2025  \n**End Date:** 9-Feb-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges) \n- **Target:** Distributor will be given Deno Recharge targets (provided by B2C).  \n- **Mapping:** Agent list of 9th Feb’25 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno will be considered for performance calculation (Deno List will be shared by B2C).  \n    - Upon achieving Deno Recharge target (Cumulative of DENO), Distributor will be given slab-based incentives:  \n        - **100%-109%:** 0.8% of Total Recharge Amount  \n        - **110% and Above:** 1% of Total Recharge Amount  \n        - **Additional Bonus:** If the Total Central Cluster achieves 100% Recharge target, >=100% achiever DDs will get an additional 0.15% bonus incentive on the total Recharge amount on top of their incentive slab.  \n        - Example: >=100% achievers get 0.8%+0.15%, >=110% achievers get 1%+0.15%.  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n\n**Special Notes:**  \n- Bonus incentive applies only if the Total Central Cluster achieves 100% Recharge target.  \n- Targets and Deno lists will be provided by B2C.  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target Recharge, Target Ach %, Incentive Amount  \n- **Detail 2:** DD_CODE, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n```", "sql": "--TARGET\n--ALTER TABLE TEMP_FOR_DD_TAR_1_9FEB25 RENAME TO TEMP_FOR_DD_TAR_1_9FEB25;\n--DROP TABLE TEMP_FOR_DD_TAR_1_9FEB25 purge;\n\nSELECT * FROM TEMP_FOR_DD_TAR_1_9FEB25; -- 52  Rows\n\nCREATE TABLE TEMP_FOR_DD_TAR_1_9FEB25 AS\nselect CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET \nWHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \nwhere REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Deno Campaign_Central Cluster_1st to 9th Feb25') and  \nCYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Feb_25'));\n\n--update TEMP_FOR_DD_TAR_1_9FEB25 set DD_CODE = trim(DD_CODE),TARGET = round(TARGET);\n--commit;\nselect * from DD_RSO_RET_MAPPING_DAILY;\n------------------AGENT LIST--------------------\n--drop table TEMP_FOR_DDAGENT_1_9_FEB25 purge;\nCREATE TABLE TEMP_FOR_DDAGENT_1_9_FEB25 AS\nSELECT /*+ parallel(10) */ DISTINCT\n    TAR.DD_CODE,\n--    MAPING.RSO_CODE,\n--    MAPING.RSO_MOBILE,\n    MAPING.RET_CODE,\n    MAPING.RET_MOBILE,\n    --TAR.PARTICIPATION_TARGET,\n    --TAR.SLAB,\n    TAR.TARGET\n--    TAR.INCENTIVE\nFROM DD_RSO_RET_MAPPING_DAILY MAPING\nINNER JOIN TEMP_FOR_DD_TAR_1_9FEB25 TAR ON MAPING.DD_CODE=TAR.DD_CODE\nWHERE DATA_DATE='9-FEB-25'; --AND PARTICIPATION_TARGET != 0;-- 32299  Rows\nSELECT * FROM TEMP_FOR_DDAGENT_1_9_FEB25;-- 118197  Rows\n--1915273989  87                          \n-------------------------------HELPER QUERY------------------------------------\n--drop table TEMP_FOR_DD_EV_DET_1_9FEB25 purge;\nCREATE TABLE TEMP_FOR_DD_EV_DET_1_9FEB25 AS\nselect * from EV_RECHARGE_COM_DAILY RECHARGE WHERE \n        RECHARGE.TOP_UP_DATE BETWEEN '1-FEB-25' AND '9-FEB-25'; -- 16719452  Rows\nselect * from TEMP_FOR_DD_EV_DET_1_9FEB25; -- 16719452  Rows\n\n--drop table TEMP_FOR_DD_FCS_DET_1_9FEB25 purge;\nCREATE TABLE TEMP_FOR_DD_FCS_DET_1_9FEB25 AS\nWITH DD_WISE_ACHIEVEMENT AS (\n    SELECT DD_CODE,SUM(RECHARGE.RECHARGE_AMOUNT) ACH,AG.TARGET\n    FROM TEMP_FOR_DD_EV_DET_1_9FEB25 RECHARGE\n    INNER JOIN TEMP_FOR_DDAGENT_1_9_FEB25 AG \n        ON AG.RET_MOBILE = RECHARGE.RETAILER_MSISDN\n    WHERE RECHARGE.TOP_UP_DATE BETWEEN '1-FEB-25' AND '9-FEB-25'\n        AND RECHARGE.RECHARGE_AMOUNT IN \n        (\n        58,69,96,99,118,129,149,169,199,209,229,249,299,399,499,549,599,649,699,\n799,899,48,81,104,148,198,222,224,248,298,348,398,448,498,548,698,798,998,\n19,27,34,47,57,64,77,97,117,127,147,157,167,177,\n197,207,227,247,297,337,397,497,597,897,1397\n        )\n    GROUP BY DD_CODE,AG.TARGET\n)\n--SELECT * FROM DD_WISE_ACHIEVEMENT; -- 52  Rows\n,DD_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((ACH/TARGET)*100) ACH_PER\nFROM DD_WISE_ACHIEVEMENT ACHIEVEMENT\n)\n--SELECT * FROM DD_WISE_PERCENTAGE;-- 52  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT \n        DD_CODE,\n        TARGET,\n        ACH,\n        ACH_PER,\n        ROUND(\n            CASE\n                WHEN ACH_PER >= 110 THEN (0.01 * ACH) + (0.0015 * ACH)\n                WHEN ACH_PER >= 100 THEN (0.008 * ACH) + (0.0015 * ACH)\n                ELSE 0\n            END \n        ) AS COMMISSION\n    FROM DD_WISE_PERCENTAGE\n)\nSELECT * FROM CALCULATE_COMMISSION;--  52  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;-- 1067453\n\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_FCS_DET_1_9FEB25;--1067453 TK\n\nSELECT * FROM TEMP_FOR_DD_FCS_DET_1_9FEB25; -- 52  Rows\n\n---------------------MSISDN DETAIL---------------------------\n--DROP TABLE TEMP_FOR_DD_FCS_DET2_1_9FEB25 PURGE;\nCREATE TABLE TEMP_FOR_DD_FCS_DET2_1_9FEB25 AS\n SELECT DD_CODE,AG.RET_CODE, RET_MOBILE,RECHARGE.SUB_MSISDN CUSTOMER_MSISDN,RECHARGE.RECHARGE_AMOUNT\n    FROM TEMP_FOR_DD_EV_DET_1_9FEB25 RECHARGE\n    INNER JOIN TEMP_FOR_DDAGENT_1_9_FEB25 AG \n    ON AG.RET_MOBILE=RECHARGE.RETAILER_MSISDN\n    WHERE (RECHARGE.TOP_UP_DATE  BETWEEN '1-FEB-25' AND '9-FEB-25') \n    AND RECHARGE.RECHARGE_AMOUNT IN (58,69,96,99,118,129,149,169,199,209,229,249,299,399,499,549,599,649,699,\n799,899,48,81,104,148,198,222,224,248,298,348,398,448,498,548,698,798,998,\n19,27,34,47,57,64,77,97,117,127,147,157,167,177,\n197,207,227,247,297,337,397,497,597,897,1397);-- 562334  Rows\n    \nSELECT * FROM TEMP_FOR_DD_FCS_DET2_1_9FEB25;-- 562334  Rows\n    \nSELECT * FROM EV_RECHARGE_COM_DAILY;\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Deno Campaign_Central Cluster_BDT_498_548_549_10th to 15th Feb25\n\n**Commission Name:** Distributor Deno Campaign_Central Cluster_BDT_498_548_549_10th to 15th Feb25  \n**Start Date:** 10-Feb-2025  \n**End Date:** 15-Feb-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges)\n- **Target:** Distributor will be given Deno HIT targets (provided by B2C).  \n- **Mapping:** Agent list of 15th Feb’25 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno (498, 548, 549) will be considered for performance calculation.  \n    - Upon achieving Deno HIT target (Cumulative of DENO), Distributor will be given incentives as per the below slab:  \n        - **100% and Above:** BDT 50 per HIT  \n        - **90%-99%:** BDT 40 per HIT  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target HIT, Target Ach %, Incentive Amount  \n- **Detail 2:** DD_CODE, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n```", "sql": "-------------------------------HELPER QUERY------------------------------------\n-- 7451 9574 61612\n\n--create table TEMP_FOR_DENO_CAMP_TAR_15_FEB25 as\nselect CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET \nWHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \nwhere REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Deno Campaign_Central Cluster_BDT_498_548_549_10th to 15th Feb25') and  \nCYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Feb_25'));--355  Rows\n\nSELECT * FROM TEMP_FOR_DENO_CAMP_TAR_15_FEB25;--52  Rows\n\n--DROP TABLE TEMP_FOR_AG_LIST_MAP_15_FEB25 PURGE;\nCREATE TABLE TEMP_FOR_AG_LIST_MAP_15_FEB25 AS\nSELECT TAR.*,AG.RET_CODE RETAILER_CODE, AG.RET_MOBILE RET_MSISDN \nFROM TEMP_FOR_DENO_CAMP_TAR_15_FEB25 TAR \nINNER JOIN DD_RSO_RET_MAPPING_DAILY AG ON AG.DD_CODE=TAR.DD_CODE AND AG.DATA_DATE = '15-FEB-25';--118276  Rows \n\nSELECT * FROM TEMP_FOR_AG_LIST_MAP_15_FEB25;-- 118276  Rows\nSELECT * FROM EV_RECHARGE_COM_DAILY;\n\n--DROP TABLE TEMP_FOR_DD_DENO_DET_15_FEB25 PURGE;\nCREATE TABLE TEMP_FOR_DD_DENO_DET_15_FEB25 AS\nWITH RSO_WISE_ACHIEVEMENT AS ( \n    SELECT AG.DD_CODE,AG.TARGET,COUNT(RECHARGE_AMOUNT) HIT\n    FROM TEMP_FOR_AG_LIST_MAP_15_FEB25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '10-FEB-25' AND '15-FEB-25') AND EV.RECHARGE_AMOUNT IN (498,548,549)\n--    AND SERVICE_CLASS_ID NOT IN (141) \n--    AND NOT EXISTS(SELECT MOBILENO FROM VW_EMPLOYEESALESCOM_MONTHLY VE WHERE VE.DATE_DATE='1-JAN-24' AND VE.MOBILENO=EV.SUB_MSISDN)\n    GROUP BY AG.DD_CODE,  AG.TARGET\n)\n--SELECT * FROM RSO_WISE_ACHIEVEMENT;--52  Rows\n,RET_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((HIT/TARGET)*100) ACH_PER\nFROM RSO_WISE_ACHIEVEMENT ACHIEVEMENT\n)\n--SELECT * FROM RET_WISE_PERCENTAGE;--52  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,  TARGET, HIT,ACH_PER,\n    CASE\n        WHEN  ACH_PER >= 100 THEN HIT*50\n        WHEN  ACH_PER >= 90 THEN HIT*40\n        ELSE 0\n    END COMMISSION\n    FROM RET_WISE_PERCENTAGE \n)\nSELECT * FROM CALCULATE_COMMISSION;--354  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;--763300        308025   TAKA\n\nSELECT * FROM TEMP_FOR_DD_DENO_DET_15_FEB25;--354  Rows\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_DENO_DET_15_FEB25;--763300            408575 TK\n\n-------------DETAIL------------\n\n--DROP TABLE TEMP_FOR_DD_DENO_DET2_15_FEB25 PURGE;\nCREATE TABLE TEMP_FOR_DD_DENO_DET2_15_FEB25 AS\nWITH DD_WISE_ACHIEVEMENT AS ( \n    SELECT AG.DD_CODE,RETAILER_CODE,RET_MSISDN,SUB_MSISDN CUSTOMER_MSISDN,RECHARGE_AMOUNT--AG.TARGET,COUNT(RECHARGE_AMOUNT) HIT\n    FROM TEMP_FOR_AG_LIST_MAP_15_FEB25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '10-FEB-25' AND '15-FEB-25') AND EV.RECHARGE_AMOUNT IN (498,548,549)\n--    AND SERVICE_CLASS_ID NOT IN (141) \n--    AND NOT EXISTS(SELECT MOBILENO FROM VW_EMPLOYEESALESCOM_MONTHLY VE WHERE VE.DATE_DATE='1-JAN-24' AND VE.MOBILENO=EV.SUB_MSISDN)\n)\nSELECT * FROM DD_WISE_ACHIEVEMENT;--15446  Rows\n\nselect * from TEMP_FOR_DD_DENO_DET2_15_FEB25;--15446  Rows"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Deno Campaign_East Cluster_SYL_15th to 21st Jan25\n\n**Commission Name:** Distributor Deno Campaign_East Cluster_SYL_15th to 21st Jan25  \n**Start Date:** 15-Jan-2025  \n**End Date:** 21-Jan-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges)  \n- **Target:** Distributor will be given Deno HIT targets (provided by B2C).  \n- **Mapping:** Agent list of 21st Jan’25 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno will be considered for performance calculation.  \n    - **Deno List:** 398, 399, 448.  \n    - Upon achieving Deno HIT target (Cumulative of DENO), Distributor will be given BDT 60 per HIT incentive.  \n    - Upon achieving 90% to 99% Deno HIT target (Cumulative of DENO), Distributor will be given BDT 50 per HIT incentive.  \n    - More than 6 Hits by any retailer in a single day will be discarded from achievement.  \n    - Incentives capped up to 150% achievement.  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n\n**Detail formats:**  \n- **Detail 1:** DD Code, HIT Target, Deno HIT Ach Count, Commission Amount  \n```", "sql": "--drop table TEMP_FOR_DD_FCS_TAR_15_21JAN25 purge;\nSELECT * FROM TEMP_FOR_DD_FCS_TAR_15_21JAN25;-- 74  Rows\nSELECT DD_CODE, COUNT(DD_CODE) FROM TEMP_FOR_DD_FCS_TAR_15_21JAN25 GROUP BY DD_CODE HAVING COUNT(DD_CODE)>1;-- 68  Rows\n--SELECT * FROM TEMP_FOR_DD_FCS_TAR_15_21JAN25 t where t.PARTICIPATION_TARGET <=0;--0 ROW\nupdate TEMP_FOR_DD_FCS_TAR_15_21JAN25 set DD_CODE = trim(DD_CODE);\ncommit;\n\nselect * from DD_RSO_RET_MAPPING_DAILY;\n------------------AGENT LIST--------------------\n-- drop table TEMP_FOR_DDAGENT_15_21JAN25 purge;\n--CREATE TABLE TEMP_FOR_DDAGENT_15_21JAN25 AS\nSELECT /*+ parallel(10) */ DISTINCT\n    TAR.DD_CODE,\n    MAPING.RET_CODE,\n    MAPING.RET_MOBILE,\n    --TAR.PARTICIPATION_TARGET,\n--    TAR.INCENTIVE,\n    --TAR.SLAB,\n    TAR.TARGET\nFROM DD_RSO_RET_MAPPING_DAILY MAPING\nINNER JOIN TEMP_FOR_DD_FCS_TAR_15_21JAN25 TAR ON MAPING.DD_CODE=TAR.DD_CODE\nWHERE DATA_DATE='21-JAN-25'; --AND PARTICIPATION_TARGET != 0; -- 148491  Rows\nSELECT * FROM TEMP_FOR_DDAGENT_15_21JAN25;-- 130150  Rows\n--1915273989  87                          \n-------------------------------HELPER QUERY------------------------------------\n-- drop table TEMP_FOR_DD_EV_DET_15_21_JAN25 purge;\n CREATE TABLE TEMP_FOR_DD_EV_DET_15_21_JAN25 AS\nselect * from EV_RECHARGE_COM_DAILY RECHARGE WHERE \n        RECHARGE.TOP_UP_DATE BETWEEN '15-JAN-25' AND '21-JAN-25'; -- 11986605  Rows\nselect * from TEMP_FOR_DD_EV_DET_15_21_JAN25; -- 12923471  Rows\n\n--drop table TEMP_FOR_DD_FCS_DET_15_21JAN25 purge;\nCREATE TABLE TEMP_FOR_DD_FCS_DET_15_21JAN25 AS\nWITH RSO_WISE_ACHIEVEMENT AS (\n    SELECT DD_CODE,RET_MOBILE,AG.TARGET,TOP_UP_DATE,\n    CASE WHEN COUNT(RECHARGE.RECHARGE_AMOUNT) >=6 THEN 6 ELSE COUNT(RECHARGE.RECHARGE_AMOUNT) END AS ACH\n    FROM EV_RECHARGE_COM_DAILY RECHARGE\n    INNER JOIN TEMP_FOR_DDAGENT_15_21JAN25 AG \n        ON AG.RET_MOBILE = RECHARGE.RETAILER_MSISDN\n    WHERE RECHARGE.TOP_UP_DATE BETWEEN '15-JAN-25' AND '21-JAN-25'\n        AND RECHARGE.RECHARGE_AMOUNT IN (398,399,448)\n    GROUP BY DD_CODE,AG.TARGET,RET_MOBILE,TOP_UP_DATE\n)\n--SELECT * FROM RSO_WISE_ACHIEVEMENT; -- 25173  Rows\n,DD_WISE_ACH AS (\nSELECT DD_CODE, TARGET,SUM(ACH) ACH\nFROM RSO_WISE_ACHIEVEMENT\nGROUP BY DD_CODE, TARGET\n)\n--SELECT * FROM DD_WISE_ACH;\n,RSO_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((ACH/TARGET)*100) ACH_PER\nFROM DD_WISE_ACH ACHIEVEMENT\n)\n--SELECT * FROM RSO_WISE_PERCENTAGE;-- 68  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,TARGET,ACH,ACH_PER, \n    CASE\n        WHEN ACH_PER >= 150  THEN ((TARGET * 1.5) * 60)\n--        WHEN ACH_PER >= 150 THEN (ACH * 70) + CELEBRATION_BUDGET\n        WHEN ACH_PER >= 100 THEN (ACH * 60) \n        WHEN ACH_PER >= 90 THEN ACH * 50\n        ELSE 0\n    END COMMISSION\n    FROM RSO_WISE_PERCENTAGE\n)\nSELECT * FROM CALCULATE_COMMISSION;-- 111  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;-- 802080 TAKA\n\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_FCS_DET_15_21JAN25;--802080 TK\n\nSELECT * FROM TEMP_FOR_DD_FCS_DET_15_21JAN25; --73  Rows\n\n---------------------MSISDN DETAIL---------------------------\n--DROP TABLE TEMP_FOR_DD_FCS_DET2_15_21JAN25 PURGE;\nCREATE TABLE TEMP_FOR_DD_FCS_DET2_15_21JAN25 AS\n SELECT DD_CODE,AG.RET_CODE, RET_MOBILE,RECHARGE.SUB_MSISDN CUSTOMER_MSISDN,RECHARGE.RECHARGE_AMOUNT\n    FROM TEMP_FOR_DD_EV_DET_15_21_JAN25 RECHARGE\n    INNER JOIN TEMP_FOR_DDAGENT_15_21JAN25 AG \n    ON AG.RET_MOBILE=RECHARGE.RETAILER_MSISDN\n    WHERE (RECHARGE.TOP_UP_DATE  BETWEEN '15-JAN-25' AND '21-JAN-25') AND RECHARGE.RECHARGE_AMOUNT IN (398,399,448);-- 30395  Rows\n    \nSELECT * FROM TEMP_FOR_DD_FCS_DET2_15_21JAN25;-- 30395  Rows\n    \nSELECT * FROM EV_RECHARGE_COM_DAILY;\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Deno Campaign_West Cluster_14th to 21st Jan25\n\n**Commission Name:** Distributor Deno Campaign_West Cluster_14th to 21st Jan25  \n**Start Date:** 14-Jan-2025  \n**End Date:** 21-Jan-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges)\n- **Target:** Distributor will be given Deno HIT targets (provided by B2C).  \n- **Mapping:** Agent list of 21st Jan’25 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno (177, 197, 227, 297) will be considered for performance calculation.  \n    - Upon achieving Deno HIT target (Cumulative of DENO), Distributor will be given BDT 30 incentives per HIT.  \n    - More than 7 Hits by any retailer in a single day will be discarded from achievement.  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n    - Additional celebration budget of BDT 3,000 will be provided to top-performing DD per region upon achieving 102% target.  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target HIT, Target Ach %, Incentive Amount  \n- **Detail 2:** DD_CODE, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n```S", "sql": "--TARGET\n--ALTER TABLE TEMP_FOR_DD_DNO_TAR_15_JAN25 RENAME TO TEMP_FOR_DD_DNO_TAR_15_JAN25;\n--DROP TABLE TEMP_FOR_DD_DNO_TAR_15_JAN25;\n\nSELECT * FROM TEMP_FOR_DD_DNO_TAR_15_JAN25;-- 249  Rows\nSELECT DD_CODE, COUNT(DD_CODE) FROM TEMP_FOR_DD_DNO_TAR_15_JAN25 GROUP BY DD_CODE HAVING COUNT(DD_CODE)>1;--0 ROW\n--SELECT * FROM TEMP_FOR_DD_DNO_TAR_15_JAN25 t where t.PARTICIPATION_TARGET <=0;--0 ROW\n--update TEMP_FOR_DD_DNO_TAR_15_JAN25 set DD_CODE = trim(DD_CODE), TARGET = round(TARGET);\n--commit;\n\nselect * from DD_RSO_RET_MAPPING_DAILY;\n------------------AGENT LIST--------------------\n--drop table TEMP_FOR_DDAGENT_DNO_15_JAN25 purge;\n--CREATE TABLE TEMP_FOR_DDAGENT_DNO_15_JAN25 AS\nSELECT /*+ parallel(10) */ DISTINCT\n    TAR.REGION,\n    TAR.DD_CODE,\n--    MAPING.RSO_CODE,\n--    MAPING.RSO_MOBILE,\n    MAPING.RET_CODE,\n    MAPING.RET_MOBILE,\n    --TAR.PARTICIPATION_TARGET,\n--    TAR.INCENTIVE,\n    --TAR.SLAB,\n    TAR.TARGET\nFROM DD_RSO_RET_MAPPING_DAILY MAPING\nINNER JOIN TEMP_FOR_DD_DNO_TAR_15_JAN25 TAR ON MAPING.DD_CODE=TAR.DD_CODE\nWHERE DATA_DATE='15-JAN-25'; --AND PARTICIPATION_TARGET != 0;-- 428069  Rows\nSELECT * FROM TEMP_FOR_DDAGENT_DNO_15_JAN25;-- 428069  Rows\n--1915273989  87                          \n-------------------------------HELPER QUERY------------------------------------\n--drop table TEMP_FOR_DD_EV_DN_DET_14_15JAN25 purge;\n--CREATE TABLE TEMP_FOR_DD_EV_DN_DET_14_15JAN25 AS\nselect * from EV_RECHARGE_COM_DAILY RECHARGE WHERE \n        RECHARGE.TOP_UP_DATE BETWEEN '14-JAN-25' AND '15-JAN-25'; -- 3721356  Rows\nselect * from TEMP_FOR_DD_EV_DN_DET_14_15JAN25; -- 3721356  Rows\n\n--drop table TEMP_FOR_DD_FCS_DN_DET_15_JAN25 purge;\n--CREATE TABLE TEMP_FOR_DD_FCS_DN_DET_15_JAN25 AS\nWITH DD_WISE_ACHIEVEMENT AS (\n    SELECT DD_CODE, COUNT(RECHARGE.RECHARGE_AMOUNT) AS ACH, AG.TARGET,AG.REGION\n    FROM TEMP_FOR_DD_EV_DN_DET_14_15JAN25 RECHARGE\n    INNER JOIN TEMP_FOR_DDAGENT_DNO_15_JAN25 AG \n        ON AG.RET_MOBILE = RECHARGE.RETAILER_MSISDN\n    WHERE RECHARGE.TOP_UP_DATE BETWEEN '14-JAN-25' AND '15-JAN-25'\n        AND RECHARGE.RECHARGE_AMOUNT IN (227,337)\n    GROUP BY DD_CODE, AG.TARGET, AG.REGION\n)\n--select * from DD_WISE_ACHIEVEMENT; -- 244  Rows\n,DD_WISE_PERCENTAGE AS (\n    SELECT ACHIEVEMENT.*, ROUND((ACH / TARGET) * 100) AS ACH_PER\n    FROM DD_WISE_ACHIEVEMENT ACHIEVEMENT\n)\n--select * from DD_WISE_PERCENTAGE; -- 244  Rows\n,DD_RANKED AS (\n    SELECT REGION, DD_CODE, TARGET, ACH, ACH_PER, ROW_NUMBER() OVER (PARTITION BY REGION ORDER BY ACH_PER DESC) AS RN\n    FROM DD_WISE_PERCENTAGE\n)\n--select * from DD_RANKED; -- 244  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE, TARGET, ACH, ACH_PER,\n        CASE\n            WHEN RN = 1 AND ACH_PER >= 105 THEN (ACH * 20) + 3000\n            WHEN ACH_PER >= 100 THEN ACH * 20\n            ELSE 0\n        END AS COMMISSION\n    FROM DD_RANKED\n)\nSELECT * FROM CALCULATE_COMMISSION;-- 244  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;-- 120240\n\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_FCS_DN_DET_15_JAN25;-- 120240 TK\n\nSELECT * FROM TEMP_FOR_DD_FCS_DN_DET_15_JAN25; -- 244  Rows\n\n---------------------MSISDN DETAIL---------------------------\n--DROP TABLE TEMP_FOR_DD_FCS_DN_DET2_15_JAN25 PURGE;\n--CREATE TABLE TEMP_FOR_DD_FCS_DN_DET2_15_JAN25 AS\n SELECT DD_CODE,AG.RET_CODE, RET_MOBILE,RECHARGE.SUB_MSISDN CUSTOMER_MSISDN,RECHARGE.RECHARGE_AMOUNT\n    FROM TEMP_FOR_DD_EV_DN_DET_14_15JAN25 RECHARGE\n    INNER JOIN TEMP_FOR_DDAGENT_DNO_15_JAN25 AG \n    ON AG.RET_MOBILE=RECHARGE.RETAILER_MSISDN\n    WHERE (RECHARGE.TOP_UP_DATE  BETWEEN '14-JAN-25' AND '15-JAN-25') AND RECHARGE.RECHARGE_AMOUNT IN (227,337); -- 11532  Rows\n    \nSELECT * FROM TEMP_FOR_DD_FCS_DN_DET2_15_JAN25;-- 11532  Rows\n    \nSELECT * FROM EV_RECHARGE_COM_DAILY;\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Deno Campaign_West Cluster_8th to 18th Jan25\n\n**Commission Name:** Distributor Deno Campaign_West Cluster_8th to 18th Jan25  \n**Start Date:** 8-Jan-2025  \n**End Date:** 18-Jan-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges) \n- **Target:** Distributor will be given Deno HIT targets (provided by B2C).  \n- **Mapping:** Agent list of 18th Jan’25 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno (498, 548) will be considered for performance calculation.  \n    - Upon achieving Deno HIT target (Cumulative of DENO), Distributor will be given incentives as per the below slab:  \n        - **100% and Above:** BDT 70 per HIT  \n        - **90%-99%:** BDT 60 per HIT  \n    - More than 5 Hits by any retailer in a single day will be discarded from achievement.  \n    - Incentives are capped up to 300%.  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n    - Additional celebration budget will be provided upon achieving 150% against the target (details shared by B2C).  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target HIT, Target Ach %, Incentive Amount  \n- **Detail 2:** DD_CODE, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n```", "sql": "--TARGET\n--ALTER TABLE TEMP_FOR_DD_FCS_TAR_18JAN24 RENAME TO TEMP_FOR_DD_FCS_TAR_18JAN24;\n--drop table TEMP_FOR_DD_FCS_TAR_18JAN24 purge;\n\nSELECT * FROM TEMP_FOR_DD_FCS_TAR_18JAN24;-- 113  Rows\nSELECT DD_CODE, COUNT(DD_CODE) FROM TEMP_FOR_DD_FCS_TAR_18JAN24 GROUP BY DD_CODE HAVING COUNT(DD_CODE)>1;-- 68  Rows\n--SELECT * FROM TEMP_FOR_DD_FCS_TAR_18JAN24 t where t.PARTICIPATION_TARGET <=0;--0 ROW\nupdate TEMP_FOR_DD_FCS_TAR_18JAN24 set DD_CODE = trim(DD_CODE);\ncommit;\n\n--UPDATE TEMP_FOR_DD_FCS_TAR_18JAN24 SET DD_CODE = TRIM(DD_CODE), TARGET = ROUND(TARGET);\n--COMMIT;\n\n\nselect * from DD_RSO_RET_MAPPING_DAILY;\n------------------AGENT LIST--------------------\n drop table TEMP_FOR_DDAGENT_18DEC24 purge;\nCREATE TABLE TEMP_FOR_DDAGENT_18DEC24 AS\nSELECT /*+ parallel(10) */ DISTINCT\n    TAR.DD_CODE,\n    MAPING.RET_CODE,\n    MAPING.RET_MOBILE,\n    --TAR.PARTICIPATION_TARGET,\n--    TAR.INCENTIVE,\n    --TAR.SLAB,\n    TAR.TARGET,CELEBRATION_BUDGET\nFROM DD_RSO_RET_MAPPING_DAILY MAPING\nINNER JOIN TEMP_FOR_DD_FCS_TAR_18JAN24 TAR ON MAPING.DD_CODE=TAR.DD_CODE\nWHERE DATA_DATE='18-JAN-25'; --AND PARTICIPATION_TARGET != 0; -- 148491  Rows\nSELECT * FROM TEMP_FOR_DDAGENT_18DEC24;-- 115258  Rows\n--1915273989  87                          \n-------------------------------HELPER QUERY------------------------------------\n-- drop table TEMP_FOR_DD_EV_DET_18_JAN25 purge;\n CREATE TABLE TEMP_FOR_DD_EV_DET_18_JAN25 AS\nselect * from EV_RECHARGE_COM_DAILY RECHARGE WHERE \n        RECHARGE.TOP_UP_DATE BETWEEN '8-JAN-25' AND '18-JAN-25'; -- 11986605  Rows\nselect * from TEMP_FOR_DD_EV_DET_18_JAN25; -- 11986605  Rows\n\n--drop table TEMP_FOR_DD_FCS_DET_18_JAN24 purge;\n--CREATE TABLE TEMP_FOR_DD_FCS_DET_18_JAN24 AS\nWITH RSO_WISE_ACHIEVEMENT AS (\n    SELECT DD_CODE,RET_MOBILE,AG.TARGET,TOP_UP_DATE,\n    CASE WHEN COUNT(RECHARGE.RECHARGE_AMOUNT) >=5 THEN 5 ELSE COUNT(RECHARGE.RECHARGE_AMOUNT) END AS ACH,CELEBRATION_BUDGET\n    FROM TEMP_FOR_DD_EV_DET_18_JAN25 RECHARGE\n    INNER JOIN TEMP_FOR_DDAGENT_18DEC24 AG \n        ON AG.RET_MOBILE = RECHARGE.RETAILER_MSISDN\n    WHERE RECHARGE.TOP_UP_DATE BETWEEN '8-JAN-25' AND '18-JAN-25'\n        AND RECHARGE.RECHARGE_AMOUNT IN (498,548)\n    GROUP BY DD_CODE,AG.TARGET,RET_MOBILE,TOP_UP_DATE,CELEBRATION_BUDGET\n)\n--SELECT * FROM RSO_WISE_ACHIEVEMENT; -- 25173  Rows\n,DD_WISE_ACH AS (\nSELECT DD_CODE, TARGET,SUM(ACH) ACH,CELEBRATION_BUDGET\nFROM RSO_WISE_ACHIEVEMENT\nGROUP BY DD_CODE, TARGET,CELEBRATION_BUDGET\n)\n--SELECT * FROM DD_WISE_ACH;\n,RSO_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((ACH/TARGET)*100) ACH_PER\nFROM DD_WISE_ACH ACHIEVEMENT\n)\nSELECT * FROM RSO_WISE_PERCENTAGE;-- 68  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,TARGET,ACH,ACH_PER, \n    CASE\n        WHEN ACH_PER >= 300  THEN ((TARGET * 3) * 70)+ CELEBRATION_BUDGET\n        WHEN ACH_PER >= 150 THEN (ACH * 70) + CELEBRATION_BUDGET\n        WHEN ACH_PER >= 100 THEN (ACH * 70) \n        WHEN ACH_PER >= 90 THEN ACH * 60\n        ELSE 0\n    END COMMISSION\n    FROM RSO_WISE_PERCENTAGE\n)\nSELECT * FROM CALCULATE_COMMISSION;-- 111  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;-- 802080 TAKA\n\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_FCS_DET_18_JAN24;--802080 TK\n\nSELECT * FROM TEMP_FOR_DD_FCS_DET_18_JAN24; --111  Rows\n\n---------------------MSISDN DETAIL---------------------------\n--DROP TABLE TEMP_FOR_DD_FCS_DET2_7_DEC24 PURGE;\n--CREATE TABLE TEMP_FOR_DD_FCS_DET2_7_DEC24 AS\n-- SELECT DD_CODE,AG.RET_CODE, RET_MOBILE,RECHARGE.SUB_MSISDN CUSTOMER_MSISDN,RECHARGE.RECHARGE_AMOUNT\n--    FROM TEMP_FOR_DD_EV_DET_18_JAN25 RECHARGE\n--    INNER JOIN TEMP_FOR_DDAGENT_18DEC24 AG \n--    ON AG.RET_MOBILE=RECHARGE.RETAILER_MSISDN\n--    WHERE (RECHARGE.TOP_UP_DATE  BETWEEN '8-JAN-25' AND '18-JAN-25') AND RECHARGE.RECHARGE_AMOUNT IN (498,548);-- 30395  Rows\n--    \n--SELECT * FROM TEMP_FOR_DD_FCS_DET2_7_DEC24;-- 30395  Rows\n    \nSELECT * FROM EV_RECHARGE_COM_DAILY;\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Deno Dhamaka Campaign_11th to 12th Nov24\n\n**Commission Name:** Distributor Deno Dhamaka Campaign_11th to 12th Nov24  \n**Start Date:** 11-Nov-2024  \n**End Date:** 12-Nov-2024  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** Retail Participation  \n- **Target:** Distributor will be given Deno Retail Participation targets (provided by B2C).  \n- **Mapping:** Agent list of 12th Nov’24 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno for selected regions will be considered for performance calculation.  \n        Region,Deno-01,Deno-02,Deno-03\n        Barisal,99,129,199\n        Jessore,108,129,199\n        Faridpur,108,129,199\n        Khulna Metro,108,129,199\n        Khulna Outer,108,129,199\n        Kushtia,108,129,199\n    - Upon achieving 150% and above Deno participation target (Cumulative of DENO), Distributor will be given BDT 200 per RSO incentive.  \n    - Retail Participation means at least one HIT from any selected DENO from a retail, counted as Retail Participation during the campaign period.  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n\n\n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, RSO_CODE, RSO_MSISDN, Target, Participation %, Incentive Amount  \n- **Detail 2:** DD_CODE, RSO_CODE, RSO_MSISDN, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n```", "sql": "-------------------------------HELPER QUERY------------------------------------\n--drop table TEMP_FOR_DENO_CAMP_TAR_12NOV24 purge;\nSELECT * FROM TEMP_FOR_DENO_CAMP_TAR_12NOV24;--112  Rows\n--SELECT * FROM TEMP_FOR_DENO_CAMP_12NOV24;\n\n--Jessore\n--Kushtia\n--Khulna Metro\n--Khulna Outer\n--Faridpur\n--Barisal\n\nCREATE TABLE TEMP_FOR_DENO_CAMP_TAR_12NOV24 AS\nSELECT *\nFROM TEMP_FOR_DENO_CAMP_TAR_12NOV24_BKP;\n\nupdate TEMP_FOR_DENO_CAMP_TAR_12NOV24 set DD_CODE = trim(DD_CODE);\ncommit;\n\n--DROP TABLE TEMP_FOR_AG_LIST_MAP_12NOV24 PURGE;\nCREATE TABLE TEMP_FOR_AG_LIST_MAP_12NOV24 AS\nSELECT TAR.*,AG.RETAILER_CODE, AG.TOPUP_MSISDN RET_MSISDN\nFROM TEMP_FOR_DENO_CAMP_TAR_12NOV24 TAR \nINNER JOIN AGENT_LIST_DAILY AG ON AG.DIST_CODE=TAR.DD_CODE AND AG.DATA_DATE = '12-NOV-24';--118371  Rows        118222  Rows\n\nSELECT * FROM TEMP_FOR_AG_LIST_MAP_12NOV24;--132569  Rows       118222  Rows\n\n--DROP TABLE TEMP_FOR_DD_DENO_DET1_12NOV24 PURGE;\nCREATE TABLE TEMP_FOR_DD_DENO_DET1_12NOV24 AS\n--CREATE TABLE TEMP_FOR_DD_DENO_DET2_12NOV24 AS\nWITH DD_WISE_ACHIEVEMENT AS ( \n    SELECT AG.DD_CODE, RETAILER_MSISDN , SUB_MSISDN CUSTOMER_MSISDN, REGION,AG.TARGET, RECHARGE_AMOUNT ,TOTAL_RSO\n    FROM TEMP_FOR_AG_LIST_MAP_12NOV24 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '11-NOV-24' AND '12-NOV-24') AND EV.RECHARGE_AMOUNT IN (99,108,129,199)\n--    AND REGION = 'Barisal' AND RECHARGE_AMOUNT IN (99,129,199)\n--    GROUP BY AG.DD_CODE,  AG.TARGET,REGION\n    \n)\n--SELECT * FROM DD_WISE_ACHIEVEMENT;--18354  Rows\n,DD_WISE_ACH AS (\nSELECT DD_CODE, REGION, TARGET,TOTAL_RSO,COUNT(DISTINCT(RETAILER_MSISDN)) PARTICIPATION FROM (\nSELECT * FROM DD_WISE_ACHIEVEMENT WHERE REGION = 'Barisal' AND RECHARGE_AMOUNT IN (99,129,199)\nUNION ALL\nSELECT * FROM DD_WISE_ACHIEVEMENT WHERE REGION = 'Jessore' AND RECHARGE_AMOUNT IN (108,129,199)\nUNION ALL \nSELECT * FROM DD_WISE_ACHIEVEMENT WHERE REGION = 'Faridpur' AND RECHARGE_AMOUNT IN (108,129,199)\nUNION ALL\nSELECT * FROM DD_WISE_ACHIEVEMENT WHERE REGION = 'Khulna Metro' AND RECHARGE_AMOUNT IN (108,129,199)\nUNION ALL\nSELECT * FROM DD_WISE_ACHIEVEMENT WHERE REGION = 'Khulna Outer' AND RECHARGE_AMOUNT IN (108,129,199)\nUNION ALL\nSELECT * FROM DD_WISE_ACHIEVEMENT WHERE REGION = 'Kushtia' AND RECHARGE_AMOUNT IN (108,129,199)\n) GROUP BY DD_CODE, REGION, TARGET,TOTAL_RSO\n)\n--SELECT * FROM DD_WISE_ACH;--14591  Rows\n,DD_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((PARTICIPATION/TARGET)*100) ACH_PER\nFROM DD_WISE_ACH ACHIEVEMENT\n)\n--SELECT * FROM DD_WISE_PERCENTAGE;--367  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,  TARGET, TOTAL_RSO, PARTICIPATION,ACH_PER,\n    CASE\n        WHEN  ACH_PER >= 150 THEN TOTAL_RSO*200\n        ELSE 0\n    END COMMISSION\n    FROM DD_WISE_PERCENTAGE \n)\nSELECT * FROM CALCULATE_COMMISSION;--367  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;--29800\n\nSELECT * FROM TEMP_FOR_DD_DENO_DET1_12NOV24;--367  Rows\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_DENO_DET1_12NOV24;--499165 TK\n\nSELECT * FROM TEMP_FOR_DD_DENO_DET2_12NOV24;--14591  Rows\n\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Deno Portfolio Campaign_1st to 8th Aug24\n\n**Commission Name:** Distributor Deno Portfolio Campaign_1st to 8th Aug24  \n**Start Date:** 1-Aug-2024  \n**End Date:** 8-Aug-2024  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges)\n- **Target:** Distributor will be given Deno Recharge targets (provided by B2C).  \n- **Mapping:** Agent list of 8th Aug’24 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno (199, 229, 249, 299, 399, 499, 599, 699, 799, 899) will be considered for performance calculation.  \n    - Upon achieving Deno Recharge target (Cumulative of DENO), Distributor will be given incentives (DD-wise target and incentive amount shared by B2C).  \n    - Cluster top DH will receive an incentive of BDT 15,000 instead of their eligible incentive slab.  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Region, Cluster, DD HIT Target, DD HIT Achievement %, Ranking, Highest Eligible Commission Amount, Commission Amount, Cluster Top (Y/N), Cluster Top Commission Amount  \n- **Detail 2:** Date, Cluster, Region, DD Code, RSO Code, RSO MSISDN, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount, Deno Recharge Amount  \n```  ", "sql": "-------------------------------HELPER QUERY------------------------------------\n--drop table TEMP_FOR_DENO_POR_TAR_8AUG24 purge;\nSELECT DISTINCT CATEGORY, INCENTIVE  FROM TEMP_FOR_DENO_POR_TAR_8AUG24;--375  Rows\nupdate TEMP_FOR_DENO_POR_TAR_8AUG24 set DD_CODE = trim(DD_CODE),RECHARGE_RECHARGE_TARGET = ROUND(RECHARGE_RECHARGE_TARGET);\ncommit;\n\n--DROP TABLE TEMP_FOR_AG_LIST_MAP_1_8AUG24 PURGE;\n--CREATE TABLE TEMP_FOR_AG_LIST_MAP_1_8AUG24 AS\nSELECT TAR.*,AG.RETAILER_CODE, AG.TOPUP_MSISDN RET_MSISDN FROM \nTEMP_FOR_DENO_POR_TAR_8AUG24 TAR \nINNER JOIN AGENT_LIST_DAILY AG ON AG.DIST_CODE=TAR.DD_CODE AND AG.DATA_DATE = '8-AUG-24';--563192  Rows\n\nSELECT * FROM TEMP_FOR_AG_LIST_MAP_1_8AUG24;-- 563192  Rows\n\n--DROP TABLE TEMP_FOR_DD_DENO_DET1_1_8AUG24 PURGE;\nCREATE TABLE TEMP_FOR_DD_DENO_DET1_1_8AUG24 AS\nWITH RSO_WISE_ACHIEVEMENT AS ( \n    SELECT CLUSTER_NAME,REGION,AG.DD_CODE,CATEGORY,AG.RECHARGE_TARGET,SUM(RECHARGE_AMOUNT) TOTAL_RECHARGE,INCENTIVE\n    FROM TEMP_FOR_AG_LIST_MAP_1_8AUG24 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '1-AUG-24' AND '8-AUG-24') AND EV.RECHARGE_AMOUNT IN (199,229,249,299,399,499,599,699,799,899)\n    GROUP BY AG.DD_CODE,  AG.RECHARGE_TARGET,REGION,CLUSTER_NAME, CATEGORY, INCENTIVE\n)\n--SELECT * FROM RSO_WISE_ACHIEVEMENT;--374  Rows\n,RET_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((TOTAL_RECHARGE/RECHARGE_TARGET)*100) ACH_PER\nFROM RSO_WISE_ACHIEVEMENT ACHIEVEMENT\n)\n--SELECT * FROM RET_WISE_PERCENTAGE;--374  Rows\n,CLUSTER_WISE_RNK AS (\nSELECT ACHIEVEMENT.*,RANK() OVER (PARTITION BY CLUSTER_NAME ORDER BY TOTAL_RECHARGE DESC) AS RANK\nFROM RET_WISE_PERCENTAGE ACHIEVEMENT\n)\n--SELECT * FROM CLUSTER_WISE_RNK; --WHERE DD_CODE IN ('DHKGOP02','KHUCHU02');--374  Rows  DHKGOP02  KHUCHU02\n,CALCULATE_COMMISSION AS (\n    SELECT CLUSTER_NAME, REGION, DD_CODE, CATEGORY, RECHARGE_TARGET, TOTAL_RECHARGE, INCENTIVE, ACH_PER, RANK,\n    CASE\n        WHEN  ACH_PER >= 100 AND RANK = 1 THEN 15000\n        WHEN  ACH_PER >= 100 AND CATEGORY = 'D' THEN 12000\n        WHEN  ACH_PER >= 100 AND CATEGORY = 'C' THEN 10000\n        WHEN  ACH_PER >= 100 AND CATEGORY = 'B' THEN 8000\n        WHEN  ACH_PER >= 100 AND CATEGORY = 'A' THEN 5000\n        ELSE 0\n    END COMMISSION\n    FROM CLUSTER_WISE_RNK \n)\nSELECT * FROM CALCULATE_COMMISSION;--374  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;--806000 TAKA\n\nSELECT * FROM TEMP_FOR_DD_DENO_DET1_1_8AUG24;--372  Rows\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_DENO_DET1_1_8AUG24;--806000             1491950 TK\n\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Deno Victory Campaign_North East Cluster_10th to 17th Dec24\n\n**Commission Name:** Distributor Deno Victory Campaign_North East Cluster_10th to 17th Dec24  \n**Start Date:** 10-Dec-2024  \n**End Date:** 17-Dec-2024  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges) \n- **Target:** Distributor will be given Deno HIT targets (provided by B2C).  \n- **Mapping:** Agent list of 17th Dec’24 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno for selected regions will be considered for performance calculation.  \n    - Upon achieving Deno HIT target (Cumulative of DENO), Distributor will be given BDT 80 incentives per HIT.  \n    - Upon achieving 90% to 99% Deno HIT target (Cumulative of DENO), Distributor will be given BDT 60 incentives per HIT.  \n    - More than 5 Hits by any retailer in a single day will be discarded from achievement.  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, RSO_CODE, DD_CODE, Target, HIT Target Achieved %, Incentive Amount  \n- **Detail 2:** DD_CODE, RSO_CODE, RSO_MSISDN, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n```", "sql": "--TARGET\n--ALTER TABLE TEMP_FOR_DD_FCS_TAR_17_DEC24 RENAME TO TEMP_FOR_DD_FCS_TAR_17_DEC24;\n--drop table TEMP_FOR_DD_FCS_TAR_17_DEC24 purge;\n\nselect * from COM_KPI_CONDITION;\n\nDROP TABLE TEMP_FOR_DD_FCS_TAR_17_DEC24 PURGE;\nCOMMIT;\n\nCREATE TABLE TEMP_FOR_DD_FCS_TAR_17_DEC24 AS\nselect CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET WHERE REPORTCYCLE_ID = 60312;--51  Rows\n\nSELECT * FROM TEMP_FOR_DD_FCS_TAR_17_DEC24;-- 51  Rows\nSELECT DD_CODE, COUNT(DD_CODE) FROM TEMP_FOR_DD_FCS_TAR_17_DEC24 GROUP BY DD_CODE HAVING COUNT(DD_CODE)>1;-- 68  Rows\n--SELECT * FROM TEMP_FOR_DD_FCS_TAR_17_DEC24 t where t.PARTICIPATION_TARGET <=0;--0 ROW\n--update TEMP_FOR_DD_FCS_TAR_17_DEC24 set DD_CODE = trim(DD_CODE);\n--commit;\n\n--UPDATE TEMP_FOR_DD_FCS_TAR_17_DEC24 SET DD_CODE = TRIM(DD_CODE), TARGET = ROUND(TARGET);\n--COMMIT;\n\n\nselect * from DD_RSO_RET_MAPPING_DAILY;\n------------------AGENT LIST--------------------\n-- drop table TEMP_FOR_DDAGENT_17_DEC24 purge;\nCREATE TABLE TEMP_FOR_DDAGENT_17_DEC24 AS\nSELECT /*+ parallel(10) */ DISTINCT\n    TAR.DD_CODE,\n    MAPING.RET_CODE,\n    MAPING.RET_MOBILE,\n    --TAR.PARTICIPATION_TARGET,\n--    TAR.INCENTIVE,\n    --TAR.SLAB,\n    TAR.TARGET\nFROM DD_RSO_RET_MAPPING_DAILY MAPING\nINNER JOIN TEMP_FOR_DD_FCS_TAR_17_DEC24 TAR ON MAPING.DD_CODE=TAR.DD_CODE\nWHERE DATA_DATE='17-DEC-24'; --AND PARTICIPATION_TARGET != 0; -- 148491  Rows\nSELECT * FROM TEMP_FOR_DDAGENT_17_DEC24;-- 66145  Rows\n--1915273989  87                          \n-------------------------------HELPER QUERY------------------------------------\n-- drop table TEMP_FOR_DD_EV_DET_17_DEC24 purge;\n CREATE TABLE TEMP_FOR_DD_EV_DET_17_DEC24 AS\nselect * from EV_RECHARGE_COM_DAILY RECHARGE WHERE \n        RECHARGE.TOP_UP_DATE BETWEEN '10-DEC-24' AND '17-DEC-24'\n        AND RECHARGE_AMOUNT IN (498); -- 11986605  Rows\nselect * from TEMP_FOR_DD_EV_DET_17_DEC24; -- 105072  Rows\n\n--drop table TEMP_FOR_DD_FCS_DET_17_DEC24 purge;\n--CREATE TABLE TEMP_FOR_DD_FCS_DET_17_DEC24 AS\nWITH RSO_WISE_ACHIEVEMENT AS (\n    SELECT DD_CODE,RET_MOBILE,AG.TARGET,TOP_UP_DATE,COUNT(RECHARGE.RECHARGE_AMOUNT) total_ACH,\n    case when COUNT(RECHARGE.RECHARGE_AMOUNT) >=5 then 5 else COUNT(RECHARGE.RECHARGE_AMOUNT) end as ach\n    FROM TEMP_FOR_DD_EV_DET_17_DEC24 RECHARGE\n    INNER JOIN TEMP_FOR_DDAGENT_17_DEC24 AG \n        ON AG.RET_MOBILE = RECHARGE.RETAILER_MSISDN\n    WHERE RECHARGE.TOP_UP_DATE BETWEEN '10-DEC-24' AND '17-DEC-24'\n        AND RECHARGE.RECHARGE_AMOUNT IN (498)\n    GROUP BY DD_CODE,AG.TARGET,RET_MOBILE,TOP_UP_DATE\n)\nSELECT * FROM RSO_WISE_ACHIEVEMENT; -- 14324  Rows\n,DD_WISE_ACH AS (\nSELECT DD_CODE, TARGET,SUM(ACH) ACH\nFROM RSO_WISE_ACHIEVEMENT\nGROUP BY DD_CODE, TARGET\n)\n--SELECT * FROM DD_WISE_ACH;\n,RSO_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((ACH/TARGET)*100) ACH_PER\nFROM DD_WISE_ACH ACHIEVEMENT\n)\n--SELECT * FROM RSO_WISE_PERCENTAGE;-- 51  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,TARGET,ACH,ACH_PER, \n    CASE\n        WHEN ACH_PER >= 100 THEN ACH * 80\n        WHEN ACH_PER >= 90 THEN ACH * 60\n        ELSE 0\n    END COMMISSION\n    FROM RSO_WISE_PERCENTAGE\n)\nSELECT * FROM CALCULATE_COMMISSION;-- 51  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;-- 1312800 TAKA\n\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_FCS_DET_17_DEC24;--1312800 TK\n\nSELECT * FROM TEMP_FOR_DD_FCS_DET_17_DEC24; -- 51  Rows\n\n---------------------MSISDN DETAIL---------------------------\n--DROP TABLE TEMP_FOR_DD_FCS_DET2_17_DEC24 PURGE;\nCREATE TABLE TEMP_FOR_DD_FCS_DET2_17_DEC24 AS\n SELECT DD_CODE,AG.RET_CODE, RET_MOBILE,RECHARGE.SUB_MSISDN CUSTOMER_MSISDN,RECHARGE.RECHARGE_AMOUNT\n    FROM TEMP_FOR_DD_EV_DET_17_DEC24 RECHARGE\n    INNER JOIN TEMP_FOR_DDAGENT_17_DEC24 AG \n    ON AG.RET_MOBILE=RECHARGE.RETAILER_MSISDN\n    WHERE (RECHARGE.TOP_UP_DATE  BETWEEN '10-DEC-24' AND '17-DEC-24') AND RECHARGE.RECHARGE_AMOUNT IN (498);-- 16932  Rows\n    \nSELECT * FROM TEMP_FOR_DD_FCS_DET2_17_DEC24;-- 30395  Rows\n    \nSELECT * FROM EV_RECHARGE_COM_DAILY;\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Deno_East Cluster_BDT_397_399_448_548_549_10th to 15th Feb25\n\n**Commission Name:** Distributor Deno_East Cluster_BDT_397_399_448_548_549_10th to 15th Feb25  \n**Start Date:** 10-Feb-2025  \n**End Date:** 15-Feb-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges) \n- **Target:** Distributor will be given Deno HIT targets (provided by B2C).  \n- **Mapping:** Agent list of 15th Feb’25 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno (397, 399, 448, 548, 549) will be considered for performance calculation.  \n    - Upon achieving Deno HIT target (Cumulative of DENO), Distributor will be given BDT 50 incentives per HIT (Distributor-wise HIT Target shared by B2C).  \n    - Upon achieving 90% to 99% Deno HIT target (Cumulative of DENO), Distributor will be given BDT 40 incentives per HIT (Distributor-wise HIT Target shared by B2C).  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Region, Cluster, DD HIT Target, DD HIT Achievement %, Ranking, Incentive Amount  \n- **Detail 2:** Date, Cluster, Region, DD Code, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n```", "sql": "CREATE TABLE EAST_10_TO_15TH_FEB25_62157 AS\nselect CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET \nWHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \nwhere REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Deno_East Cluster_BDT_397_399_448_548_549_10th to 15th Feb25') and  \nCYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Feb_25'));\n\nSELECT * FROM EAST_10_TO_15TH_FEB25_62157;-- 135  Rows\nSELECT DD_CODE, COUNT(DD_CODE) FROM EAST_10_TO_15TH_FEB25_62157 GROUP BY DD_CODE HAVING COUNT(DD_CODE)>1;-- 0  Rows\n--SELECT * FROM EAST_10_TO_15TH_FEB25_62157 t where t.PARTICIPATION_TARGET <=0;--0 ROW\n--update EAST_10_TO_15TH_FEB25_62157 set DD_CODE = trim(DD_CODE),TARGET = round(TARGET);\n--commit;\n\n\nselect * from DD_RSO_RET_MAPPING_DAILY;\n------------------AGENT LIST--------------------\n-- drop table TEMP_FOR_DDAGENT_NE_15_FEB25 purge;\nCREATE TABLE TEMP_FOR_DDAGENT_NE_15_FEB25 AS\nSELECT /*+ parallel(10) */ DISTINCT\n    TAR.REGION,\n    TAR.DD_CODE,\n    MAPING.RET_CODE,\n    MAPING.RET_MOBILE,\n    --TAR.PARTICIPATION_TARGET,\n--    TAR.INCENTIVE,\n    --TAR.SLAB,\n    TAR.TARGET\nFROM DD_RSO_RET_MAPPING_DAILY MAPING\nINNER JOIN EAST_10_TO_15TH_FEB25_62157 TAR ON MAPING.DD_CODE=TAR.DD_CODE\nWHERE DATA_DATE='15-FEB-25'; --AND PARTICIPATION_TARGET != 0; -- 106916  Rows\nSELECT * FROM TEMP_FOR_DDAGENT_NE_15_FEB25;-- 107016  Rows\n--1915273989  87                          \n-------------------------------HELPER QUERY------------------------------------\n-- drop table TEMP_FOR_DD_EV_DET_NE_10_15FEB25 purge;\nCREATE TABLE TEMP_FOR_DD_EV_DET_NE_10_15FEB25 AS\nselect * from EV_RECHARGE_COM_DAILY RECHARGE WHERE \n        RECHARGE.TOP_UP_DATE BETWEEN '10-FEB-25' AND '15-FEB-25'; -- 14844328  Rows\nselect * from TEMP_FOR_DD_EV_DET_NE_10_15FEB25; -- 11096978  Rows\n\n--drop table TEMP_FOR_DD_FCS_DET_NE_10_15FEB25 purge;\nCREATE TABLE TEMP_FOR_DD_FCS_DET_NE_10_15FEB25 AS\nWITH DD_WISE_ACHIEVEMENT AS (\n    SELECT REGION,DD_CODE,RET_MOBILE,AG.TARGET,COUNT(RECHARGE.RECHARGE_AMOUNT) ACH\n    FROM TEMP_FOR_DD_EV_DET_NE_10_15FEB25 RECHARGE\n    INNER JOIN TEMP_FOR_DDAGENT_NE_15_FEB25 AG \n        ON AG.RET_MOBILE = RECHARGE.RETAILER_MSISDN\n    WHERE RECHARGE.TOP_UP_DATE BETWEEN '10-FEB-25' AND '15-FEB-25'\n        AND (RECHARGE.RECHARGE_AMOUNT IN ( 397,448,548,549 ) AND AG.REGION IN ('Brahmanbaria')) OR \n(RECHARGE.RECHARGE_AMOUNT IN (397,399,448,548 ) AND AG.REGION IN ('Cumilla', 'Chittagong South' ,'Chittagong North')) \n    GROUP BY REGION,DD_CODE,AG.TARGET,RET_MOBILE\n)\n--SELECT * FROM DD_WISE_ACHIEVEMENT; -- 6350  Rows\n,DD_WISE_ACH AS (\nSELECT DD_CODE, TARGET,SUM(ACH) ACH\nFROM DD_WISE_ACHIEVEMENT\nGROUP BY DD_CODE, TARGET\n)\n--SELECT * FROM DD_WISE_ACH; -- 57  Rows\n,DD_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((ACH/TARGET)*100) ACH_PER\nFROM DD_WISE_ACH ACHIEVEMENT\n)\n--SELECT * FROM DD_WISE_PERCENTAGE;-- 57  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,TARGET,ACH,ACH_PER, \n    CASE\n        WHEN ACH_PER >= 100 THEN ACH * 50\n        WHEN ACH_PER >= 90 THEN ACH * 40\n        ELSE 0\n    END COMMISSION\n    FROM DD_WISE_PERCENTAGE\n)\nSELECT * FROM CALCULATE_COMMISSION;-- 57  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;-- 738020 TAKA\n\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_FCS_DET_NE_10_15FEB25;-- 738020 TK\n\nSELECT * FROM TEMP_FOR_DD_FCS_DET_NE_10_15FEB25; -- 57  Rows\n\n---------------------MSISDN DETAIL---------------------------\n--DROP TABLE TEMP_FOR_DD_FCS_DET2_NE_10_15FEB25 PURGE;\nCREATE TABLE TEMP_FOR_DD_FCS_DET2_NE_10_15FEB25 AS\n SELECT DD_CODE,AG.RET_CODE, RET_MOBILE,RECHARGE.SUB_MSISDN CUSTOMER_MSISDN,RECHARGE.RECHARGE_AMOUNT\n    FROM TEMP_FOR_DD_EV_DET_NE_10_15FEB25 RECHARGE\n    INNER JOIN TEMP_FOR_DDAGENT_NE_15_FEB25 AG \n    ON AG.RET_MOBILE=RECHARGE.RETAILER_MSISDN\n    WHERE (RECHARGE.TOP_UP_DATE  BETWEEN '10-FEB-25' AND '15-FEB-25') \n    AND (RECHARGE.RECHARGE_AMOUNT IN ( 397,448,548,549 ) AND AG.REGION IN ('Brahmanbaria')) OR \n(RECHARGE.RECHARGE_AMOUNT IN (397,399,448,548 ) AND AG.REGION IN ('Cumilla', 'Chittagong South' ,'Chittagong North')) ;-- 32613  Rows\n    \nSELECT * FROM TEMP_FOR_DD_FCS_DET2_NE_10_15FEB25;-- 15105  Rows\n    \nSELECT * FROM EV_RECHARGE_COM_DAILY;\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Deno_East Cluster_BDT_397_399_448_548_549_10th to 15th Feb25\n\n**Commission Name:** Distributor Deno_East Cluster_BDT_397_399_448_548_549_10th to 15th Feb25  \n**Start Date:** 10-Feb-2025  \n**End Date:** 15-Feb-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges)\n- **Target:** Distributor will be given Deno HIT targets (provided by B2C).  \n- **Mapping:** Agent list of 15th Feb’25 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno for selected regions will be considered for performance calculation.  \n    - Upon achieving Deno HIT target (Cumulative of DENO), Distributor will be given BDT 50 incentives per HIT.  \n    - Upon achieving 90% to 99% Deno HIT target (Cumulative of DENO), Distributor will be given BDT 40 incentives per HIT.  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, HIT Target Achieved %, Incentive Amount  \n- **Detail 2:** DD_CODE, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n```", "sql": "--TARGET\n--ALTER TABLE TEMP_FOR_DD_FCS_TAR_1_8FEB25 RENAME TO TEMP_FOR_DD_FCS_TAR_1_8FEB25;\n--drop table TEMP_FOR_DD_FCS_TAR_1_8FEB25 purge;\n\nSELECT * FROM TEMP_FOR_DD_FCS_TAR_1_8FEB25;-- 135  Rows\nSELECT DD_CODE, COUNT(DD_CODE) FROM TEMP_FOR_DD_FCS_TAR_1_8FEB25 GROUP BY DD_CODE HAVING COUNT(DD_CODE)>1;-- 0  Rows\n--SELECT * FROM TEMP_FOR_DD_FCS_TAR_1_8FEB25 t where t.PARTICIPATION_TARGET <=0;--0 ROW\n--update TEMP_FOR_DD_FCS_TAR_1_8FEB25 set DD_CODE = trim(DD_CODE),TARGET = round(TARGET);\n--commit;\n\n\nselect * from DD_RSO_RET_MAPPING_DAILY;\n------------------AGENT LIST--------------------\n-- drop table TEMP_FOR_DDAGENT_NE_8_FEB25 purge;\n--CREATE TABLE TEMP_FOR_DDAGENT_NE_8_FEB25 AS\nSELECT /*+ parallel(10) */ DISTINCT\n    TAR.REGION,\n    TAR.DD_CODE,\n    MAPING.RET_CODE,\n    MAPING.RET_MOBILE,\n    --TAR.PARTICIPATION_TARGET,\n--    TAR.INCENTIVE,\n    --TAR.SLAB,\n    TAR.TARGET\nFROM DD_RSO_RET_MAPPING_DAILY MAPING\nINNER JOIN TEMP_FOR_DD_FCS_TAR_1_8FEB25 TAR ON MAPING.DD_CODE=TAR.DD_CODE\nWHERE DATA_DATE='8-FEB-25'; --AND PARTICIPATION_TARGET != 0; -- 106916  Rows\nSELECT * FROM TEMP_FOR_DDAGENT_NE_8_FEB25;-- 228868  Rows\n--1915273989  87                          \n-------------------------------HELPER QUERY------------------------------------\n-- drop table TEMP_FOR_DD_EV_DET_NE_1_8FEB25 purge;\n--CREATE TABLE TEMP_FOR_DD_EV_DET_NE_1_8FEB25 AS\nselect * from EV_RECHARGE_COM_DAILY RECHARGE WHERE \n        RECHARGE.TOP_UP_DATE BETWEEN '1-FEB-25' AND '8-FEB-25'; -- 14844328  Rows\nselect * from TEMP_FOR_DD_EV_DET_NE_1_8FEB25; -- 12508687  Rows\n\n--drop table TEMP_FOR_DD_FCS_DET_NE_1_8FEB25 purge;\n--CREATE TABLE TEMP_FOR_DD_FCS_DET_NE_1_8FEB25 AS\nWITH DD_WISE_ACHIEVEMENT AS (\n    SELECT DD_CODE,RET_MOBILE,AG.TARGET,COUNT(RECHARGE.RECHARGE_AMOUNT) ACH\n    FROM TEMP_FOR_DD_EV_DET_NE_1_8FEB25 RECHARGE\n    INNER JOIN TEMP_FOR_DDAGENT_NE_8_FEB25 AG \n        ON AG.RET_MOBILE = RECHARGE.RETAILER_MSISDN\n    WHERE RECHARGE.TOP_UP_DATE BETWEEN '1-FEB-25' AND '8-FEB-25'\n        AND (RECHARGE.RECHARGE_AMOUNT IN (399,448,548) AND AG.REGION IN ('Sylhet')) OR \n(RECHARGE.RECHARGE_AMOUNT IN (498,548,549) AND AG.REGION IN ('Gazipur', 'Tangail', 'Mymensingh')) OR\n(RECHARGE.RECHARGE_AMOUNT IN (397,448,548,549) AND AG.REGION IN ('Brahmanbaria')) OR\n(RECHARGE.RECHARGE_AMOUNT IN (397,399,448,548) AND AG.REGION IN ('Cumilla', 'Chittagong South', 'Chittagong North'))\n    GROUP BY DD_CODE,AG.TARGET,RET_MOBILE\n)\n--SELECT * FROM DD_WISE_ACHIEVEMENT; -- 16254  Rows\n,DD_WISE_ACH AS (\nSELECT DD_CODE, TARGET,SUM(ACH) ACH\nFROM DD_WISE_ACHIEVEMENT\nGROUP BY DD_CODE, TARGET\n)\n--SELECT * FROM DD_WISE_ACH; -- 130  Rows\n,DD_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((ACH/TARGET)*100) ACH_PER\nFROM DD_WISE_ACH ACHIEVEMENT\n)\n--SELECT * FROM DD_WISE_PERCENTAGE;-- 130  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,TARGET,ACH,ACH_PER, \n    CASE\n        WHEN ACH_PER >= 100 THEN ACH * 60\n        WHEN ACH_PER >= 90 THEN ACH * 50\n        ELSE 0\n    END COMMISSION\n    FROM DD_WISE_PERCENTAGE\n)\nSELECT * FROM CALCULATE_COMMISSION;-- 130  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;-- 1423780 TAKA\n\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_FCS_DET_NE_1_8FEB25;-- 1423780 TK\n\nSELECT * FROM TEMP_FOR_DD_FCS_DET_NE_1_8FEB25; -- 130  Rows\n\n---------------------MSISDN DETAIL---------------------------\n--DROP TABLE TEMP_FOR_DD_FCS_DET2_NE_1_8FEB25 PURGE;\n--CREATE TABLE TEMP_FOR_DD_FCS_DET2_NE_1_8FEB25 AS\n SELECT DD_CODE,AG.RET_CODE, RET_MOBILE,RECHARGE.SUB_MSISDN CUSTOMER_MSISDN,RECHARGE.RECHARGE_AMOUNT\n    FROM TEMP_FOR_DD_EV_DET_NE_1_8FEB25 RECHARGE\n    INNER JOIN TEMP_FOR_DDAGENT_NE_8_FEB25 AG \n    ON AG.RET_MOBILE=RECHARGE.RETAILER_MSISDN\n    WHERE (RECHARGE.TOP_UP_DATE  BETWEEN '1-FEB-25' AND '8-FEB-25') AND (RECHARGE.RECHARGE_AMOUNT IN (399,448,548) AND AG.REGION IN ('Sylhet')) OR \n(RECHARGE.RECHARGE_AMOUNT IN (498,548,549) AND AG.REGION IN ('Gazipur', 'Tangail', 'Mymensingh')) OR\n(RECHARGE.RECHARGE_AMOUNT IN (397,448,548,549) AND AG.REGION IN ('Brahmanbaria')) OR\n(RECHARGE.RECHARGE_AMOUNT IN (397,399,448,548) AND AG.REGION IN ('Cumilla', 'Chittagong South', 'Chittagong North'));-- 32613  Rows\n    \nSELECT * FROM TEMP_FOR_DD_FCS_DET2_NE_1_8FEB25;-- 32613  Rows\n    \nSELECT * FROM EV_RECHARGE_COM_DAILY;\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Dhamaka Campaign_GAZ_TAN_MYM_23rd to 31st Jan25\n\n**Commission Name:** Distributor Dhamaka Campaign_GAZ_TAN_MYM_23rd to 31st Jan25  \n**Start Date:** 23-Jan-2025  \n**End Date:** 31-Jan-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges) \n- **Target:** Distributor will be given Deno HIT targets (provided by B2C).  \n- **Mapping:** Agent list of 31st Jan’25 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno (227, 348, 398) will be considered for performance calculation.  \n    - Upon achieving 100% Deno HIT target (Cumulative of DENO), Distributor will be given:  \n        - BDT 50 incentives per HIT for Deno 348 and 398.  \n        - BDT 30 incentives per HIT for Deno 227.  \n    - Upon achieving 90% to 99% Deno HIT target (Cumulative of DENO), Distributor will be given:  \n        - BDT 40 incentives per HIT for Deno 348 and 398.  \n        - BDT 20 incentives per HIT for Deno 227.  \n    - Incentives are capped up to 130%.  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, HIT Target Achievement %, Incentive Amount  \n- **Detail 2:** DD Code, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n```", "sql": "-- 7438 9574 61577\nSELECT * FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Dhamaka Campaign_GAZ_TAN_MYM_23rd to 31st Jan25';\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jan_25'; --base month\nSELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS where REPORTID = 7438 and  CYCLEID = 9574;--61577\n\n-- *** Create TEMP TARGET Table *** \n--CREATE TABLE TEMP_FOR_DENO_CAMP_TAR_23_31_JAN25 AS\nSELECT CHANNEL_CODE DD_CODE, TARGET FROM COM_KPI_CONDITION_TARGET where REPORTCYCLE_ID = 61577;\n\n--drop table TEMP_FOR_DENO_CAMP_TAR_23_31_JAN25 purge;\nSELECT * FROM TEMP_FOR_DENO_CAMP_TAR_23_31_JAN25;-- 74  Rows\nSELECT DD_CODE, COUNT(DD_CODE) FROM TEMP_FOR_DENO_CAMP_TAR_23_31_JAN25 GROUP BY DD_CODE HAVING COUNT(DD_CODE)>1;-- 68  Rows\n--SELECT * FROM TEMP_FOR_DENO_CAMP_TAR_23_31_JAN25 t where t.PARTICIPATION_TARGET <=0;--0 ROW\nupdate TEMP_FOR_DENO_CAMP_TAR_23_31_JAN25 set DD_CODE = trim(DD_CODE);\ncommit;\n\nselect * from DD_RSO_RET_MAPPING_DAILY;\n------------------AGENT LIST--------------------\n-- drop table TEMP_FOR_AG_LIST_MAP_23_31_JAN25 purge;\n--CREATE TABLE TEMP_FOR_AG_LIST_MAP_23_31_JAN25 AS\nSELECT /*+ parallel(10) */ DISTINCT\n    TAR.DD_CODE,\n    MAPING.RET_CODE,\n    MAPING.RET_MOBILE,\n    --TAR.PARTICIPATION_TARGET,\n--    TAR.INCENTIVE,\n    --TAR.SLAB,\n    TAR.TARGET\nFROM DD_RSO_RET_MAPPING_DAILY MAPING\nINNER JOIN TEMP_FOR_DENO_CAMP_TAR_23_31_JAN25 TAR ON MAPING.DD_CODE=TAR.DD_CODE\nWHERE DATA_DATE='31-JAN-25'; --AND PARTICIPATION_TARGET != 0;\nSELECT * FROM TEMP_FOR_AG_LIST_MAP_23_31_JAN25;-- 98416  Rows\n--1915273989  87                          \n-------------------------------HELPER QUERY------------------------------------\n-- drop table TEMP_FOR_DD_EV_DET_15_21_JAN25 purge;\n CREATE TABLE TEMP_FOR_DD_EV_DET_15_21_JAN25 AS\nselect * from EV_RECHARGE_COM_DAILY RECHARGE WHERE \n        RECHARGE.TOP_UP_DATE BETWEEN '15-JAN-25' AND '21-JAN-25'; -- 11986605  Rows\nselect * from TEMP_FOR_DD_EV_DET_15_21_JAN25; -- 12923471  Rows\n\n--drop table TEMP_FOR_DD_FCS_DET_23_31JAN25 purge;\nCREATE TABLE TEMP_FOR_DD_FCS_DET_23_31JAN25 AS\nWITH DD_WISE_SUMMARY AS (\n    SELECT DD_CODE,AG.TARGET,COUNT(RECHARGE.RECHARGE_AMOUNT) ACH,\n    ROUND(TARGET * 1.3) AS MAX_CAP,\n    SUM(CASE WHEN RECHARGE.RECHARGE_AMOUNT IN (348, 398) THEN 1 ELSE 0 END) AS Ach_348_398,\n        SUM(CASE WHEN RECHARGE.RECHARGE_AMOUNT = 227 THEN 1 ELSE 0 END) AS Ach_227\n    FROM EV_RECHARGE_COM_DAILY RECHARGE\n    INNER JOIN TEMP_FOR_AG_LIST_MAP_23_31_JAN25 AG \n        ON AG.RET_MSISDN = RECHARGE.RETAILER_MSISDN\n    WHERE RECHARGE.TOP_UP_DATE BETWEEN '23-JAN-25' AND '31-JAN-25'\n        AND RECHARGE.RECHARGE_AMOUNT IN (227,348,398)\n    GROUP BY DD_CODE,AG.TARGET\n)\n--SELECT * FROM DD_WISE_SUMMARY; -- 64  Rows\n,DD_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((ACH/TARGET)*100) ACH_PER,\n\nROUND((ACH_348_398/TARGET)*100) ACH_PER_348_398,\nROUND((ACH_227/TARGET)*100) ACH_PER_227\nFROM DD_WISE_SUMMARY ACHIEVEMENT\n)\n--SELECT * FROM DD_WISE_PERCENTAGE;-- 64  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,TARGET,ACH,ACH_PER,ACH_348_398, ACH_227,ACH_PER_348_398,ACH_PER_227,MAX_CAP,\n    CASE\n        WHEN ACH_PER >= 100 and MAX_CAP >= ACH_348_398+ACH_227 THEN (ACH_348_398*50)+(ACH_227*30) \n        WHEN ACH_PER >= 100 and MAX_CAP <= ACH_348_398 THEN (MAX_CAP*50)\n        WHEN ACH_PER >= 100 and MAX_CAP <= ACH_348_398+ACH_227 THEN (ACH_348_398*50)+((MAX_CAP-ACH_348_398)*30)\n        WHEN ACH_PER >= 90 THEN (ACH_348_398*40)+(ACH_227*20)     \n        ELSE 0\n    END COMMISSION\n    FROM DD_WISE_PERCENTAGE\n)\nSELECT * FROM CALCULATE_COMMISSION;-- 111  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;-- 315450 TAKA\n\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_FCS_DET_23_31JAN25;--315450 TK\n\nSELECT * FROM TEMP_FOR_DD_FCS_DET_23_31JAN25; --64  Rows\n\n---------------------MSISDN DETAIL---------------------------\n--DROP TABLE TEMP_FOR_DD_FCS_DET2_23_31JAN25 PURGE;\nCREATE TABLE TEMP_FOR_DD_FCS_DET2_23_31JAN25 AS\n SELECT DD_CODE,AG.RETAILER_CODE, RET_MSISDN,RECHARGE.SUB_MSISDN CUSTOMER_MSISDN,RECHARGE.RECHARGE_AMOUNT\n    FROM EV_RECHARGE_COM_DAILY RECHARGE\n    INNER JOIN TEMP_FOR_AG_LIST_MAP_23_31_JAN25 AG \n    ON AG.RET_MSISDN=RECHARGE.RETAILER_MSISDN\n    WHERE (RECHARGE.TOP_UP_DATE  BETWEEN '23-JAN-25' AND '31-JAN-25') AND RECHARGE.RECHARGE_AMOUNT IN (227,348,398);-- 30395  Rows\n    \nSELECT * FROM TEMP_FOR_DD_FCS_DET2_23_31JAN25;-- 10699  Rows\n    \nSELECT * FROM EV_RECHARGE_COM_DAILY;\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Dhamaka Campaign_SYL_23rd to 31st Jan25\n\n**Commission Name:** Distributor Dhamaka Campaign_SYL_23rd to 31st Jan25  \n**Start Date:** 23-Jan-2025  \n**End Date:** 31-Jan-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges) \n- **Target:** Distributor will be given Deno HIT targets (provided by B2C).  \n- **Mapping:** Agent list of 31st Jan’25 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno (169, 348, 399) will be considered for performance calculation.  \n    - Upon achieving 100% Deno HIT target (Cumulative of DENO), Distributor will be given:  \n        - BDT 50 incentives per HIT for Deno 348 and 399.  \n        - BDT 20 incentives per HIT for Deno 169.  \n    - Upon achieving 90% to 99% Deno HIT target (Cumulative of DENO), Distributor will be given:  \n        - BDT 40 incentives per HIT for Deno 348 and 399.  \n        - BDT 15 incentives per HIT for Deno 169.  \n    - Incentives are capped up to 130%.  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, HIT Target Achievement %, Incentive Amount  \n- **Detail 2:** DD Code, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n```", "sql": "-- 7440 9574 61579\nSELECT * FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Dhamaka Campaign_SYL_23rd to 31st Jan25';\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jan_25'; --base month\nSELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS where REPORTID = 7440 and  CYCLEID = 9574;--61579\n\n-- *** Create TEMP TARGET Table *** \n--CREATE TABLE TEMP_FOR_DENO_SYL_CAMP_TAR_23_31_JAN25 AS\nSELECT CHANNEL_CODE DD_CODE, TARGET FROM COM_KPI_CONDITION_TARGET where REPORTCYCLE_ID = 61579;\n\n--drop table TEMP_FOR_DENO_SYL_CAMP_TAR_23_31_JAN25 purge;\nSELECT * FROM TEMP_FOR_DENO_SYL_CAMP_TAR_23_31_JAN25;-- 14  Rows\nSELECT DD_CODE, COUNT(DD_CODE) FROM TEMP_FOR_DENO_SYL_CAMP_TAR_23_31_JAN25 GROUP BY DD_CODE HAVING COUNT(DD_CODE)>1;-- 68  Rows\n--SELECT * FROM TEMP_FOR_DENO_SYL_CAMP_TAR_23_31_JAN25 t where t.PARTICIPATION_TARGET <=0;--0 ROW\nupdate TEMP_FOR_DENO_SYL_CAMP_TAR_23_31_JAN25 set DD_CODE = trim(DD_CODE);\ncommit;\n\nselect * from DD_RSO_RET_MAPPING_DAILY;\n------------------AGENT LIST--------------------\n-- drop table TEMP_FOR_AG_LIST_MAP_31_JAN25 purge;\nCREATE TABLE TEMP_FOR_AG_LIST_MAP_31_JAN25 AS\nSELECT /*+ parallel(10) */ DISTINCT\n    TAR.DD_CODE,\n    MAPING.RET_CODE,\n    MAPING.RET_MOBILE,\n    --TAR.PARTICIPATION_TARGET,\n--    TAR.INCENTIVE,\n    --TAR.SLAB,\n    TAR.TARGET\nFROM DD_RSO_RET_MAPPING_DAILY MAPING\nINNER JOIN TEMP_FOR_DENO_SYL_CAMP_TAR_23_31_JAN25 TAR ON MAPING.DD_CODE=TAR.DD_CODE\nWHERE DATA_DATE='31-JAN-25'; --AND PARTICIPATION_TARGET != 0;\nSELECT * FROM TEMP_FOR_AG_LIST_MAP_31_JAN25;-- 23240  Rows\n--1915273989  87                          \n-------------------------------HELPER QUERY------------------------------------\n-- drop table TEMP_FOR_DD_EV_DET_15_21_JAN25 purge;\n-- CREATE TABLE TEMP_FOR_DD_EV_DET_15_21_JAN25 AS\n--select * from EV_RECHARGE_COM_DAILY RECHARGE WHERE \n--        RECHARGE.TOP_UP_DATE BETWEEN '15-JAN-25' AND '21-JAN-25'; -- 11986605  Rows\n--select * from TEMP_FOR_DD_EV_DET_15_21_JAN25; -- 12923471  Rows\n\n--drop table TEMP_FOR_DD_SYL_DET_23_31JAN25 purge;\nCREATE TABLE TEMP_FOR_DD_SYL_DET_23_31JAN25 AS\nWITH DD_WISE_SUMMARY AS (\n    SELECT DD_CODE,AG.TARGET,COUNT(RECHARGE.RECHARGE_AMOUNT) ACH,\n    ROUND(TARGET * 1.3) AS MAX_CAP,\n    SUM(CASE WHEN RECHARGE.RECHARGE_AMOUNT IN (348,399) THEN 1 ELSE 0 END) AS Ach_348_399,\n        SUM(CASE WHEN RECHARGE.RECHARGE_AMOUNT = 169 THEN 1 ELSE 0 END) AS Ach_169\n    FROM EV_RECHARGE_COM_DAILY RECHARGE\n    INNER JOIN TEMP_FOR_AG_LIST_MAP_31_JAN25 AG \n        ON AG.RET_MOBILE = RECHARGE.RETAILER_MSISDN\n    WHERE RECHARGE.TOP_UP_DATE BETWEEN '23-JAN-25' AND '31-JAN-25'\n        AND RECHARGE.RECHARGE_AMOUNT IN (169,348,399)\n    GROUP BY DD_CODE,AG.TARGET\n)\n--SELECT * FROM DD_WISE_SUMMARY; -- 14  Rows\n,DD_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((ACH/TARGET)*100) ACH_PER,\n\nROUND((Ach_348_399/TARGET)*100) ACH_PER_348_399,\nROUND((Ach_169/TARGET)*100) ACH_PER_169\nFROM DD_WISE_SUMMARY ACHIEVEMENT\n)\n--SELECT * FROM DD_WISE_PERCENTAGE;-- 64  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,TARGET,ACH,ACH_PER,Ach_348_399, Ach_169,ACH_PER_348_399,ACH_PER_169,MAX_CAP,\n    CASE\n        WHEN ACH_PER >= 100 and MAX_CAP >= Ach_348_399+Ach_169 THEN (Ach_348_399*50)+(Ach_169*20) \n        WHEN ACH_PER >= 100 and MAX_CAP <= Ach_348_399 THEN (MAX_CAP*50)\n        WHEN ACH_PER >= 100 and MAX_CAP <= Ach_348_399+Ach_169 THEN (Ach_348_399*50)+((MAX_CAP-Ach_348_399)*20)\n        WHEN ACH_PER >= 90 THEN (Ach_348_399*40)+(Ach_169*15)     \n        ELSE 0\n    END COMMISSION\n    FROM DD_WISE_PERCENTAGE\n)\nSELECT * FROM CALCULATE_COMMISSION;-- 14  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;-- 78000 TAKA\n\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_SYL_DET_23_31JAN25;--78000 TK\n\nSELECT * FROM TEMP_FOR_DD_SYL_DET_23_31JAN25; --14  Rows\n\n---------------------MSISDN DETAIL---------------------------\n--DROP TABLE TEMP_FOR_DD_SYL_DET2_23_31JAN25 PURGE;\nCREATE TABLE TEMP_FOR_DD_SYL_DET2_23_31JAN25 AS\n SELECT DD_CODE,AG.RET_CODE, RET_MOBILE,RECHARGE.SUB_MSISDN CUSTOMER_MSISDN,RECHARGE.RECHARGE_AMOUNT\n    FROM EV_RECHARGE_COM_DAILY RECHARGE\n    INNER JOIN TEMP_FOR_AG_LIST_MAP_31_JAN25 AG \n    ON AG.RET_MOBILE=RECHARGE.RETAILER_MSISDN\n    WHERE (RECHARGE.TOP_UP_DATE  BETWEEN '23-JAN-25' AND '31-JAN-25') AND RECHARGE.RECHARGE_AMOUNT IN (169,348,399);-- 30395  Rows\n    \nSELECT * FROM TEMP_FOR_DD_SYL_DET2_23_31JAN25;-- 3031  Rows\n    \nSELECT * FROM EV_RECHARGE_COM_DAILY;\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Sniper Strike_BDT 397_548_549_10th to 15th Jun25\n\n**Commission Name:** Distributor Sniper Strike_BDT 397_548_549_10th to 15th Jun25  \n**Start Date:** 10-Jun-2025  \n**End Date:** 15-Jun-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges)  \n- **Target:** Distributor will be given Deno HIT targets (provided by B2C).  \n- **Mapping:** Agent list of 15th Jun’25 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno (397, 548, 549) will be considered for performance calculation.  \n    - **North, East, Central, North East Clusters:**  \n        - Upon achieving 100% Deno HIT target (Cumulative of DENO), Distributor will be given:  \n            - BDT 30 incentives per HIT for Deno 548 and 549.  \n            - BDT 15 incentives per HIT for Deno 397.  \n        - Upon achieving 90% to 99% Deno HIT target (Cumulative of DENO), Distributor will be given:  \n            - BDT 20 incentives per HIT for Deno 548 and 549.  \n            - BDT 10 incentives per HIT for Deno 397.  \n    - Incentives are capped up to 200% achievement.  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, HIT Target Achievement %, Incentive Amount  \n- **Detail 2:** DD Code, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n```", "sql": "-------------------------------HELPER QUERY------------------------------------\n-- 7451 9574 61612\n\n--CREATE TABLE TEMP_FOR_DENO_CAM_TAR_15JUN25 AS\n--select CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET \n--WHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \n--where REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Sniper Strike_BDT 397_548_549_1st to 6th Jun25') and  \n--CYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jun_25'));--341  Rows\n\nSELECT distinct CLUSTER_NAME FROM TEMP_FOR_DENO_CAM_TAR_15JUN25;--227  Rows\nSELECT * FROM TEMP_FOR_DENO_CAM_TAR_15JUN25;--227  Rows\nUPDATE TEMP_FOR_DENO_CAM_TAR_15JUN25 SET TARGET = ROUND(TARGET),DD_CODE = TRIM(DD_CODE);\n\n--DROP TABLE TEMP_FOR_AG_LST_MAP_15MAY25 PURGE;\nCREATE TABLE TEMP_FOR_AG_LST_MAP_15MAY25 AS\nSELECT TAR.*,AG.RET_CODE RETAILER_CODE, AG.RET_MOBILE RET_MSISDN \nFROM TEMP_FOR_DENO_CAM_TAR_15JUN25 TAR \nINNER JOIN DD_RSO_RET_MAPPING_DAILY AG ON AG.DD_CODE=TAR.DD_CODE AND AG.DATA_DATE = '15-JUN-25';--561446  Rows DATE CONFIRMED WITH KHAIRUL BHAI\n\nSELECT * FROM TEMP_FOR_AG_LST_MAP_15MAY25;--557087  Rows       554713  Rows               552507  Rows\nSELECT * FROM EV_RECHARGE_COM_DAILY;\n\n--DROP TABLE TEMP_FOR_DD_SS_DET_15_JUN25 PURGE;\nCREATE TABLE TEMP_FOR_DD_DN_DET2_15JUN25 AS\n--CREATE TABLE TEMP_FOR_DD_SS_DET_15_JUN25 AS\nWITH RSO_WISE_ACHIEVEMENT AS ( \n    SELECT /*+ parallel(10) */ CLUSTER_NAME,AG.DD_CODE,AG.TARGET, RECHARGE_AMOUNT,SUB_MSISDN CUSTOMER_MSISDN,\n    CASE WHEN RECHARGE_AMOUNT IN (548,549) THEN 1 ELSE 0 END AS DENO_548_549,\n    CASE WHEN RECHARGE_AMOUNT IN (397) THEN 1 ELSE 0 END AS DENO_397\n    FROM TEMP_FOR_AG_LST_MAP_15MAY25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '10-JUN-25' AND '15-JUN-25') AND EV.RECHARGE_AMOUNT IN (397,548,549)\n    \n)\n--SELECT * FROM RSO_WISE_ACHIEVEMENT;-- msisdn details\n,DENO_WISE_COUNT AS (\nSELECT  CLUSTER_NAME,DD_CODE, TARGET, COUNT(*) HIT,ROUND(COUNT(*)*100/TARGET) ACH_PER,SUM(DENO_548_549) DENO_548_549_HIT, SUM(DENO_397) DENO_397_HIT\nFROM RSO_WISE_ACHIEVEMENT ACH\nGROUP BY CLUSTER_NAME,DD_CODE, TARGET\n)\n--SELECT * from DENO_WISE_COUNT;--335  Rows\n,RET_WISE_PERCENTAGE AS (\nSELECT CC.*,\nCASE WHEN  ACH_PER >= 200 THEN \n            CASE WHEN TARGET*2 <= DENO_548_549_HIT THEN TARGET*2 *30\n                 WHEN TARGET*2 >= DENO_548_549_HIT THEN (DENO_548_549_HIT *30)+(((TARGET*2 )-DENO_548_549_HIT)*15)\n                 ELSE 0 END\n     WHEN  ACH_PER >= 100 THEN (DENO_548_549_HIT*30)+(DENO_397_HIT*15)\n     WHEN  ACH_PER >= 90 THEN (DENO_548_549_HIT*20)+(DENO_397_HIT*10)\n     ELSE 0 END AS COMMISSION_AMOUNT\nFROM DENO_WISE_COUNT CC\n)\nSELECT * FROM RET_WISE_PERCENTAGE;--335  Rows\nSELECT SUM(COMMISSION_AMOUNT) TOTAL_COMMISSION FROM RET_WISE_PERCENTAGE;--3433140          5231890 TAKA  RAJBOG23\n\nSELECT * FROM TEMP_FOR_DD_SS_DET_15_JUN25;--227  Rows\nSELECT SUM(COMMISSION_AMOUNT) FROM TEMP_FOR_DD_SS_DET_15_JUN25;--795790           2202020     TK\n\nSELECT * FROM TEMP_FOR_DD_DN_DET2_15JUN25;--40847  Rows     Rows MSISDN DETAILS\n\n\n--------------------SETUP-------------\n\nSELECT APP.REPORT_NAME, CT.CHANNELTYPE, APP.CHANNEL_TYPE_ID\nFROM REPORT_APPROVAL APP \nINNER JOIN CHANNELTYPE CT ON CT.CHANNELTYPEID = APP.CHANNEL_TYPE_ID\nWHERE APP.REPORT_NAME = 'Distributor Sniper Strike_BDT 397_548_549_10th to 15th Jun25';\n--CHANNEL_TYPE_ID   1\n\n--EXEC ADHOC_REPORT_SETUP('Distributor Sniper Strike_BDT 397_548_549_10th to 15th Jun25', 'Nov_24', 'Nov_24', 1, '12-Nov-24', '12-Nov-24', '', '13-NOV-24');\n\n-- 8002 10074 64734\nSELECT * FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Sniper Strike_BDT 397_548_549_10th to 15th Jun25';\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jun_25'; --base month\nSELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS where REPORTID = 8002 and  CYCLEID = 10074;--64734\n\nSELECT * FROM AD_HOC_DATA WHERE REPORT_CYCLE_ID = 64734;\n--delete from ad_hoc_data where REPORT_CYCLE_ID = 64734;\n--commit;\n\nINSERT INTO AD_HOC_DATA (ID, REPORT_CYCLE_ID, CHANNEL_CODE,COMMISSION_AMOUNT)\nSELECT /*+ parallel(16) */  AD_HOC_DATA_ID.nextval id, 64734 REPORT_CYCLE_ID, DD_CODE, COMMISSION_AMOUNT\nFROM (\nSELECT * FROM TEMP_FOR_DD_SS_DET_15_JUN25\n);\nCOMMIT;\n\nSELECT SUM(COMMISSION_AMOUNT) FROM ad_hoc_data where REPORT_CYCLE_ID = 64734; --795790        2202020        3433140            5231890   TAKA\n\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jun_25'; --Publish month --10074\n \nEXEC PROC_COMMISSION_DETAIL_SETUP('Distributor Sniper Strike_BDT 397_548_549_10th to 15th Jun25',10074,'TEMP_FOR_DD_SS_DET_15_JUN25','SUMMERY_DETAIL','TEMP_FOR_DD_DN_DET2_15JUN25','MSISDN_DETAIL');\n \nEXEC FINALIZE_REPORT_ADHOC('Distributor Sniper Strike_BDT 397_548_549_10th to 15th Jun25', 64734,'Jun_25', 'Jun_25',290, 1);\n\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Sniper Strike_BDT 397_548_549_10th to 15th May25\n\n**Commission Name:** Distributor Sniper Strike_BDT 397_548_549_10th to 15th May25  \n**Start Date:** 10-May-2025  \n**End Date:** 15-May-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges)  \n- **Target:** Distributor will be given Deno HIT targets (provided by B2C).  \n- **Mapping:** Agent list of 15th May’25 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno (397, 548, 549) will be considered for performance calculation.  \n    - **West Cluster:**  \n        - Upon achieving 100% Deno HIT target (Cumulative of DENO), Distributor will be given BDT 60 incentives per HIT.  \n        - Upon achieving 90% to 99% Deno HIT target (Cumulative of DENO), Distributor will be given BDT 50 incentives per HIT.  \n    - **North, East, Central, North East Clusters:**  \n        - Upon achieving 100% Deno HIT target (Cumulative of DENO):  \n            - BDT 60 incentives per HIT for Deno 548 and 549.  \n            - BDT 40 incentives per HIT for Deno 397.  \n        - Upon achieving 90% to 99% Deno HIT target (Cumulative of DENO):  \n            - BDT 50 incentives per HIT for Deno 548 and 549.  \n            - BDT 30 incentives per HIT for Deno 397.  \n    - Incentives are capped up to 200% achievement.  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, HIT Target Achievement %, Incentive Amount  \n- **Detail 2:** DD Code, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n```", "sql": "-------------------------------HELPER QUERY------------------------------------\n-- 7451 9574 61612\n\n--CREATE TABLE TEMP_FOR_DENO_CAMP_TAR_10_15_MAY25 AS\n--select CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET \n--WHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \n--where REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Sniper Strike_BDT 397_548_549_1st to 8th May25') and  \n--CYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'May_25'));--341  Rows\n\nSELECT * FROM TEMP_FOR_DENO_CAMP_TAR_10_15_MAY25;-- 337  Rows\n\n\n--DROP TABLE TEMP_FOR_AG_LIST_MAP_DET_22_MAY25 PURGE;\n--CREATE TABLE TEMP_FOR_AG_LIST_MAP_DET_22_MAY25 AS\nSELECT TAR.*,AG.RET_CODE RETAILER_CODE, AG.RET_MOBILE RET_MSISDN \nFROM TEMP_FOR_DENO_CAMP_TAR_10_15_MAY25 TAR \nINNER JOIN DD_RSO_RET_MAPPING_DAILY AG ON AG.DD_CODE=TAR.DD_CODE AND AG.DATA_DATE = '15-MAY-25';-- 555867  Rows\n\nSELECT * FROM TEMP_FOR_AG_LIST_MAP_DET_22_MAY25;--  555867  Rows    554713  Rows               552507  Rows\nSELECT * FROM EV_RECHARGE_COM_DAILY;\n\n--DROP TABLE TEMP_FOR_DD_DN_DET2_10_15MAY25 PURGE;\n--CREATE TABLE TEMP_FOR_DD_DN_DET2_10_15MAY25 AS\n--DROP TABLE TEMP_FOR_DD_SS_DET_10_15MAY25 PURGE;\n--CREATE TABLE TEMP_FOR_DD_SS_DET_10_15MAY25 AS\nWITH RSO_WISE_ACHIEVEMENT AS ( \n    SELECT /*+ parallel(10) */ CLUSTER_NAME,AG.D_CODE DD_CODE,AG.HIT_TARGET TARGET, RECHARGE_AMOUNT,SUB_MSISDN CUSTOMER_MSISDN,\n    CASE WHEN RECHARGE_AMOUNT IN (548,549) THEN 1 ELSE 0 END AS DENO_548_549,\n    CASE WHEN RECHARGE_AMOUNT IN (397) THEN 1 ELSE 0 END AS DENO_397\n    FROM TEMP_FOR_AG_LIST_MAP_DET_22_MAY25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '17-MAY-25' AND '22-MAY-25') AND EV.RECHARGE_AMOUNT IN (397,548,549)\n--    AND SERVICE_CLASS_ID NOT IN (141) \n--    AND NOT EXISTS(SELECT MOBILENO FROM VW_EMPLOYEESALESCOM_MONTHLY VE WHERE VE.DATE_DATE='1-JAN-24' AND VE.MOBILENO=EV.SUB_MSISDN)\n--    GROUP BY AG.DD_CODE,  AG.TARGET\n)\n--SELECT * FROM RSO_WISE_ACHIEVEMENT;-- 72809  Rows\n,DENO_WISE_COUNT AS (\nSELECT  CLUSTER_NAME,DD_CODE, TARGET, COUNT(*) HIT,ROUND(COUNT(*)*100/TARGET) ACH_PER,SUM(DENO_548_549) DENO_548_549_HIT, SUM(DENO_397) DENO_397_HIT\nFROM RSO_WISE_ACHIEVEMENT ACH\nGROUP BY CLUSTER_NAME,DD_CODE, TARGET\n)\n--SELECT * from DENO_WISE_COUNT;  -- 328  Rows\n,RET_WISE_PERCENTAGE AS (\nSELECT CC.*,\nCASE WHEN CLUSTER_NAME ='West Cluster' AND ACH_PER >= 200 THEN (TARGET*2)* 50\n     WHEN CLUSTER_NAME ='West Cluster' AND ACH_PER >= 100 THEN HIT* 50\n     WHEN CLUSTER_NAME ='West Cluster' AND ACH_PER >= 90 THEN HIT* 40\n      WHEN CLUSTER_NAME !='West Cluster' AND ACH_PER >= 200 THEN \n            CASE WHEN TARGET*2 <= DENO_548_549_HIT THEN TARGET*2 *50\n                 WHEN TARGET*2 >= DENO_548_549_HIT THEN DENO_548_549_HIT*50+((TARGET*2 )-DENO_548_549_HIT)*30\n                 ELSE 0 END\n     WHEN CLUSTER_NAME !='West Cluster' AND ACH_PER >= 100 THEN (DENO_548_549_HIT*50)+(DENO_397_HIT*30)\n     WHEN CLUSTER_NAME !='West Cluster' AND ACH_PER >= 90 THEN (DENO_548_549_HIT*40)+(DENO_397_HIT*20)\n     ELSE 0 END AS COMMISSION_AMOUNT\nFROM DENO_WISE_COUNT CC\n)\n--SELECT * FROM RET_WISE_PERCENTAGE;-- 328  Rows\nSELECT SUM(COMMISSION_AMOUNT) TOTAL_COMMISSION FROM RET_WISE_PERCENTAGE;-- 3804790 TAKA\n\nSELECT * FROM TEMP_FOR_DD_SS_DET_10_15MAY25;-- 328  Rows\nSELECT SUM(COMMISSION_AMOUNT) FROM TEMP_FOR_DD_SS_DET_10_15MAY25;--   3804790  5958820        5231890           404490   TK\n\nSELECT * FROM TEMP_FOR_DD_DN_DET2_10_15MAY25;--  72809  Rows  98700  Rows MSISDN DETAILS\n\n\n-------------------------SETUP---------------\n\nSELECT APP.REPORT_NAME, CT.CHANNELTYPE, APP.CHANNEL_TYPE_ID\nFROM REPORT_APPROVAL APP \nINNER JOIN CHANNELTYPE CT ON CT.CHANNELTYPEID = APP.CHANNEL_TYPE_ID\nWHERE APP.REPORT_NAME = 'Distributor Sniper Strike_BDT 397_548_549_10th to 15th May25';\n--CHANNEL_TYPE_ID   1\n\n--EXEC ADHOC_REPORT_SETUP('Distributor Sniper Strike_BDT 397_548_549_10th to 15th May25', 'Nov_24', 'Nov_24', 1, '12-Nov-24', '12-Nov-24', '', '13-NOV-24');\n\n-- 7873 9954 64074\nSELECT * FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Sniper Strike_BDT 397_548_549_10th to 15th May25';\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'May_25'; --base month\nSELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS where REPORTID = 7873 and  CYCLEID = 9954;--64074\n\nSELECT * FROM AD_HOC_DATA WHERE REPORT_CYCLE_ID = 64074;\n--delete from ad_hoc_data where REPORT_CYCLE_ID = 64074;\n--commit;\n\nINSERT INTO AD_HOC_DATA (ID, REPORT_CYCLE_ID, CHANNEL_CODE,COMMISSION_AMOUNT)\nSELECT /*+ parallel(16) */  AD_HOC_DATA_ID.nextval id, 64074 REPORT_CYCLE_ID, DD_CODE, COMMISSION_AMOUNT\nFROM (\nSELECT * FROM TEMP_FOR_DD_SS_DET_10_15MAY25\n);\nCOMMIT;\n\nSELECT SUM(COMMISSION_AMOUNT) FROM ad_hoc_data where REPORT_CYCLE_ID = 64074; -- 3804790   TAKA\n\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'May_25'; --Publish month --9954\n \n--EXEC PROC_COMMISSION_DETAIL_SETUP('Distributor Sniper Strike_BDT 397_548_549_10th to 15th May25',9954,'TEMP_FOR_DD_SS_DET_10_15MAY25','SUMMERY_DETAIL','TEMP_FOR_DD_DN_DET2_10_15MAY25','MSISDN_DETAIL');\n \n--EXEC FINALIZE_REPORT_ADHOC('Distributor Sniper Strike_BDT 397_548_549_10th to 15th May25', 64074,'May_25', 'May_25',290, 1);\n\n\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Sniper Strike_BDT 397_548_549_1st to 6th Jun25\n\n**Commission Name:** Distributor Sniper Strike_BDT 397_548_549_1st to 6th Jun25  \n**Start Date:** 1-Jun-2025  \n**End Date:** 6-Jun-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges)  \n- **Target:** Distributor will be given Deno HIT targets (provided by B2C).  \n- **Mapping:** Agent list of 5th Jun’25 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno (397, 548, 549) will be considered for performance calculation.  \n    - **West Cluster:**  \n        - Upon achieving 100% Deno HIT target (Cumulative of DENO), Distributor will be given:  \n            - BDT 50 incentives per HIT.  \n        - Upon achieving 90% to 99% Deno HIT target (Cumulative of DENO), Distributor will be given:  \n            - BDT 40 incentives per HIT.  \n    - **North, East, Central, North East Clusters:**  \n        - Upon achieving 100% Deno HIT target (Cumulative of DENO), Distributor will be given:  \n            - BDT 50 incentives per HIT for Deno 548 and 549.  \n            - BDT 30 incentives per HIT for Deno 397.  \n        - Upon achieving 90% to 99% Deno HIT target (Cumulative of DENO), Distributor will be given:  \n            - BDT 40 incentives per HIT for Deno 548 and 549.  \n            - BDT 20 incentives per HIT for Deno 397.  \n    - Incentives are capped up to 200% achievement.  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, HIT Target Achievement %, Incentive Amount  \n- **Detail 2:** DD Code, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n```", "sql": "-------------------------------HELPER QUERY------------------------------------\n-- 7451 9574 61612\n\n--CREATE TABLE TEMP_FOR_DENO_CAM_TAR_6JUN25 AS\n--select CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET \n--WHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \n--where REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Sniper Strike_BDT 397_548_549_1st to 6th Jun25') and  \n--CYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jun_25'));--341  Rows\n\nSELECT * FROM TEMP_FOR_DENO_CAM_TAR_6JUN25;--338  Rows\n\n--DROP TABLE TEMP_FOR_AG_LST_MAP_6_MAY25 PURGE;\nCREATE TABLE TEMP_FOR_AG_LST_MAP_6_MAY25 AS\nSELECT TAR.*,AG.RET_CODE RETAILER_CODE, AG.RET_MOBILE RET_MSISDN \nFROM TEMP_FOR_DENO_CAM_TAR_6JUN25 TAR \nINNER JOIN DD_RSO_RET_MAPPING_DAILY AG ON AG.DD_CODE=TAR.DD_CODE AND AG.DATA_DATE = '5-JUN-25';--561446  Rows DATE CONFIRMED WITH KHAIRUL BHAI\n\nSELECT DISTINCT CLUSTER_NAME FROM TEMP_FOR_AG_LST_MAP_6_MAY25;--557087  Rows       554713  Rows               552507  Rows\nSELECT * FROM EV_RECHARGE_COM_DAILY;\n\n--DROP TABLE TEMP_FOR_DD_SS_DET_6_JUN25 PURGE;\nCREATE TABLE TEMP_FOR_DD_DN_DET2_6_JUN25 AS\n--CREATE TABLE TEMP_FOR_DD_SS_DET_6_JUN25 AS\nWITH RSO_WISE_ACHIEVEMENT AS ( \n    SELECT /*+ parallel(10) */ CLUSTER_NAME,AG.DD_CODE,AG.TARGET, RECHARGE_AMOUNT,SUB_MSISDN CUSTOMER_MSISDN,\n    CASE WHEN RECHARGE_AMOUNT IN (548,549) THEN 1 ELSE 0 END AS DENO_548_549,\n    CASE WHEN RECHARGE_AMOUNT IN (397) THEN 1 ELSE 0 END AS DENO_397\n    FROM TEMP_FOR_AG_LST_MAP_6_MAY25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '1-JUN-25' AND '5-JUN-25') AND EV.RECHARGE_AMOUNT IN (397,548,549)\n    AND CLUSTER_NAME NOT IN ('West Cluster')\n    \n    UNION ALL\n    \n    SELECT /*+ parallel(10) */ CLUSTER_NAME,AG.DD_CODE,AG.TARGET, RECHARGE_AMOUNT,SUB_MSISDN CUSTOMER_MSISDN,\n    CASE WHEN RECHARGE_AMOUNT IN (548,549) THEN 1 ELSE 0 END AS DENO_548_549,\n    CASE WHEN RECHARGE_AMOUNT IN (397) THEN 1 ELSE 0 END AS DENO_397\n    FROM TEMP_FOR_AG_LST_MAP_6_MAY25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '1-JUN-25' AND '6-JUN-25') AND EV.RECHARGE_AMOUNT IN (397,548,549)\n    AND CLUSTER_NAME IN ('West Cluster')\n)\nSELECT * FROM RSO_WISE_ACHIEVEMENT;-- msisdn details\n,DENO_WISE_COUNT AS (\nSELECT  CLUSTER_NAME,DD_CODE, TARGET, COUNT(*) HIT,ROUND(COUNT(*)*100/TARGET) ACH_PER,SUM(DENO_548_549) DENO_548_549_HIT, SUM(DENO_397) DENO_397_HIT\nFROM RSO_WISE_ACHIEVEMENT ACH\nGROUP BY CLUSTER_NAME,DD_CODE, TARGET\n)\n--SELECT * from DENO_WISE_COUNT;--335  Rows\n,RET_WISE_PERCENTAGE AS (\nSELECT CC.*,\nCASE WHEN CLUSTER_NAME ='West Cluster' AND ACH_PER >= 200 THEN (TARGET*2)* 50\n     WHEN CLUSTER_NAME ='West Cluster' AND ACH_PER >= 100 THEN HIT* 50\n     WHEN CLUSTER_NAME ='West Cluster' AND ACH_PER >= 90 THEN HIT* 40\n      WHEN CLUSTER_NAME !='West Cluster' AND ACH_PER >= 200 THEN \n            CASE WHEN TARGET*2 <= DENO_548_549_HIT THEN TARGET*2 *50\n                 WHEN TARGET*2 >= DENO_548_549_HIT THEN (DENO_548_549_HIT *50)+(((TARGET*2 )-DENO_548_549_HIT)*30)\n                 ELSE 0 END\n     WHEN CLUSTER_NAME !='West Cluster' AND ACH_PER >= 100 THEN (DENO_548_549_HIT*50)+(DENO_397_HIT*30)\n     WHEN CLUSTER_NAME !='West Cluster' AND ACH_PER >= 90 THEN (DENO_548_549_HIT*40)+(DENO_397_HIT*20)\n     ELSE 0 END AS COMMISSION_AMOUNT\nFROM DENO_WISE_COUNT CC\n)\nSELECT * FROM RET_WISE_PERCENTAGE;--335  Rows\nSELECT SUM(COMMISSION_AMOUNT) TOTAL_COMMISSION FROM RET_WISE_PERCENTAGE;--3433140          5231890 TAKA  RAJBOG23\n\nSELECT * FROM TEMP_FOR_DD_SS_DET_6_JUN25;--335  Rows\nSELECT SUM(COMMISSION_AMOUNT) FROM TEMP_FOR_DD_SS_DET_6_JUN25;--2202020            3433140       5231890           404490   TK\n\nSELECT * FROM TEMP_FOR_DD_DN_DET2_6_JUN25;--335  Rows  62463  Rows    Rows MSISDN DETAILS\n\n-----------------------SETUP-------------------\n\nSELECT APP.REPORT_NAME, CT.CHANNELTYPE, APP.CHANNEL_TYPE_ID\nFROM REPORT_APPROVAL APP \nINNER JOIN CHANNELTYPE CT ON CT.CHANNELTYPEID = APP.CHANNEL_TYPE_ID\nWHERE APP.REPORT_NAME = 'Distributor Sniper Strike_BDT 397_548_549_1st to 6th Jun25';\n--CHANNEL_TYPE_ID   1\n\n--EXEC ADHOC_REPORT_SETUP('Distributor Sniper Strike_BDT 397_548_549_1st to 6th Jun25', 'Nov_24', 'Nov_24', 1, '12-Nov-24', '12-Nov-24', '', '13-NOV-24');\n\n-- 7985 10074 64616\nSELECT * FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Sniper Strike_BDT 397_548_549_1st to 6th Jun25';\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jun_25'; --base month\nSELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS where REPORTID = 7985 and  CYCLEID = 10074;--64616\n\nSELECT * FROM AD_HOC_DATA WHERE REPORT_CYCLE_ID = 64616;\n--delete from ad_hoc_data where REPORT_CYCLE_ID = 64616;\n--commit;\n\nINSERT INTO AD_HOC_DATA (ID, REPORT_CYCLE_ID, CHANNEL_CODE,COMMISSION_AMOUNT)\nSELECT /*+ parallel(16) */  AD_HOC_DATA_ID.nextval id, 64616 REPORT_CYCLE_ID, DD_CODE, COMMISSION_AMOUNT\nFROM (\nSELECT * FROM TEMP_FOR_DD_SS_DET_6_JUN25\n);\nCOMMIT;\n\nSELECT SUM(COMMISSION_AMOUNT) FROM ad_hoc_data where REPORT_CYCLE_ID = 64616; --2202020        3433140            5231890   TAKA\n\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jun_25'; --Publish month --10074\n \nEXEC PROC_COMMISSION_DETAIL_SETUP('Distributor Sniper Strike_BDT 397_548_549_1st to 6th Jun25',10074,'TEMP_FOR_DD_SS_DET_6_JUN25','SUMMERY_DETAIL','TEMP_FOR_DD_DN_DET2_6_JUN25','MSISDN_DETAIL');\n \nEXEC FINALIZE_REPORT_ADHOC('Distributor Sniper Strike_BDT 397_548_549_1st to 6th Jun25', 64616,'Jun_25', 'Jun_25',290, 1);\n\n\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Sniper Strike_BDT 397_548_549_1st to 8th May25_Revision\n\n**Commission Name:** Distributor Sniper Strike_BDT 397_548_549_1st to 8th May25_Revision  \n**Start Date:** 1-May-2025  \n**End Date:** 8-May-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges)\n- **Target:** Distributor will be given Deno HIT targets (provided by B2C).  \n- **Mapping:** Agent list of 8th May’25 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno (397, 548, 549) will be considered for performance calculation.  \n    - **West Cluster:**  \n        - Upon achieving 100% Deno HIT target (Cumulative of DENO), Distributor will be given BDT 60 incentives per HIT.  \n        - Upon achieving 90% to 99% Deno HIT target (Cumulative of DENO), Distributor will be given BDT 50 incentives per HIT.  \n    - **North, East, Central, North East Clusters:**  \n        - Upon achieving 100% Deno HIT target (Cumulative of DENO):  \n            - BDT 60 incentives per HIT for Deno 548 and 549.  \n            - BDT 40 incentives per HIT for Deno 397.  \n        - Upon achieving 90% to 99% Deno HIT target (Cumulative of DENO):  \n            - BDT 50 incentives per HIT for Deno 548 and 549.  \n            - BDT 30 incentives per HIT for Deno 397.  \n    - Incentives are capped up to 200% achievement.  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, HIT Target Achievement %, Incentive Amount  \n- **Detail 2:** DD Code, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n```", "sql": "-------------------------------HELPER QUERY------------------------------------\n-- 7451 9574 61612\n\n--CREATE TABLE TEMP_FOR_DENO_CAM_TAR_8MAY25 AS\n--select CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET \n--WHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \n--where REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Sniper Strike_BDT 397_548_549_1st to 8th May25') and  \n--CYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'May_25'));--341  Rows\n\nSELECT * FROM TEMP_FOR_DENO_CAM_TAR_8MAY25;-- 337  Rows\n\n--DROP TABLE TEMP_FOR_AG_LST_MAP_8_MAY25 PURGE;\n--CREATE TABLE TEMP_FOR_AG_LST_MAP_8_MAY25 AS\nSELECT TAR.*,AG.RET_CODE RETAILER_CODE, AG.RET_MOBILE RET_MSISDN \nFROM TEMP_FOR_DENO_CAM_TAR_8MAY25 TAR \nINNER JOIN DD_RSO_RET_MAPPING_DAILY AG ON AG.DD_CODE=TAR.DD_CODE AND AG.DATA_DATE = '8-MAY-25';--561446  Rows\n\nSELECT DISTINCT CLUSTER_NAME FROM TEMP_FOR_AG_LST_MAP_8_MAY25;-- 5  Rows\nSELECT * FROM TEMP_FOR_AG_LST_MAP_8_MAY25; -- 554713  Rows\nSELECT * FROM EV_RECHARGE_COM_DAILY;\n\n--DROP TABLE TEMP_FOR_DD_DN_DET2_8_MAY25 PURGE;\n--CREATE TABLE TEMP_FOR_DD_DN_DET2_8_MAY25 AS\n--DROP TABLE TEMP_FOR_DD_SS_DET_8_MAY25 PURGE;\n--CREATE TABLE TEMP_FOR_DD_SS_DET_8_MAY25 AS\nWITH RSO_WISE_ACHIEVEMENT AS ( \n    SELECT /*+ parallel(10) */ CLUSTER_NAME,AG.DD_CODE,AG.TARGET, RECHARGE_AMOUNT,SUB_MSISDN CUSTOMER_MSISDN,\n    CASE WHEN RECHARGE_AMOUNT IN (548,549) THEN 1 ELSE 0 END AS DENO_548_549,\n    CASE WHEN RECHARGE_AMOUNT IN (397) THEN 1 ELSE 0 END AS DENO_397\n    FROM TEMP_FOR_AG_LST_MAP_8_MAY25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '1-MAY-25' AND '8-MAY-25') AND EV.RECHARGE_AMOUNT IN (397,548,549)\n--    AND SERVICE_CLASS_ID NOT IN (141) \n--    AND NOT EXISTS(SELECT MOBILENO FROM VW_EMPLOYEESALESCOM_MONTHLY VE WHERE VE.DATE_DATE='1-JAN-24' AND VE.MOBILENO=EV.SUB_MSISDN)\n--    GROUP BY AG.DD_CODE,  AG.TARGET\n)\n--SELECT * FROM RSO_WISE_ACHIEVEMENT;-- 98713  Rows\n,DENO_WISE_COUNT AS (\nSELECT  CLUSTER_NAME,DD_CODE, TARGET, COUNT(*) HIT,ROUND(COUNT(*)*100/TARGET) ACH_PER,SUM(DENO_548_549) DENO_548_549_HIT, SUM(DENO_397) DENO_397_HIT\nFROM RSO_WISE_ACHIEVEMENT ACH\nGROUP BY CLUSTER_NAME,DD_CODE, TARGET\n)\n--SELECT * from DENO_WISE_COUNT; --329  Rows\n,RET_WISE_PERCENTAGE AS (\nSELECT CC.*,\nCASE WHEN CLUSTER_NAME ='West Cluster' AND ACH_PER >= 200 THEN (TARGET*2)* 60\n     WHEN CLUSTER_NAME ='West Cluster' AND ACH_PER >= 100 THEN HIT* 60\n     WHEN CLUSTER_NAME ='West Cluster' AND ACH_PER >= 90 THEN HIT* 50\n      WHEN CLUSTER_NAME !='West Cluster' AND ACH_PER >= 200 THEN \n            CASE WHEN TARGET*2 <= DENO_548_549_HIT THEN TARGET*2 *60\n                 WHEN TARGET*2 >= DENO_548_549_HIT THEN DENO_548_549_HIT*60+((TARGET*2 )-DENO_548_549_HIT)*40\n                 ELSE 0 END\n     WHEN CLUSTER_NAME !='West Cluster' AND ACH_PER >= 100 THEN (DENO_548_549_HIT*60)+(DENO_397_HIT*40)\n     WHEN CLUSTER_NAME !='West Cluster' AND ACH_PER >= 90 THEN (DENO_548_549_HIT*50)+(DENO_397_HIT*30)\n     ELSE 0 END AS COMMISSION_AMOUNT\nFROM DENO_WISE_COUNT CC\n)\n--SELECT * FROM RET_WISE_PERCENTAGE;--329  Rows\nSELECT SUM(COMMISSION_AMOUNT) TOTAL_COMMISSION FROM RET_WISE_PERCENTAGE;-- 5327040 TAKA\n\nSELECT * FROM TEMP_FOR_DD_SS_DET_8_MAY25;--329  Rows\nSELECT SUM(COMMISSION_AMOUNT) FROM TEMP_FOR_DD_SS_DET_8_MAY25;-- 5327040   TK\n\nSELECT * FROM TEMP_FOR_DD_DN_DET2_8_MAY25;-- 98713  Rows  Rows MSISDN DETAILS\n\n--------------------------SETUP-----------------\n\nSELECT APP.REPORT_NAME, CT.CHANNELTYPE, APP.CHANNEL_TYPE_ID\nFROM REPORT_APPROVAL APP \nINNER JOIN CHANNELTYPE CT ON CT.CHANNELTYPEID = APP.CHANNEL_TYPE_ID\nWHERE APP.REPORT_NAME = 'Distributor Sniper Strike_BDT 397_548_549_1st to 8th May25_Revision';\n--CHANNEL_TYPE_ID   1\n\n--EXEC ADHOC_REPORT_SETUP('Distributor Sniper Strike_BDT 397_548_549_1st to 8th May25_Revision', 'Nov_24', 'Nov_24', 1, '12-Nov-24', '12-Nov-24', '', '13-NOV-24');\n\n-- 7904 9954 64242\nSELECT * FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Sniper Strike_BDT 397_548_549_1st to 8th May25_Revision';\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'May_25'; --base month\nSELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS where REPORTID = 7904 and  CYCLEID = 9954;--64242\n\nSELECT * FROM AD_HOC_DATA WHERE REPORT_CYCLE_ID = 64242;\n--delete from ad_hoc_data where REPORT_CYCLE_ID = 64242;\n--commit;\n\nINSERT INTO AD_HOC_DATA (ID, REPORT_CYCLE_ID, CHANNEL_CODE,COMMISSION_AMOUNT)\nSELECT /*+ parallel(16) */  AD_HOC_DATA_ID.nextval id, 64242 REPORT_CYCLE_ID, DD_CODE, COMMISSION_AMOUNT\nFROM (\nSELECT * FROM TEMP_FOR_DD_SS_DET_8_MAY25\n);\nCOMMIT;\n\nSELECT SUM(COMMISSION_AMOUNT) FROM ad_hoc_data where REPORT_CYCLE_ID = 64242; -- 5327040   TAKA\n\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'May_25'; --Publish month --9954\n \n--EXEC PROC_COMMISSION_DETAIL_SETUP('Distributor Sniper Strike_BDT 397_548_549_1st to 8th May25_Revision',9954,'TEMP_FOR_DD_SS_DET_8_MAY25','SUMMERY_DETAIL','TEMP_FOR_DD_DN_DET2_8_MAY25','MSISDN_DETAIL');\n \n--EXEC FINALIZE_REPORT_ADHOC('Distributor Sniper Strike_BDT 397_548_549_1st to 8th May25_Revision', 64242,'May_25', 'May_25',290, 1);\n\n\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Sniper Strike_BDT 397_548_549_23rd to 30th Jun25\n\n**Commission Name:** Distributor Sniper Strike_BDT 397_548_549_23rd to 30th Jun25  \n**Start Date:** 23-Jun-2025  \n**End Date:** 30-Jun-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges)  \n- **Target:** Distributor will be given Deno HIT targets (provided by B2C).  \n- **Mapping:** Agent list of 30th Jun’25 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno (397, 548, 549) will be considered for performance calculation.  \n    - **West Cluster:**  \n        - Upon achieving 100% Deno HIT target (Cumulative of DENO), Distributor will be given BDT 50 incentives per HIT.  \n        - Upon achieving 90% to 99% Deno HIT target (Cumulative of DENO), Distributor will be given BDT 40 incentives per HIT.  \n    - **North, East, Central, North East Clusters:**  \n        - Upon achieving 100% Deno HIT target (Cumulative of DENO):  \n            - BDT 50 incentives per HIT for Deno 548 and 549.  \n            - BDT 30 incentives per HIT for Deno 397.  \n        - Upon achieving 90% to 99% Deno HIT target (Cumulative of DENO):  \n            - BDT 40 incentives per HIT for Deno 548 and 549.  \n            - BDT 20 incentives per HIT for Deno 397.  \n    - Incentives are capped up to 200% achievement.  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, HIT Target Achievement %, Incentive Amount  \n- **Detail 2:** DD Code, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n```", "sql": "-------------------------------HELPER QUERY------------------------------------\n--CREATE TABLE SNIPPER_23_30_JUN25_64962 AS\n--select CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET \n--WHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \n--where REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Sniper Strike_BDT 397_548_549_1st to 8th May25') and  \n--CYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'May_25'));--341  Rows\n\nSELECT * FROM SNIPPER_23_30_JUN25_64962;-- 337  Rows\n\n--DROP TABLE TEMP_FOR_AG_LIST_DET_30JUN25 PURGE;\n--CREATE TABLE TEMP_FOR_AG_LIST_DET_30JUN25 AS\nSELECT TAR.*,AG.RET_CODE RETAILER_CODE, AG.RET_MOBILE RET_MSISDN \nFROM SNIPPER_23_30_JUN25_64962 TAR \nINNER JOIN DD_RSO_RET_MAPPING_DAILY AG ON AG.DD_CODE=TAR.DD_CODE AND AG.DATA_DATE = '30-JUN-25';\n\nSELECT CLUSTER_NAME,COUNT(*)FROM TEMP_FOR_AG_LIST_DET_30JUN25 GROUP BY CLUSTER_NAME;-- 557208  Rows 555867  Rows\nSELECT * FROM EV_RECHARGE_COM_DAILY;\nSELECT * FROM TEMP_FOR_DD_SS_DET_23_30JUN25;\nSELECT * FROM TEMP_FOR_DD_DN_DET2_23_30JUN25;\n\n--DROP TABLE TEMP_FOR_DD_DN_DET2_23_30JUN25 PURGE;\n--CREATE TABLE TEMP_FOR_DD_DN_DET2_23_30JUN25 AS\n--DROP TABLE TEMP_FOR_DD_SS_DET_23_30JUN25 PURGE;\n--CREATE TABLE TEMP_FOR_DD_SS_DET_23_30JUN25 AS\nWITH RSO_WISE_ACHIEVEMENT AS ( \n    SELECT /*+ parallel(10) */ CLUSTER_NAME,AG.DD_CODE,AG.HIT_TGT TARGET, RECHARGE_AMOUNT,SUB_MSISDN CUSTOMER_MSISDN,TOP_UP_DATE,\n    CASE WHEN RECHARGE_AMOUNT IN (548,549) THEN 1 ELSE 0 END AS DENO_548_549,\n    CASE WHEN RECHARGE_AMOUNT IN (397) THEN 1 ELSE 0 END AS DENO_397\n    FROM TEMP_FOR_AG_LIST_DET_30JUN25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '24-JUN-25' AND '30-JUN-25') AND EV.RECHARGE_AMOUNT IN (397,548,549)\n    AND CLUSTER_NAME IN('Central Cluster','West Cluster','East Cluster','North Cluster','North East Cluster')\n    \n    UNION ALL\n    SELECT /*+ parallel(10) */ CLUSTER_NAME,AG.DD_CODE,AG.HIT_TGT TARGET, RECHARGE_AMOUNT,SUB_MSISDN CUSTOMER_MSISDN,TOP_UP_DATE,\n    CASE WHEN RECHARGE_AMOUNT IN (548,549) THEN 1 ELSE 0 END AS DENO_548_549,\n    CASE WHEN RECHARGE_AMOUNT IN (397) THEN 1 ELSE 0 END AS DENO_397\n    FROM TEMP_FOR_AG_LIST_DET_30JUN25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '23-JUN-25' AND '23-JUN-25') \n    AND EV.RECHARGE_AMOUNT IN (397,548,549)\n    AND CLUSTER_NAME IN('East Cluster', 'North Cluster','North East Cluster')\n)\n--SELECT * FROM RSO_WISE_ACHIEVEMENT;-- 97118  Rows 72809  Rows TEMP_FOR_DD_DN_DET2_23_30JUN25\n,DENO_WISE_COUNT AS (\nSELECT  CLUSTER_NAME,DD_CODE, TARGET, COUNT(*) HIT,ROUND(COUNT(*)*100/TARGET) ACH_PER,SUM(DENO_548_549) DENO_548_549_HIT, SUM(DENO_397) DENO_397_HIT\nFROM RSO_WISE_ACHIEVEMENT ACH\nGROUP BY CLUSTER_NAME,DD_CODE, TARGET\n)\n--SELECT * from DENO_WISE_COUNT;  -- 335  Rows 328  Rows\n,RET_WISE_PERCENTAGE AS (\nSELECT CC.*,\nCASE WHEN CLUSTER_NAME ='West Cluster' AND ACH_PER >= 200 THEN (TARGET*2)* 50\n     WHEN CLUSTER_NAME ='West Cluster' AND ACH_PER >= 100 THEN HIT* 50\n     WHEN CLUSTER_NAME ='West Cluster' AND ACH_PER >= 90 THEN HIT* 40\n      WHEN CLUSTER_NAME !='West Cluster' AND ACH_PER >= 200 THEN \n            CASE WHEN TARGET*2 <= DENO_548_549_HIT THEN TARGET*2 *50\n                 WHEN TARGET*2 >= DENO_548_549_HIT THEN DENO_548_549_HIT*50+((TARGET*2 )-DENO_548_549_HIT)*30\n                 ELSE 0 END\n     WHEN CLUSTER_NAME !='West Cluster' AND ACH_PER >= 100 THEN (DENO_548_549_HIT*50)+(DENO_397_HIT*30)\n     WHEN CLUSTER_NAME !='West Cluster' AND ACH_PER >= 90 THEN (DENO_548_549_HIT*40)+(DENO_397_HIT*20)\n     ELSE 0 END AS COMMISSION_AMOUNT\nFROM DENO_WISE_COUNT CC\n)\nSELECT * FROM RET_WISE_PERCENTAGE;-- 335  Rows 328  Rows\nSELECT SUM(COMMISSION_AMOUNT) TOTAL_COMMISSION FROM RET_WISE_PERCENTAGE;-- 40,06,870 TAKA\n\nSELECT * FROM TEMP_FOR_DD_SS_DET_23_30JUN25;-- 335  Rows\nSELECT SUM(COMMISSION_AMOUNT) FROM TEMP_FOR_DD_SS_DET_23_30JUN25;--   4006870 TK 3804790 TK\n\nSELECT * FROM TEMP_FOR_DD_DN_DET2_23_30JUN25;--  97118  Rows 72809  Rows MSISDN DETAILS\n\n---------------------SETUP--------------\nSELECT APP.REPORT_NAME, CT.CHANNELTYPE, APP.CHANNEL_TYPE_ID\nFROM REPORT_APPROVAL APP \nINNER JOIN CHANNELTYPE CT ON CT.CHANNELTYPEID = APP.CHANNEL_TYPE_ID\nWHERE APP.REPORT_NAME = 'Distributor Sniper Strike_BDT 397_548_549_23rd to 30th Jun25';\n--CHANNEL_TYPE_ID   1\n\n--EXEC ADHOC_REPORT_SETUP('Distributor Sniper Strike_BDT 397_548_549_23rd to 30th Jun25', 'Nov_24', 'Nov_24', 1, '12-Nov-24', '12-Nov-24', '', '13-NOV-24');\n\n-- 8065 10074 64962\nSELECT * FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Sniper Strike_BDT 397_548_549_23rd to 30th Jun25';\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jun_25'; --base month\nSELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS where REPORTID = 8065 and  CYCLEID = 10074;--64962\n\nSELECT * FROM AD_HOC_DATA WHERE REPORT_CYCLE_ID = 64962;\n--delete from ad_hoc_data where REPORT_CYCLE_ID = 64962;\n--commit;\n\nINSERT INTO AD_HOC_DATA (ID, REPORT_CYCLE_ID, CHANNEL_CODE,COMMISSION_AMOUNT)\nSELECT /*+ parallel(16) */  AD_HOC_DATA_ID.nextval id, 64962 REPORT_CYCLE_ID, DD_CODE, COMMISSION_AMOUNT\nFROM (\nSELECT * FROM TEMP_FOR_DD_SS_DET_23_30JUN25\n);\nCOMMIT;\n\nSELECT SUM(COMMISSION_AMOUNT) FROM ad_hoc_data where REPORT_CYCLE_ID = 64962; -- 4006870   TAKA\n\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jul_25'; --Publish month --10174\n \n--EXEC PROC_COMMISSION_DETAIL_SETUP('Distributor Sniper Strike_BDT 397_548_549_23rd to 30th Jun25',10174,'TEMP_FOR_DD_SS_DET_23_30JUN25','SUMMERY_DETAIL','TEMP_FOR_DD_DN_DET2_23_30JUN25','MSISDN_DETAIL');\n \n--EXEC FINALIZE_REPORT_ADHOC('Distributor Sniper Strike_BDT 397_548_549_23rd to 30th Jun25', 64962,'Jun_25', 'Jul_25',290, 1);\n\n"}
{"srf": "```markdown\n# Commission Business Logics: Distributor Sniper Strike_BDT 548_549_7th to 12th Apr25\n\n**Commission Name:** Distributor Sniper Strike_BDT 548_549_7th to 12th Apr25  \n**Start Date:** 7-Apr-2025  \n**End Date:** 12-Apr-2025  \n**Commission Receiver Channel:** Distributor  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges) \n- **Target:** Distributor will be given Deno HIT targets (provided by B2C).  \n- **Mapping:** Agent list of 12th Apr’25 will be considered.  \n- **Calculation Logics:**  \n    - Selected Deno (548, 549) will be considered for performance calculation.  \n    - Upon achieving 100% Deno HIT target (Cumulative of DENO), Distributor will be given BDT 50 incentives per HIT.  \n    - Upon achieving 90% to 99% Deno HIT target (Cumulative of DENO), Distributor will be given BDT 40 incentives per HIT.  \n    - Incentives are capped up to 200% achievement.  \n    - General mathematical rounding: below 0.5 will be rounded down, ≥0.5 rounded up for achievement calculation.  \n\n**Detail formats:**  \n- **Detail 1:** DD_CODE, Target, HIT Target Achievement %, Incentive Amount  \n- **Detail 2:** DD Code, Retailer Code, Retailer MSISDN, Customer MSISDN, Deno Amount  \n```", "sql": "-------------------------------HELPER QUERY------------------------------------\nCREATE TABLE TEMP_FOR_DENO_CAMP_TAR_7_12_APR25 AS\nselect CHANNEL_CODE DD_CODE, TARGET from COM_KPI_CONDITION_TARGET \nWHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \nwhere REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Sniper Strike_BDT 548_549_7th to 12th Apr25') and  \nCYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Apr_25'));\n\n--drop table TEMP_FOR_DENO_CAMP_TAR_7_12_APR25 purge;\nSELECT * FROM TEMP_FOR_DENO_CAMP_TAR_7_12_APR25;--337  Rows\nupdate TEMP_FOR_DENO_CAMP_TAR_7_12_APR25 set DD_CODE = trim(DD_CODE);\ncommit;\nSELECT * FROM DD_RSO_RET_MAPPING_DAILY;\nSELECT * FROM EV_RECHARGE_COM_DAILY;\n\n--DROP TABLE TEMP_FOR_AG_LIST_MAP_12APR25 PURGE;\nCREATE TABLE TEMP_FOR_AG_LIST_MAP_12APR25 AS\nSELECT TAR.*,AG.RET_CODE RETAILER_CODE, AG.RET_MOBILE RET_MSISDN FROM \nTEMP_FOR_DENO_CAMP_TAR_7_12_APR25 TAR \nINNER JOIN DD_RSO_RET_MAPPING_DAILY AG ON AG.DD_CODE=TAR.DD_CODE AND AG.DATA_DATE = '12-APR-25';--236872  Rows\n\nSELECT * FROM TEMP_FOR_AG_LIST_MAP_12APR25;-- 556039  Rows\nselect max(TOP_UP_DATE) from EV_RECHARGE_COM_DAILY;\n\nselect max(DATE_DATE) from VW_EMPLOYEESALESCOM_MONTHLY;\n--DROP TABLE TEMP_FOR_DD_DENO_DAT_7_12APR25 PURGE;\nCREATE TABLE TEMP_FOR_DD_DENO_DAT_7_12APR25 AS\nWITH DD_WISE_ACHIEVEMENT AS ( \n    SELECT AG.DD_CODE,AG.TARGET,COUNT(RECHARGE_AMOUNT) HIT\n    FROM TEMP_FOR_AG_LIST_MAP_12APR25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '7-APR-25' AND '12-APR-25') AND EV.RECHARGE_AMOUNT IN (548,549)\n--    AND SERVICE_CLASS_ID NOT IN (141) \n--    AND NOT EXISTS(SELECT MOBILENO FROM VW_EMPLOYEESALESCOM_MONTHLY VE WHERE VE.DATE_DATE='1-JAN-24' AND VE.MOBILENO=EV.SUB_MSISDN)\n    GROUP BY AG.DD_CODE,  AG.TARGET\n)\n--SELECT * FROM DD_WISE_ACHIEVEMENT; --43  Rows\n,DD_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((HIT/TARGET)*100) ACH_PER\nFROM DD_WISE_ACHIEVEMENT ACHIEVEMENT\n)\n--SELECT * FROM DD_WISE_PERCENTAGE;--43  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT DD_CODE,  TARGET, HIT,ACH_PER,\n    CASE \n    WHEN  ACH_PER >= 200 THEN (TARGET*2)*50\n    WHEN  ACH_PER >= 100 THEN HIT*50 \n    WHEN  ACH_PER >= 90 THEN HIT*40 \n    ELSE 0 \n    END COMMISSION\n    FROM DD_WISE_PERCENTAGE \n)\nSELECT * FROM CALCULATE_COMMISSION;--335  Rows\nSELECT SUM(COMMISSION) FROM CALCULATE_COMMISSION;--16,66,560\n\nSELECT * FROM TEMP_FOR_DD_DENO_DAT_7_12APR25;--335  Rows\nSELECT SUM(COMMISSION) FROM TEMP_FOR_DD_DENO_DAT_7_12APR25;--16,66,560 TK 16,71,790\n\n-------detail---------\nselect * from TEMP_FOR_AG_LIST_MAP_12APR25;\nselect * from EV_RECHARGE_COM_DAILY;\n--drop table TEMP_FOR_DD_DENO_DAT2_7_12_APR25 purge;\nCREATE TABLE TEMP_FOR_DD_DENO_DAT2_7_12_APR25 AS\nWITH DD_WISE_ACHIEVEMENT AS ( \n    SELECT AG.DD_CODE,RETAILER_CODE,RET_MSISDN,SUB_MSISDN CUSTOMER_MSISDN,RECHARGE_AMOUNT\n    FROM TEMP_FOR_AG_LIST_MAP_12APR25 AG \n    INNER JOIN EV_RECHARGE_COM_DAILY EV ON EV.RETAILER_MSISDN = AG.RET_MSISDN   \n    WHERE (EV.TOP_UP_DATE  BETWEEN '7-APR-25' AND '12-APR-25') AND EV.RECHARGE_AMOUNT IN (548,549)\n--    AND SERVICE_CLASS_ID NOT IN (141) \n--    AND NOT EXISTS(SELECT MOBILENO FROM VW_EMPLOYEESALESCOM_MONTHLY VE WHERE VE.DATE_DATE='1-JAN-24' AND VE.MOBILENO=EV.SUB_MSISDN)\n--    GROUP BY AG.DD_CODE,  AG.TARGET\n)\nSELECT * FROM DD_WISE_ACHIEVEMENT;--12815  Rows\nSELECT * FROM TEMP_FOR_DD_DENO_DAT2_7_12_APR25; --46856  Rows\n\n------------------------SETUP----------------------\n\nSELECT APP.REPORT_NAME, CT.CHANNELTYPE, APP.CHANNEL_TYPE_ID\nFROM REPORT_APPROVAL APP \nINNER JOIN CHANNELTYPE CT ON CT.CHANNELTYPEID = APP.CHANNEL_TYPE_ID\nWHERE APP.REPORT_NAME = 'Distributor Sniper Strike_BDT 548_549_7th to 12th Apr25';\n--CHANNEL_TYPE_ID   1\n\n--EXEC ADHOC_REPORT_SETUP('Distributor Sniper Strike_BDT 548_549_7th to 12th Apr25', 'Nov_24', 'Nov_24', 1, '2-Nov-24', '2-Nov-24', '', '3-NOV-24');\n\n-- 7745 9854 63314\nSELECT * FROM COMMISSIONREPORT WHERE REPORTNAME = 'Distributor Sniper Strike_BDT 548_549_7th to 12th Apr25';\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Apr_25'; --base month\nSELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS where REPORTID = 7745 and  CYCLEID = 9854;--63314\n\nSELECT * FROM AD_HOC_DATA WHERE REPORT_CYCLE_ID = 63314;\n--delete from ad_hoc_data where REPORT_CYCLE_ID = 63314;\n--commit;\n\nINSERT INTO AD_HOC_DATA (ID, REPORT_CYCLE_ID, CHANNEL_CODE,COMMISSION_AMOUNT)\nSELECT /*+ parallel(16) */  AD_HOC_DATA_ID.nextval id, 63314 REPORT_CYCLE_ID, DD_CODE, COMMISSION\nFROM (\nSELECT * FROM TEMP_FOR_DD_DENO_DAT_7_12APR25\n);\nCOMMIT;\n\nSELECT SUM(COMMISSION_AMOUNT) FROM ad_hoc_data where REPORT_CYCLE_ID = 63314; -- 1671790 TAKA\n\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Apr_25'; --Publish month --9854\n\n--EXEC PROC_COMMISSION_DETAIL_SETUP('Distributor Sniper Strike_BDT 548_549_7th to 12th Apr25',9854,'TEMP_FOR_DD_DENO_DAT_7_12APR25','SUMMERY_DETAIL','TEMP_FOR_DD_DENO_DAT2_7_12_APR25','MSISDN_DETAIL');\n \n--EXEC FINALIZE_REPORT_ADHOC('Distributor Sniper Strike_BDT 548_549_7th to 12th Apr25', 63314,'Apr_25', 'Apr_25',290, 1);\n\n\n"}
{"srf": "# Commission Business Logics: Retailer Deno Campaign BDT 199_227_348_17th to 18th Jan25  \n**Commission Name:** Retailer Deno Campaign BDT 199_227_348_17th to 18th Jan25  \n**Start Date:** 17-Jan-2025  \n**End Date:** 18-Jan-2025  \n**Commission Receiver Channel:** Retailer  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges)  \n- **Target:** Recharge target cumulative of selected deno  \n- **Mapping:** Retailer MSISDNs (Selected retailer list provided by B2C)  \n- **Commission Calculation Logics:**  \n    - Retailers will receive incentives upon achieving recharge targets for specific deno values.  \n    - Selected Deno:  \n        - 348 (West Cluster)  \n        - 227 (Central Cluster, North Cluster & North East Cluster)  \n        - 199 (East Cluster)  \n    - Incentive amounts will be shared by B2C based on retailer-wise targets.  \n    - General mathematical rounding applies:  \n        - Below 0.5 rounded down.  \n        - Greater than or equal to 0.5 rounded up.  \n    - Valid recharge means I-TOP up.  \n    - All Prepaid & successful MNP considered.  \n\n**Detail formats:**  \n- **Detail 1:** DD, Code Retailer, MSISDN, Recharge Target, Recharge Amount, Incentive Amount  \n- **Detail 2:** DD, Code Retailer, MSISDN Customer, MSISDN Deno Amount, Transaction Date  ", "sql": "-- 7397 9574 61417\nSELECT * FROM COMMISSIONREPORT WHERE REPORTNAME = 'Retailer Deno Campaign BDT 199_227_348_17th to 18th Jan25';\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jan_25'; --base month\nSELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS where REPORTID = 7397 and  CYCLEID = 9574;--61417\n\n-- *** Create TEMP TARGET Table *** \n--CREATE TABLE TEMP_FOR_RET_TAR_17_18JAN25 AS\n--SELECT CHANNEL_CODE RETAILER_CODE, TARGET FROM COM_KPI_CONDITION_TARGET where REPORTCYCLE_ID = 61417;\n\n--drop table TEMP_FOR_RET_TAR_17_18JAN25 purge;\nSELECT * FROM TEMP_FOR_RET_TAR_17_18JAN25; --222941  Rows\n \n-------------------------------HELPER QUERY------------------------------------\nselect * from EV_RECHARGE_COM_DAILY WHERE RECHARGE_AMOUNT=348;\n--CREATE TABLE TEMP_FOR_AG_LIST_MAP_16_JAN25 AS\n--SELECT TAR.*, AG.RET_MOBILE RET_MSISDN \n--FROM TEMP_FOR_RET_TAR_17_18JAN25 TAR \n--INNER JOIN DD_RSO_RET_MAPPING_DAILY AG ON AG.RET_CODE=TAR.RETAILER_CODE AND AG.DATA_DATE = '18-JAN-25';--569264  Rows\n\nselect * from DD_RSO_RET_MAPPING_DAILY;\nselect * from TEMP_FOR_AG_LIST_MAP_16_JAN25; --222155  Rows\n\ncreate table TEMP_FOR_EV_DET_14_16JAN25 AS\nSELECT * FROM EV_RECHARGE_COM_DAILY WHERE TOP_UP_DATE BETWEEN '17-JAN-25' AND '18-JAN-25';\n\nSELECT DISTINCT CLUSTER_NAME, RECHARGE_AMOUNT FROM TEMP_FOR_RET_COM_CAL2_17_18JAN25; --5643488  Rows\nSELECT * FROM TEMP_FOR_RET_COM_CAL2_17_18JAN25; --4836  Rows\n\n--create table TEMP_FOR_RET_COM_CAL2_17_18JAN25 as\n--drop table TEMP_FOR_RET_COM_CAL_17_18JAN25 purge;\n--CREATE TABLE TEMP_FOR_RET_COM_CAL_17_18JAN25 AS\nWITH DENO_WISE_PERTICEPATION AS (\n    SELECT /*+ parallel(16) */TAR.CLUSTER_NAME,TAR.RET_MSISDN,TAR.RET_CODE,RECHARGE.SUB_MSISDN,RECHARGE_AMOUNT,TAR.TARGET,INCENTIVE\n    FROM EV_RECHARGE_COM_DAILY RECHARGE\n    INNER JOIN TEMP_FOR_RET_TAR_17_18JAN25 TAR ON TAR.RET_MSISDN = RECHARGE.RETAILER_MSISDN AND RECHARGE_AMOUNT=TAR.DENO\n    WHERE RECHARGE.TOP_UP_DATE BETWEEN '17-JAN-25' AND '18-JAN-25'\n--    AND RECHARGE.RECHARGE_AMOUNT IN (348)\n    )\n--SELECT * FROM DENO_WISE_PERTICEPATION;--TEMP_FOR_RET_COM_CAL2_17_18JAN25 detail --408  Rows\n,RET_WISE_ACHIEVEMENT AS (\nSELECT RET_MSISDN,RET_CODE,TARGET,INCENTIVE,SUM(RECHARGE_AMOUNT) ACH\nFROM DENO_WISE_PERTICEPATION PER\nGROUP BY RET_MSISDN,RET_CODE,TARGET,INCENTIVE\n)\n--select * from RET_WISE_ACHIEVEMENT;\n,RET_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((ACH/TARGET)*100) ACH_PER\nFROM RET_WISE_ACHIEVEMENT ACHIEVEMENT\n)\n--SELECT * FROM RET_WISE_PERCENTAGE;--3424  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT RET_MSISDN,RET_CODE,TARGET, ACH,ACH_PER,INCENTIVE,\n    CASE\n        WHEN ACH_PER>=100 THEN INCENTIVE\n        ELSE 0\n    END COMMISSION\n    FROM RET_WISE_PERCENTAGE ACHIEVEMENT\n)\nSELECT * FROM CALCULATE_COMMISSION;--940  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;--10008 TAKA\n\nSELECT SUM(COMMISSION) FROM TEMP_FOR_RET_COM_CAL_17_18JAN25;--10008 TK\n\nSELECT * FROM TEMP_FOR_RET_COM_CAL_17_18JAN25; --4088  Rows\n\n"}
{"srf": "# Commission Business Logics: Retailer Deno Campaign BDT 348_14th to 16th Jan25  \n**Commission Name:** Retailer Deno Campaign BDT 348_14th to 16th Jan25  \n**Start Date:** 14-Jan-2025  \n**End Date:** 16-Jan-2025  \n**Commission Receiver Channel:** Retailer  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges)  \n- **Target:** Recharge target cumulative of selected deno  \n- **Mapping:** Retailer MSISDNs (Selected retailer list provided by B2C)  \n- **Commission Calculation Logics:**  \n    - Retailers will receive incentives upon achieving recharge targets for specific deno values.  \n    - Selected Deno:  \n        - 348  \n    - Incentive amounts: BDT 100 upon achieving the target.  \n    - General mathematical rounding applies:  \n        - Below 0.5 rounded down.  \n        - Greater than or equal to 0.5 rounded up.  \n    - Valid recharge means I-TOP up.  \n    - All Prepaid & successful MNP considered.  \n\n**Detail formats:**  \n- **Detail 1:** DD, Code Retailer, MSISDN, Recharge Target, Recharge Amount, Incentive Amount  \n- **Detail 2:** DD, Code Retailer, MSISDN Customer, MSISDN Deno Amount, Transaction Date  ", "sql": "-- 7364 9574 61272\nSELECT * FROM COMMISSIONREPORT WHERE REPORTNAME = 'Retailer Deno Campaign BDT 348_14th to 16th Jan25';\nSELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Jan_25'; --base month\nSELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS where REPORTID = 7364 and  CYCLEID = 9574;--61272\n\n-- *** Create TEMP TARGET Table *** \n--CREATE TABLE TEMP_FOR_RET_TAR_14_16JAN25 AS\n--SELECT CHANNEL_CODE RETAILER_CODE, TARGET FROM COM_KPI_CONDITION_TARGET where REPORTCYCLE_ID = 61272;\n\n--drop table TEMP_FOR_RET_TAR_14_16JAN25 purge;\nSELECT * FROM TEMP_FOR_RET_TAR_14_16JAN25; --2,22,058  Rows\n \n-------------------------------HELPER QUERY------------------------------------\nselect * from EV_RECHARGE_COM_DAILY WHERE RECHARGE_AMOUNT=348;\n--CREATE TABLE TEMP_FOR_AG_LIST_MAP_16_JAN25 AS\nSELECT TAR.*, AG.RET_MOBILE RET_MSISDN \nFROM TEMP_FOR_RET_TAR_14_16JAN25 TAR \nINNER JOIN DD_RSO_RET_MAPPING_DAILY AG ON AG.RET_CODE=TAR.RETAILER_CODE AND AG.DATA_DATE = '16-JAN-25';--569264  Rows\n\nselect * from DD_RSO_RET_MAPPING_DAILY;\nselect * from TEMP_FOR_AG_LIST_MAP_16_JAN25; --222155  Rows\n\ncreate table TEMP_FOR_EV_DET_14_16JAN25 AS\nSELECT * FROM EV_RECHARGE_COM_DAILY WHERE TOP_UP_DATE BETWEEN '14-JAN-25' AND '16-JAN-25';\n\nSELECT * FROM TEMP_FOR_EV_DET_14_16JAN25 WHERE RECHARGE_AMOUNT=348; --5643488  Rows\n\n--create table TEMP_FOR_RET_COM_CAL2_14_16JAN25 as\n--drop table TEMP_FOR_RET_COM_CAL_14_16JAN25 purge;\n--CREATE TABLE TEMP_FOR_RET_COM_CAL_14_16JAN25 AS\nWITH DENO_WISE_PERTICEPATION AS (\n    SELECT /*+ parallel(16) */TAR.RET_MSISDN,TAR.RETAILER_CODE,RECHARGE.SUB_MSISDN,RECHARGE_AMOUNT,TAR.TARGET\n    FROM TEMP_FOR_EV_DET_14_16JAN25 RECHARGE\n    INNER JOIN TEMP_FOR_AG_LIST_MAP_16_JAN25 TAR ON TAR.RET_MSISDN = RECHARGE.RETAILER_MSISDN\n    WHERE RECHARGE.TOP_UP_DATE BETWEEN '14-JAN-25' AND '16-JAN-25'\n    AND RECHARGE.RECHARGE_AMOUNT IN (348)\n    )\n--SELECT * FROM DENO_WISE_PERTICEPATION;--TEMP_FOR_RET_COM_CAL2_14_16JAN25 detail --408  Rows\n,RET_WISE_ACHIEVEMENT AS (\nSELECT RET_MSISDN,RETAILER_CODE,TARGET,SUM(RECHARGE_AMOUNT) ACH\nFROM DENO_WISE_PERTICEPATION PER\nGROUP BY RET_MSISDN,RETAILER_CODE,TARGET\n)\n--select * from RET_WISE_ACHIEVEMENT;\n,RET_WISE_PERCENTAGE AS (\nSELECT ACHIEVEMENT.*,ROUND((ACH/TARGET)*100) ACH_PER\nFROM RET_WISE_ACHIEVEMENT ACHIEVEMENT\n)\n--SELECT * FROM RET_WISE_PERCENTAGE;--3424  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT RET_MSISDN,RETAILER_CODE,TARGET, ACH,ACH_PER,\n    CASE\n        WHEN ACH_PER>=100 THEN 100\n        ELSE 0\n    END COMMISSION\n    FROM RET_WISE_PERCENTAGE ACHIEVEMENT\n)\nSELECT * FROM CALCULATE_COMMISSION;--940  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;--0 TAKA\n\nSELECT SUM(COMMISSION) FROM TEMP_FOR_RET_COM_CAL_14_16JAN25;--0 TK\n\nSELECT * FROM TEMP_FOR_RET_COM_CAL_14_16JAN25; --940  Rows\n\n"}
{"srf": "```markdown\n# Commission Business Logics: Retailer Deno Campaign_15th May25  \n**Commission Name:** Retailer Deno Campaign_15th May25  \n**Start Date:** 15-May-2025  \n**End Date:** 15-May-2025  \n**Commission Receiver Channel:** Retailer  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges)  \n- **Target:** Recharge target cumulative of selected deno values.  \n- **Mapping:** Retailer MSISDNs (Selected retailer list provided by DMS retail database).  \n- **Commission Calculation Logics:**  \n    - Retailers will receive incentives upon achieving recharge targets for specific deno values.  \n    - Selected Deno:  \n        - 209  \n    - Incentive amounts:  \n        - BDT 10 for each 209 recharge from the 2nd recharge onwards.  \n    - General mathematical rounding applies:  \n        - Below 0.5 rounded down.  \n        - Greater than or equal to 0.5 rounded up.  \n    - Valid recharge means I-TOP up.  \n    - Retailers under distributor types \"BL Franchise Store,\" \"Enterprise,\" and \"SME Direct BDO\" are excluded.  \n    - Agent list of 15th May 2025 will be considered.  \n\n**Detail formats:**  \n- **Detail 1:** DD, Code Retailer, MSISDN, Recharge Target, Recharge Amount, Incentive Amount  \n- **Detail 2:** DD, Code Retailer, MSISDN Customer, MSISDN Deno Amount, Transaction Date  \n```", "sql": "--TARGET\n--ALTER TABLE TEMP_FOR_RET_FCS_TAR_7_9MAR25 RENAME TO TEMP_FOR_RET_FCS_TAR_7_9MAR25;\n--DROP TABLE TEMP_FOR_RET_FCS_TAR_7_9MAR25;\n\n--SELECT * FROM TEMP_FOR_RET_FCS_TAR_7_9MAR25;-- 226677  Rows\n--SELECT RET_CODE, COUNT(RET_CODE) FROM TEMP_FOR_RET_FCS_TAR_7_9MAR25 GROUP BY RET_CODE HAVING COUNT(RET_CODE)>1;--0 ROW\n--SELECT * FROM TEMP_FOR_RET_FCS_TAR_7_9MAR25 t where t.PARTICIPATION_TARGET <=0;--0 ROW\n\n\n--CREATE TABLE TEMP_FOR_RET_FCS_TAR_7_9MAR25 AS\n--select CHANNEL_CODE RET_CODE, TARGET from COM_KPI_CONDITION_TARGET \n--WHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \n--where REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Retailer Deno Campaign_7th to 9th Mar25') and  \n--CYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'Mar_25')); -- 226677  Rows\n\n\nselect * from DD_RSO_RET_MAPPING_DAILY;\n------------------AGENT LIST--------------------\n--drop table TEMP_FOR_RETAGENT_15MAY25 purge;\n--CREATE TABLE TEMP_FOR_RETAGENT_15MAY25_ AS\nSELECT /*+ parallel(10) */ DISTINCT\n--    MAPING.DD_CODE,\n--    TAR.RSO_CODE RSO_CODE,\n--    TAR.RSO_MSISDN RSO_MSISDN,\n      MAPING.RETAILER_CODE,\n      MAPING.TOPUP_MSISDN\n    --TAR.PARTICIPATION_TARGET,\n--    TAR.INCENTIVE,\n    --TAR.SLAB,\n--    TAR.TARGET\nFROM agent_list_daily MAPING\nWHERE DATA_DATE='15-MAY-25'; --AND PARTICIPATION_TARGET != 0;-- 84661  Rows\nSELECT * FROM TEMP_FOR_RETAGENT_15MAY25_;-- 608572  Rows\n--1915273989  87   \nselect * from agent_list_daily;\n-------------------------------HELPER QUERY------------------------------------\n--drop table TEMP_FOR_RET_EV_DET_15MAY25 purge;\n--CREATE TABLE TEMP_FOR_RET_EV_DET_15MAY25 AS\nselect * from EV_RECHARGE_COM_DAILY RECHARGE\nWHERE RECHARGE.TOP_UP_DATE BETWEEN '15-MAY-25' AND '15-MAY-25'\nAND RECHARGE.TOP_UP_TIME BETWEEN '05:00:00' AND '22:00:00'; -- 1530400  Rows\nselect * from TEMP_FOR_RET_EV_DET_15MAY25; -- 1530400  Rows\n\n--drop table TEMP_FOR_RET_FCS_DET_15MAY25 purge;\n--CREATE TABLE TEMP_FOR_RET_FCS_DET_15MAY25 AS\nWITH RET_WISE_ACHIEVEMENT AS (\n    SELECT AG.RETAILER_CODE,RECHARGE.RETAILER_MSISDN,SUM(RECHARGE.RECHARGE_AMOUNT) ACH\n    FROM TEMP_FOR_RET_EV_DET_15MAY25 RECHARGE\n    INNER JOIN TEMP_FOR_RETAGENT_15MAY25_ AG ON AG.TOPUP_MSISDN = RECHARGE.RETAILER_MSISDN\n    WHERE RECHARGE.RECHARGE_AMOUNT IN (209)\n    GROUP BY AG.RETAILER_CODE,RECHARGE.RETAILER_MSISDN\n)\n\n--SELECT * FROM RET_WISE_ACHIEVEMENT; -- 1951  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT RETAILER_CODE,RETAILER_MSISDN,418 TARGET,ACH,\n    CASE\n        WHEN ACH>= 418 THEN 10\n        ELSE 0\n    END COMMISSION\n    FROM RET_WISE_ACHIEVEMENT\n)\nSELECT * FROM CALCULATE_COMMISSION;-- 1951  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;-- 850\n\nSELECT SUM(COMMISSION) FROM TEMP_FOR_RET_FCS_DET_15MAY25;-- 850 TK\n\nSELECT * FROM TEMP_FOR_RET_FCS_DET_15MAY25; -- 1951  Rows\n\n---------------------MSISDN DETAIL---------------------------\n--DROP TABLE TEMP_FOR_RET_FCS_DET2_15MAY25 PURGE;\n--CREATE TABLE TEMP_FOR_RET_FCS_DET2_15MAY25 AS\n SELECT AG.RETAILER_CODE,RETAILER_MSISDN RET_MOBILE,RECHARGE.SUB_MSISDN,RECHARGE.RECHARGE_AMOUNT,RECHARGE.TOP_UP_DATE\n    FROM TEMP_FOR_RET_EV_DET_15MAY25 RECHARGE\n    INNER JOIN TEMP_FOR_RETAGENT_15MAY25_ AG ON AG.TOPUP_MSISDN = RECHARGE.RETAILER_MSISDN\n    WHERE RECHARGE.RECHARGE_AMOUNT IN (209);-- 2039  Rows\n    \nSELECT * FROM TEMP_FOR_RET_FCS_DET2_15MAY25;-- 2039  Rows\n    \nSELECT * FROM EV_RECHARGE_COM_DAILY;\n"}
{"srf": "# Commission Business Logics: Retailer Deno Campaign_1st to 5th May25  \n**Commission Name:** Retailer Deno Campaign_1st to 5th May25  \n**Start Date:** 01-May-2025  \n**End Date:** 05-May-2025  \n**Commission Receiver Channel:** Retailer  \n\n**Commission Business Logics:**  \n- **KPI:** EV Recharge (All Valid C2S Recharges)  \n- **Target:** Recharge target cumulative of selected deno values.  \n- **Mapping:** Retailer MSISDNs (Selected retailer list provided by DMS retail database).  \n- **Commission Calculation Logics:**  \n    - Retailers will receive incentives upon achieving recharge targets for specific deno values.  \n    - Selected Deno:  \n        - 32, 74, 79  \n    - Incentive amounts:  \n        - BDT 1 for each BDT 32 & BDT 74 recharge.  \n        - BDT 2 for each BDT 79 recharge.  \n    - General mathematical rounding applies:  \n        - Below 0.5 rounded down.  \n        - Greater than or equal to 0.5 rounded up.  \n    - Valid recharge means I-TOP up.  \n    - Retailers under distributor types \"BL Franchise Store,\" \"Enterprise,\" and \"SME Direct BDO\" are excluded.  \n    - Agent list of 5th May 2025 will be considered.  \n\n**Detail formats:**  \n- **Detail 1:** DD, Code Retailer, MSISDN, Recharge Target, Recharge Amount, Incentive Amount  \n- **Detail 2:** DD, Code Retailer, MSISDN Customer, MSISDN Deno Amount, Transaction Date  ", "sql": "--TARGET\n--ALTER TABLE TEMP_FOR_RET_FCS_TAR_1_5MAY25 RENAME TO TEMP_FOR_RET_FCS_TAR_1_5MAY25;\n--DROP TABLE TEMP_FOR_RET_FCS_TAR_1_5MAY25;\n\nSELECT * FROM TEMP_FOR_RET_FCS_TAR_1_5MAY25;-- 369336  Rows\nSELECT RET_CODE, COUNT(RET_CODE) FROM TEMP_FOR_RET_FCS_TAR_1_5MAY25 GROUP BY RET_CODE HAVING COUNT(RET_CODE)>1;--0 ROW\n--SELECT * FROM TEMP_FOR_RET_FCS_TAR_1_5MAY25 t where t.PARTICIPATION_TARGET <=0;--0 ROW\n\n\n--CREATE TABLE TEMP_FOR_RET_FCS_TAR_1_5MAY25 AS\nselect CHANNEL_CODE RET_CODE, TARGET from COM_KPI_CONDITION_TARGET \nWHERE REPORTCYCLE_ID = (SELECT CYCLEREPORTID  FROM COMMISSIONCYCLEREPORTS \nwhere REPORTID = (SELECT REPORTID FROM COMMISSIONREPORT WHERE REPORTNAME = 'Retailer Deno Campaign_1st to 5th May25') and  \nCYCLEID = (SELECT CYCLEID  FROM COMMISSIONCYCLE WHERE CYCLEDESCRIPTION = 'May_25')); -- 369336  Rows\n\nSELECT * FROM RETAILERTYPE@DEALER RD\nWhere RD.NAME in ('BL FRANCHISE STORE','ENTERPRISE','SME DIRECT BDO');\n\nselect * from DD_RSO_RET_MAPPING_DAILY;\nselect * from agent_list_daily;\nselect * from TEMP_FOR_RET_EV_DET_1_5MAY25;-- 8247767  Rows\n------------------AGENT LIST--------------------\n--drop table TEMP_FOR_RETAGENT_1_5MAY25 purge;\n--CREATE TABLE TEMP_FOR_RETAGENT_1_5MAY25 AS\nSELECT /*+ parallel(10) */ DISTINCT\n--    MAPING.DD_CODE,\n--    TAR.RSO_CODE RSO_CODE,\n--    TAR.RSO_MSISDN RSO_MSISDN,\n      MAPING.RETAILER_CODE,\n      MAPING.TOPUP_MSISDN RET_MSISDN,\n      MAPING.RETAILERTYPE\n    --TAR.PARTICIPATION_TARGET,\n--    TAR.INCENTIVE,\n    --TAR.SLAB,\n    --TAR.TARGET\nFROM agent_list_daily MAPING\nINNER JOIN TEMP_FOR_RET_EV_DET_1_5MAY25 EVR ON MAPING.TOPUP_MSISDN=EVR.RETAILER_MSISDN\nWHERE DATA_DATE='5-MAY-25'\nAND MAPING.RETAILERTYPE not in (26,29,31); --AND PARTICIPATION_TARGET != 0;-- 367242  Rows --- 278732  Rows\nSELECT * FROM TEMP_FOR_RETAGENT_1_5MAY25;-- 278732  Rows\n--1915273989  87                          \n-------------------------------HELPER QUERY------------------------------------\n--drop table TEMP_FOR_RET_EV_DET_1_5MAY25 purge;\n--CREATE TABLE TEMP_FOR_RET_EV_DET_1_5MAY25 AS\nselect * from EV_RECHARGE_COM_DAILY RECHARGE WHERE \n        RECHARGE.TOP_UP_DATE BETWEEN '1-MAY-25' AND '5-MAY-25'; -- 8247767  Rows\n        \nselect * from TEMP_FOR_RET_EV_DET_1_5MAY25;-- 8247767  Rows\n\nSELECT * FROM RETAILERTYPE@DEALER RD\nWhere RD.NAME in ('BL FRANCHISE STORE','ENTERPRISE','SME DIRECT BDO');\n\n--drop table TEMP_FOR_RET_FCS_DET_1_5MAY25 purge;\n--CREATE TABLE TEMP_FOR_RET_FCS_DET_1_5MAY25 AS\nWITH RET_WISE_ACHIEVEMENT AS (\n    SELECT AG.RETAILER_CODE,AG.RET_MSISDN,COUNT(RECHARGE.RECHARGE_AMOUNT) ACH,RECHARGE.RECHARGE_AMOUNT\n    FROM TEMP_FOR_RET_EV_DET_1_5MAY25 RECHARGE\n    INNER JOIN TEMP_FOR_RETAGENT_1_5MAY25 AG \n        ON AG.RET_MSISDN = RECHARGE.RETAILER_MSISDN\n    WHERE RECHARGE.TOP_UP_DATE BETWEEN '1-MAY-25' AND '5-MAY-25'\n        AND RECHARGE.RECHARGE_AMOUNT IN (32,74,79)\n    GROUP BY AG.RETAILER_CODE, AG.RET_MSISDN,RECHARGE.RECHARGE_AMOUNT\n)\n--SELECT * FROM RET_WISE_ACHIEVEMENT; -- 15377  Rows\n--,RET_WISE_PERCENTAGE AS (\n--SELECT ACHIEVEMENT.*,ROUND((ACH/TARGET)*100) ACH_PER\n--FROM RET_WISE_ACHIEVEMENT ACHIEVEMENT\n--SELECT * FROM RET_WISE_PERCENTAGE;-- 15377  Rows\n,CALCULATE_COMMISSION AS (\n    SELECT RETAILER_CODE, RET_MSISDN,ACH,\n    CASE\n        WHEN ACH>=3 AND RECHARGE_AMOUNT in (32,74) THEN ACH*1\n        WHEN ACH>=3 AND RECHARGE_AMOUNT in (79) THEN ACH*2\n        ELSE 0\n    END COMMISSION\n    FROM RET_WISE_ACHIEVEMENT\n)\nSELECT * FROM CALCULATE_COMMISSION;-- 15377  Rows\nSELECT SUM(COMMISSION) TOTAL_COMMISSION FROM CALCULATE_COMMISSION;-- 2831\n\nSELECT SUM(COMMISSION) FROM TEMP_FOR_RET_FCS_DET_1_5MAY25;-- 2831 TK\n\nSELECT * FROM TEMP_FOR_RET_FCS_DET_1_5MAY25; -- 24595  Rows\n\n---------------------MSISDN DETAIL---------------------------\n--DROP TABLE TEMP_FOR_RET_FCS_DET2_1_5MAY25 PURGE;\n--CREATE TABLE TEMP_FOR_RET_FCS_DET2_1_5MAY25 AS\n SELECT AG.RETAILER_CODE, RETAILER_MSISDN,RECHARGE.SUB_MSISDN,RECHARGE.RECHARGE_AMOUNT,RECHARGE.TOP_UP_DATE\n    FROM TEMP_FOR_RET_EV_DET_1_5MAY25 RECHARGE\n    INNER JOIN TEMP_FOR_RETAGENT_1_5MAY25 AG \n    ON AG.RET_MSISDN=RECHARGE.RETAILER_MSISDN\n    WHERE (RECHARGE.TOP_UP_DATE  BETWEEN '1-MAY-25' AND '5-MAY-25') AND RECHARGE.RECHARGE_AMOUNT IN (32,74,79);-- 28668  Rows\n    \nSELECT * FROM TEMP_FOR_RET_FCS_DET2_1_5MAY25;-- 28668  Rows\n    \nSELECT * FROM EV_RECHARGE_COM_DAILY;\n"}
